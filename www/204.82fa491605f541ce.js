(self.webpackChunkiot_master_nuwa=self.webpackChunkiot_master_nuwa||[]).push([[204],{9204:(Rt,Bt,m)=>{"use strict";m.r(Bt),m.d(Bt,{EditorModule:()=>$r});var T=m(177),rt=m(6530);function At(){return{name:"\u9996\u9875",content:{},width:window.screen.width,height:window.screen.height}}var e=m(4438),Ot=m(345),gt=m(5013),ft=m(7094),it=m(4104),y=m(1635),at=m(3726),H=m(6977),Vt=m(5964),Wt=m(713),W=m(6035),F=m(7806),et=m(1025),D=m(317),G=m(5103),mt=m(8203),Kt=m(6841);const Ft=["*"],J=["collapseHeader"];function g(i,s){if(1&i&&(e.qex(0),e.nrm(1,"span",7),e.bVm()),2&i){const t=s.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("nzType",t||"right")("nzRotate",n.nzActive?90:0)}}function C(i,s){if(1&i&&(e.j41(0,"div"),e.DNE(1,g,2,2,"ng-container",3),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzExpandedIcon)}}function I(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.nzHeader)}}function L(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzExtra)}}function lt(i,s){if(1&i&&(e.j41(0,"div",4),e.DNE(1,L,2,1,"ng-container",3),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzExtra)}}const ct="collapse";let vt=(()=>{class i{constructor(t,n,o,r){this.nzConfigService=t,this.cdr=n,this.directionality=o,this.destroy$=r,this._nzModuleName=ct,this.nzAccordion=!1,this.nzBordered=!0,this.nzGhost=!1,this.nzExpandIconPosition="left",this.dir="ltr",this.listOfNzCollapsePanelComponent=[],this.nzConfigService.getConfigChangeEventForComponent(ct).pipe((0,H.Q)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,H.Q)(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}addPanel(t){this.listOfNzCollapsePanelComponent.push(t)}removePanel(t){this.listOfNzCollapsePanelComponent.splice(this.listOfNzCollapsePanelComponent.indexOf(t),1)}click(t){this.nzAccordion&&!t.nzActive&&this.listOfNzCollapsePanelComponent.filter(n=>n!==t).forEach(n=>{n.nzActive&&(n.nzActive=!1,n.nzActiveChange.emit(n.nzActive),n.markForCheck())}),t.nzActive=!t.nzActive,t.nzActiveChange.emit(t.nzActive)}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(W.yx),e.rXU(e.gRc),e.rXU(mt.dS,8),e.rXU(et.y4))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-collapse"]],hostAttrs:[1,"ant-collapse"],hostVars:10,hostBindings:function(n,o){2&n&&e.AVh("ant-collapse-icon-position-start","left"===o.nzExpandIconPosition)("ant-collapse-icon-position-end","right"===o.nzExpandIconPosition)("ant-collapse-ghost",o.nzGhost)("ant-collapse-borderless",!o.nzBordered)("ant-collapse-rtl","rtl"===o.dir)},inputs:{nzAccordion:"nzAccordion",nzBordered:"nzBordered",nzGhost:"nzGhost",nzExpandIconPosition:"nzExpandIconPosition"},exportAs:["nzCollapse"],standalone:!0,features:[e.Jv_([et.y4]),e.aNF],ngContentSelectors:Ft,decls:1,vars:0,template:function(n,o){1&n&&(e.NAR(),e.SdG(0))},encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,W.H4)(),(0,D.H3)()],i.prototype,"nzAccordion",void 0),(0,y.Cg)([(0,W.H4)(),(0,D.H3)()],i.prototype,"nzBordered",void 0),(0,y.Cg)([(0,W.H4)(),(0,D.H3)()],i.prototype,"nzGhost",void 0),i})();const Et="collapsePanel";let xt=(()=>{class i{markForCheck(){this.cdr.markForCheck()}constructor(t,n,o,r,a,l){this.nzConfigService=t,this.ngZone=n,this.cdr=o,this.destroy$=r,this.nzCollapseComponent=a,this.noAnimation=l,this._nzModuleName=Et,this.nzActive=!1,this.nzDisabled=!1,this.nzShowArrow=!0,this.nzActiveChange=new e.bkB,this.nzConfigService.getConfigChangeEventForComponent(Et).pipe((0,H.Q)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.nzCollapseComponent.addPanel(this),this.ngZone.runOutsideAngular(()=>(0,at.R)(this.collapseHeader.nativeElement,"click").pipe((0,Vt.p)(()=>!this.nzDisabled),(0,H.Q)(this.destroy$)).subscribe(()=>{this.ngZone.run(()=>{this.nzCollapseComponent.click(this),this.cdr.markForCheck()})}))}ngOnDestroy(){this.nzCollapseComponent.removePanel(this)}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(W.yx),e.rXU(e.SKi),e.rXU(e.gRc),e.rXU(et.y4),e.rXU(vt,1),e.rXU(Kt.z,8))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-collapse-panel"]],viewQuery:function(n,o){if(1&n&&e.GBs(J,7),2&n){let r;e.mGM(r=e.lsd())&&(o.collapseHeader=r.first)}},hostAttrs:[1,"ant-collapse-item"],hostVars:6,hostBindings:function(n,o){2&n&&e.AVh("ant-collapse-no-arrow",!o.nzShowArrow)("ant-collapse-item-active",o.nzActive)("ant-collapse-item-disabled",o.nzDisabled)},inputs:{nzActive:"nzActive",nzDisabled:"nzDisabled",nzShowArrow:"nzShowArrow",nzExtra:"nzExtra",nzHeader:"nzHeader",nzExpandedIcon:"nzExpandedIcon"},outputs:{nzActiveChange:"nzActiveChange"},exportAs:["nzCollapsePanel"],standalone:!0,features:[e.Jv_([et.y4]),e.aNF],ngContentSelectors:Ft,decls:9,vars:8,consts:[["collapseHeader",""],["role","button",1,"ant-collapse-header"],[1,"ant-collapse-header-text"],[4,"nzStringTemplateOutlet"],[1,"ant-collapse-extra"],[1,"ant-collapse-content"],[1,"ant-collapse-content-box"],["nz-icon","",1,"ant-collapse-arrow",3,"nzType","nzRotate"]],template:function(n,o){1&n&&(e.NAR(),e.j41(0,"div",1,0),e.DNE(2,C,2,1,"div"),e.j41(3,"span",2),e.DNE(4,I,2,1,"ng-container",3),e.k0s(),e.DNE(5,lt,2,1,"div",4),e.k0s(),e.j41(6,"div",5)(7,"div",6),e.SdG(8),e.k0s()()),2&n&&(e.BMQ("aria-expanded",o.nzActive),e.R7$(2),e.vxM(2,o.nzShowArrow?2:-1),e.R7$(2),e.Y8G("nzStringTemplateOutlet",o.nzHeader),e.R7$(),e.vxM(5,o.nzExtra?5:-1),e.R7$(),e.AVh("ant-collapse-content-active",o.nzActive),e.Y8G("@.disabled",!(null==o.noAnimation||!o.noAnimation.nzNoAnimation))("@collapseMotion",o.nzActive?"expanded":"hidden"))},dependencies:[F.C,F.m,G.Y3,G.Dn],encapsulation:2,data:{animation:[Wt.GE]},changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzActive",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzDisabled",void 0),(0,y.Cg)([(0,W.H4)(),(0,D.H3)()],i.prototype,"nzShowArrow",void 0),i})(),yt=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[xt]})}return i})();var Gt=m(3796);function ce(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",3),e.bIt("click",function(){const o=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.onClick(o))})("dragstart",function(o){const r=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.onDragStart(o,r))}),e.j41(1,"div",4),e.nrm(2,"img",5),e.k0s(),e.j41(3,"div",6),e.EFF(4),e.k0s()()}if(2&i){const t=s.$implicit;e.R7$(2),e.Y8G("src",t.icon,e.B4B),e.R7$(2),e.JRh(t.name)}}function de(i,s){if(1&i&&(e.j41(0,"nz-collapse-panel",1),e.DNE(1,ce,5,2,"div",2),e.k0s()),2&i){const t=s.$implicit,n=s.first;e.Y8G("nzHeader",t.name)("nzActive",n),e.R7$(),e.Y8G("ngForOf",t.components)}}let jt=(()=>{class i{constructor(){this.widgets=Gt.p}onDragStart(t,n){this.canvas?.drawNode(t,n)}onClick(t){this.canvas?.drawEdge(t)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-widgets"]],inputs:{canvas:"canvas"},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[[3,"nzHeader","nzActive",4,"ngFor","ngForOf"],[3,"nzHeader","nzActive"],["class","component","draggable","true",3,"click","dragstart",4,"ngFor","ngForOf"],["draggable","true",1,"component",3,"click","dragstart"],[1,"icon"],["alt","c.name","loading","lazy",3,"src"],[1,"name"]],template:function(n,o){1&n&&(e.j41(0,"nz-collapse"),e.DNE(1,de,2,3,"nz-collapse-panel",0),e.k0s()),2&n&&(e.R7$(),e.Y8G("ngForOf",o.widgets))},dependencies:[T.MD,T.Sq,yt,xt,vt],styles:["[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}.component[_ngcontent-%COMP%]{display:inline-block;margin:1px;padding:5px 0;cursor:pointer;width:50px}.component[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:50px;height:50px;display:flex;justify-content:center;align-items:center}.component[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:40px;max-height:40px}.component[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;font-size:12px}"]})}return i})();function S(i,s){if(1&i&&(e.j41(0,"div",3)(1,"div",4),e.nrm(2,"img",5),e.k0s(),e.j41(3,"div",6),e.EFF(4),e.k0s()()),2&i){const t=s.$implicit;e.R7$(2),e.Y8G("src","/nuwa/component/"+t.id+"/"+t.icon,e.B4B),e.R7$(2),e.JRh(t.name)}}function M(i,s){if(1&i&&(e.j41(0,"nz-collapse-panel",1),e.DNE(1,S,5,2,"div",2),e.k0s()),2&i){const t=s.$implicit,n=s.first;e.Y8G("nzHeader",t.name)("nzActive",n),e.R7$(),e.Y8G("ngForOf",t.components)}}let P=(()=>{class i{constructor(t){this.rs=t,this.collections=[],this.load()}load(){this.rs.get("nuwa/components").subscribe(t=>{let n={};t.data.forEach(o=>{let r=o.collection||"\u672a\u5206\u7ec4";n.hasOwnProperty(r)||(n[r]={name:r,components:[]}),n[r].components.push(o)}),Object.keys(n).forEach(o=>{this.collections.push(n[o])})})}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(gt.By))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-components"]],inputs:{canvas:"canvas"},standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[[3,"nzHeader","nzActive",4,"ngFor","ngForOf"],[3,"nzHeader","nzActive"],["class","component",4,"ngFor","ngForOf"],[1,"component"],[1,"icon"],["alt","c.name","loading","lazy",3,"src"],[1,"name"]],template:function(n,o){1&n&&(e.j41(0,"nz-collapse"),e.DNE(1,M,2,3,"nz-collapse-panel",0),e.k0s()),2&n&&(e.R7$(),e.Y8G("ngForOf",o.collections))},dependencies:[T.MD,T.Sq,yt,xt,vt],styles:["[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}.component[_ngcontent-%COMP%]{display:inline-block;margin:1px;padding:5px 0;cursor:pointer;width:60px}.component[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:60px;height:60px;display:flex;justify-content:center;align-items:center}.component[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:50px;max-height:50px}.component[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{text-align:center;font-size:12px}"]})}return i})();var N=m(2513);function V(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",1),e.bIt("dragstart",function(o){const r=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.onDragStart(o,r))}),e.j41(1,"div",2),e.nrm(2,"img",3),e.k0s()()}if(2&i){const t=s.$implicit;e.R7$(),e.Y8G("title",t),e.R7$(),e.Y8G("src","/nuwa/gallery/"+t,e.B4B)("alt",t)}}let ot=(()=>{class i{constructor(t){this.rs=t,this.images=[],this.load()}load(){this.rs.get("nuwa/galleries").subscribe(t=>{this.images=t.data})}onDragStart(t,n){this.canvas?.drawNode(t,N.d,{"attrs/image/xlink:href":"/nuwa/gallery/"+n})}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(gt.By))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-galleries"]],inputs:{canvas:"canvas"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[["class","component","draggable","true",3,"dragstart",4,"ngFor","ngForOf"],["draggable","true",1,"component",3,"dragstart"],[1,"icon",3,"title"],["loading","lazy",3,"src","alt"]],template:function(n,o){1&n&&e.DNE(0,V,3,3,"div",0),2&n&&e.Y8G("ngForOf",o.images)},dependencies:[T.MD,T.Sq,yt],styles:["[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}.component[_ngcontent-%COMP%]{display:inline-block;margin:1px;padding:5px 0;cursor:pointer;width:60px}.component[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:60px;height:60px;display:flex;justify-content:center;align-items:center}.component[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:50px;max-height:50px}"]})}return i})(),R=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-sources"]],standalone:!0,features:[e.aNF],decls:2,vars:0,template:function(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"sources works!"),e.k0s())}})}return i})(),q=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-events"]],standalone:!0,features:[e.aNF],decls:8,vars:0,template:function(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"\u70b9\u51fb\u3001\u81ea\u5b9a\u4e49"),e.k0s(),e.j41(2,"p"),e.EFF(3," \u6253\u5f00\uff08\u9875\u9762\u3001\u94fe\u63a5\uff09\uff08\u53c2\u6570\u7ed1\u5b9a\uff09\uff0c\u663e\u793a\u9690\u85cf\u5143\u7d20\uff0c\u64cd\u4f5c\u53d8\u91cf\uff0c\u6267\u884c\u811a\u672c\n"),e.k0s(),e.j41(4,"p"),e.EFF(5," \u9875\u9762\u76ee\u6807\uff1a\u5f53\u524d\u9875\u9762\uff0c\u5b50\u9875\u9762\uff08\u9700\u8981\u5bb9\u5668\uff09\uff0c\u7236\u9875\u9762\n"),e.k0s(),e.j41(6,"p"),e.EFF(7," \u94fe\u63a5\u76ee\u6807\uff1a\u5f53\u524d\u7a97\u53e3\uff0c\u5b50\u7a97\u53e3\uff08iframe\uff09\uff0c\u7236\u7a97\u53e3\n"),e.k0s())}})}return i})(),Ct=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-scripts"]],standalone:!0,features:[e.aNF],decls:2,vars:0,template:function(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"scripts works!"),e.k0s())}})}return i})();const dt=["*"],pe=i=>({active:i});function he(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",4),e.bIt("click",function(){const o=e.eBV(t).index,r=e.XpG();return e.Njj(r.onClick(o))}),e.EFF(1),e.k0s()}if(2&i){const t=s.$implicit,n=s.index,o=e.XpG();e.Y8G("ngClass",e.eq3(2,pe,o.index==n)),e.R7$(),e.SpI(" ",t.title," ")}}function Nn(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",5),e.bIt("mousedown",function(o){e.eBV(t);const r=e.XpG();return e.Njj(r.onSplit(o))}),e.k0s()}}let Ie=(()=>{class i{constructor(t,n){this.templateRef=t,this.viewContainerRef=n,this.title="tab"}show(){this.viewContainerRef.createEmbeddedView(this.templateRef)}hide(){this.viewContainerRef.clear()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.C4Q),e.rXU(e.c1b))};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["","sideBarItem",""]],inputs:{title:[e.Mj6.None,"sideBarItem","title"]},standalone:!0})}return i})(),Dn=(()=>{class i{constructor(){this.components=new e.rOR,this.styleWidth="200px",this.styleFlexDirection="row",this._right=!1,this._width=200,this.index=0,this.splitting=!1,this.lastX=0}set right(t){this._right=t,this.styleFlexDirection=t?"row-reverse":"row"}set width(t){this._width=t,this.styleWidth=t+"px"}onClick(t){this.index>-1&&this.components.get(this.index)?.hide(),this.index==t?(this.index=-1,this.styleWidth="auto"):(this.components.get(t)?.show(),this.index=t,this.width=this._width)}ngAfterViewInit(){setTimeout(()=>{this.components.length>0&&this.components.get(0)?.show()},10)}ngAfterContentInit(){}onSplit(t){this.splitting=!0,this.lastX=t.screenX}onMouseMove(t){if(!this.splitting)return;let n=t.screenX-this.lastX,o=this._right?this._width-n:this._width+n;o>50&&(this.width=o),this.lastX=t.screenX}onMouseUp(t){this.splitting=!1}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-side-bar"]],contentQueries:function(n,o,r){if(1&n&&e.wni(r,Ie,5),2&n){let a;e.mGM(a=e.lsd())&&(o.components=a)}},hostVars:4,hostBindings:function(n,o){1&n&&e.bIt("mousemove",function(a){return o.onMouseMove(a)},!1,e.tSv)("mouseup",function(a){return o.onMouseUp(a)},!1,e.tSv),2&n&&e.xc7("width",o.styleWidth)("flex-direction",o.styleFlexDirection)},inputs:{right:"right",width:"width"},ngContentSelectors:dt,decls:5,vars:2,consts:[[1,"side"],["class","item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"content"],["class","split",3,"mousedown",4,"ngIf"],[1,"item",3,"click","ngClass"],[1,"split",3,"mousedown"]],template:function(n,o){1&n&&(e.NAR(),e.j41(0,"div",0),e.DNE(1,he,2,4,"div",1),e.k0s(),e.j41(2,"div",2),e.SdG(3),e.k0s(),e.DNE(4,Nn,1,0,"div",3)),2&n&&(e.R7$(),e.Y8G("ngForOf",null==o.components?null:o.components.toArray()),e.R7$(3),e.Y8G("ngIf",o.index>-1))},dependencies:[T.YU,T.Sq,T.bT],styles:["[_nghost-%COMP%]{display:flex}.side[_ngcontent-%COMP%]{padding:1px;background-color:#f0f0f0;-webkit-user-select:none;user-select:none}.side[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#d0d0d0;border:1px solid #d0d0d0;margin:2px 1px;padding:5px 2px;writing-mode:vertical-rl;cursor:pointer}.side[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover, .side[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]{background-color:#fff}.content[_ngcontent-%COMP%]{flex:1;overflow-x:hidden;overflow-y:auto}.split[_ngcontent-%COMP%]{width:8px;background-color:#c9c9c9;cursor:col-resize}"]})}return i})();var E=m(4341);const Mn=["editor"];let Ne=(()=>{class i{constructor(){this.fields=[{key:"name",label:"\u540d\u79f0",type:"text"},{key:"width",label:"\u5bbd\u5ea6",type:"number"},{key:"height",label:"\u9ad8\u5ea6",type:"number"},{key:"background",label:"\u80cc\u666f\u8272",type:"color"}]}onChange(){let t=this.editor.value;console.log("page change",t),Object.assign(this.page,t)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-page"]],viewQuery:function(n,o){if(1&n&&e.GBs(Mn,5),2&n){let r;e.mGM(r=e.lsd())&&(o.editor=r.first)}},inputs:{page:"page"},standalone:!0,features:[e.aNF],decls:3,vars:3,consts:[["editor",""],[3,"change","formGroup"],[3,"fields","values"]],template:function(n,o){if(1&n){const r=e.RV6();e.j41(0,"form",1),e.bIt("change",function(){return e.eBV(r),e.Njj(o.onChange())}),e.nrm(1,"im-smart-editor",2,0),e.k0s()}if(2&n){const r=e.sdS(2);e.Y8G("formGroup",r.group),e.R7$(),e.Y8G("fields",o.fields)("values",o.page)}},dependencies:[gt.Ay,E.X1,E.qT,E.cb,E.j4]})}return i})();const Pn=["editor"];let De=(()=>{class i{constructor(t){this.cs=t,this.fields=[],this.data={}}ngOnInit(){this.canvas.graph.on("cell:selected",this.onCellSelected,this);let t=this.canvas.graph.getSelectedCells();t.length>0&&this.onCellSelected({cell:t[t.length-1]})}ngOnDestroy(){this.canvas.graph.off("cell:selected",this.onCellSelected)}onCellSelected(t){this.cell=t.cell,this.component=this.cs.Get(t.cell.shape),this.fields=this.component.properties||[];let o={};this.fields.forEach(r=>{let a=t.cell.getPropByPath(r.key);void 0!==a&&(o[r.key]=a)}),this.data=o,this.ngAfterViewInit()}ngAfterViewInit(){setTimeout(()=>{this.editor.group.valueChanges.subscribe(t=>{Object.keys(t).forEach(n=>{this.cell?.setPropByPath(n,t[n])})})},100)}onChange(){let t=this.editor.value;console.log("properties change",t),Object.keys(t).forEach(n=>{this.cell?.setPropByPath(n,t[n])})}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(it.b))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-properties"]],viewQuery:function(n,o){if(1&n&&e.GBs(Pn,5),2&n){let r;e.mGM(r=e.lsd())&&(o.editor=r.first)}},inputs:{canvas:"canvas"},standalone:!0,features:[e.aNF],decls:5,vars:4,consts:[["editor",""],[3,"change","formGroup"],[3,"fields","values"]],template:function(n,o){if(1&n){const r=e.RV6();e.j41(0,"p"),e.EFF(1),e.k0s(),e.j41(2,"form",1),e.bIt("change",function(){return e.eBV(r),e.Njj(o.onChange())}),e.nrm(3,"im-smart-editor",2,0),e.k0s()}if(2&n){const r=e.sdS(4);e.R7$(),e.SpI("\u7ec4\u4ef6\uff1a",null==o.component?null:o.component.name,""),e.R7$(),e.Y8G("formGroup",r.group),e.R7$(),e.Y8G("fields",o.fields)("values",o.data)}},dependencies:[gt.Ay,E.X1,E.qT,E.cb,E.j4]})}return i})();var $t=m(2047);function Rn(i,s){if(1&i){const t=e.RV6();e.j41(0,"form",1),e.bIt("change",function(o){e.eBV(t);const r=e.XpG();return e.Njj(r.onChange(o))}),e.EFF(1," X "),e.nrm(2,"nz-input-number",2),e.EFF(3," Y "),e.nrm(4,"nz-input-number",3),e.EFF(5," \u5bbd\u5ea6 "),e.nrm(6,"nz-input-number",4),e.EFF(7," \u9ad8\u5ea6 "),e.nrm(8,"nz-input-number",5),e.EFF(9," \u89d2\u5ea6 "),e.nrm(10,"nz-input-number",6),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("formGroup",t.form)}}let Me=(()=>{class i{onCellChangeSize(t){t.cell==this.cell&&this.form.patchValue(t.current)}onCellChangePosition(t){t.cell==this.cell&&this.form.patchValue(t.current)}onCellChangeAngle(t){t.cell==this.cell&&this.form.patchValue(t.current)}onCellSelected(t){if(this.cell=t.cell,this.cell.isNode()){const n=this.cell.getPosition(),o=this.cell.getSize(),r=this.cell.getAngle();this.form.patchValue(n),this.form.patchValue(o),this.form.patchValue({angle:r})}else this.cell=void 0}ngOnInit(){this.canvas.graph.on("cell:change:size",this.onCellChangeSize,this),this.canvas.graph.on("cell:change:position",this.onCellChangePosition,this),this.canvas.graph.on("cell:change:angle",this.onCellChangeAngle,this),this.canvas.graph.on("cell:selected",this.onCellSelected,this);let t=this.canvas.graph.getSelectedCells();t.length>0&&this.onCellSelected({cell:t[t.length-1]})}ngOnDestroy(){this.canvas.graph.off("cell:change:size",this.onCellChangeSize),this.canvas.graph.off("cell:change:position",this.onCellChangePosition),this.canvas.graph.off("cell:change:angle",this.onCellChangeAngle),this.canvas.graph.off("cell:selected",this.onCellSelected)}constructor(t,n){this.fb=t,this.cs=n,this.selected=[],this.form=t.group({x:[0,[E.k0.required]],y:[0,[E.k0.required]],width:[0,[E.k0.required]],height:[0,[E.k0.required]],angle:[0,[E.k0.required]]})}onChange(t){this.cell?.isNode()&&(this.cell.setPosition(this.form.value),this.cell.setSize(this.form.value),this.cell.angle(this.form.value.angle))}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(E.ok),e.rXU(it.b))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-transform"]],inputs:{canvas:"canvas"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[3,"formGroup","change",4,"ngIf"],[3,"change","formGroup"],["formControlName","x"],["formControlName","y"],["formControlName","width"],["formControlName","height"],["formControlName","angle"]],template:function(n,o){1&n&&e.DNE(0,Rn,11,1,"form",0),2&n&&e.Y8G("ngIf",o.cell)},dependencies:[T.MD,T.bT,E.YN,E.qT,E.BC,E.cb,E.X1,E.j4,E.JD,$t.FG],styles:["nz-input-number[_ngcontent-%COMP%]{width:50px}"]})}return i})(),Pe=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-props"]],inputs:{canvas:"canvas"},standalone:!0,features:[e.aNF],decls:7,vars:3,consts:[["nzHeader","\u753b\u5e03","nzActive",""],[3,"page"],["nzHeader","\u53d8\u6362","nzActive",""],[3,"canvas"],["nzHeader","\u5c5e\u6027","nzActive",""]],template:function(n,o){1&n&&(e.j41(0,"nz-collapse")(1,"nz-collapse-panel",0),e.nrm(2,"app-page",1),e.k0s(),e.j41(3,"nz-collapse-panel",2),e.nrm(4,"app-transform",3),e.k0s(),e.j41(5,"nz-collapse-panel",4),e.nrm(6,"app-properties",3),e.k0s()()),2&n&&(e.R7$(2),e.Y8G("page",o.canvas.page),e.R7$(2),e.Y8G("canvas",o.canvas),e.R7$(2),e.Y8G("canvas",o.canvas))},dependencies:[Ne,De,vt,xt,Me]})}return i})();var K,i,Lt,c=m(1325);class Re extends c.Ss{get model(){return this.graph.model}get view(){return this.graph.renderer.findViewByCell(this.node)}get containerClassName(){return this.prefixClassName("widget-transform")}get resizeClassName(){return`${this.containerClassName}-resize`}get rotateClassName(){return`${this.containerClassName}-rotate`}constructor(s,t,n){super(),this.node=t,this.graph=n,this.options=Object.assign(Object.assign({},K.defaultOptions),s),this.render(),this.startListening()}startListening(){this.delegateEvents({[`mousedown .${this.resizeClassName}`]:"startResizing",[`touchstart .${this.resizeClassName}`]:"startResizing",[`mousedown .${this.rotateClassName}`]:"startRotating",[`touchstart .${this.rotateClassName}`]:"startRotating"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.node.on("removed",this.remove,this),this.model.on("reseted",this.remove,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this)}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.node.off("removed",this.remove,this),this.model.off("reseted",this.remove,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this)}renderHandles(){this.container=document.createElement("div");const s=document.createElement("div");c.Jf.attr(s,"draggable","false");const t=s.cloneNode(!0);c.Jf.addClass(t,this.rotateClassName);const n=K.POSITIONS.map(o=>{const r=s.cloneNode(!0);return c.Jf.addClass(r,this.resizeClassName),c.Jf.attr(r,"data-position",o),r});this.empty(),c.Jf.append(this.container,[...n,t])}render(){return this.renderHandles(),this.view&&this.view.addClass(K.NODE_CLS),c.Jf.addClass(this.container,this.containerClassName),c.Jf.toggleClass(this.container,"no-orth-resize",this.options.preserveAspectRatio||!this.options.orthogonalResizing),c.Jf.toggleClass(this.container,"no-resize",!this.options.resizable),c.Jf.toggleClass(this.container,"no-rotate",!this.options.rotatable),this.options.className&&c.Jf.addClass(this.container,this.options.className),this.graph.container.appendChild(this.container),this.update()}update(){const s=this.graph.matrix(),t=this.node.getBBox();t.x*=s.a,t.x+=s.e,t.y*=s.d,t.y+=s.f,t.width*=s.a,t.height*=s.d;const n=c.uM.normalize(this.node.getAngle());return c.Jf.css(this.container,{transform:0!==n?`rotate(${n}deg)`:"",width:t.width,height:t.height,left:t.x,top:t.y}),this.updateResizerDirections(),this}remove(){return this.view&&this.view.removeClass(K.NODE_CLS),super.remove()}onKnobMouseDown(){this.startHandle()}onKnobMouseUp(){this.stopHandle()}updateResizerDirections(){const s=c.uM.normalize(this.node.getAngle()),t=Math.floor(s*(K.DIRECTIONS.length/360));if(t!==this.prevShift){const n=K.DIRECTIONS.slice(t).concat(K.DIRECTIONS.slice(0,t)),o=a=>`${this.containerClassName}-cursor-${a}`;this.container.querySelectorAll(`.${this.resizeClassName}`).forEach((a,l)=>{c.Jf.removeClass(a,K.DIRECTIONS.map(d=>o(d)).join(" ")),c.Jf.addClass(a,o(n[l]))}),this.prevShift=t}}getTrueDirection(s){const t=c.uM.normalize(this.node.getAngle());let n=K.POSITIONS.indexOf(s);return n+=Math.floor(t*(K.POSITIONS.length/360)),n%=K.POSITIONS.length,K.POSITIONS[n]}toValidResizeDirection(s){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[s]||s}startResizing(s){s.stopPropagation(),this.model.startBatch("resize",{cid:this.cid});const t=c.Jf.attr(s.target,"data-position");this.prepareResizing(s,t),this.startAction(s)}prepareResizing(s,t){const n=this.getTrueDirection(t);let o=0,r=0;t.split("-").forEach(p=>{o={left:-1,right:1}[p]||o,r={top:-1,bottom:1}[p]||r});const a=this.toValidResizeDirection(t),l={"top-right":"bottomLeft","top-left":"bottomRight","bottom-left":"topRight","bottom-right":"topLeft"}[a],d=c.uM.normalize(this.node.getAngle());this.setEventData(s,{selector:l,direction:a,trueDirection:n,relativeDirection:t,angle:d,resizeX:o,resizeY:r,action:"resizing"})}startRotating(s){s.stopPropagation(),this.model.startBatch("rotate",{cid:this.cid});const t=this.node.getBBox().getCenter(),n=this.normalizeEvent(s),o=this.graph.snapToGrid(n.clientX,n.clientY);this.setEventData(s,{center:t,action:"rotating",angle:c.uM.normalize(this.node.getAngle()),start:c.bR.create(o).theta(t)}),this.startAction(s)}onMouseMove(s){const t=this.graph.findViewByCell(this.node);let n=this.getEventData(s);if(n.action){const o=this.normalizeEvent(s);let r=o.clientX,a=o.clientY;const l=this.graph.getPlugin("scroller"),d=this.options.restrictedResizing;if(!0===d||"number"==typeof d){const v=!0===d?0:d,w=l?Math.max(v,8):v,b=this.graph.container.getBoundingClientRect();r=c.Dc.clamp(r,b.left+w,b.right-w),a=c.Dc.clamp(a,b.top+w,b.bottom-w)}else this.options.autoScrollOnResizing&&l&&l.autoScroll(r,a);const p=this.graph.snapToGrid(r,a),h=this.graph.getGridSize(),u=this.node,f=this.options;if("resizing"===n.action){n.resized||(t&&(t.addClass("node-resizing"),this.notify("node:resize",s,t)),n.resized=!0);const v=u.getBBox(),w=c.bR.create(p).rotate(n.angle,v.getCenter()).diff(v[n.selector]);let b=n.resizeX?w.x*n.resizeX:v.width,_=n.resizeY?w.y*n.resizeY:v.height;const k=b,z=_;if(b=c.fZ.snapToGrid(b,h),_=c.fZ.snapToGrid(_,h),b=Math.max(b,f.minWidth||h),_=Math.max(_,f.minHeight||h),b=Math.min(b,f.maxWidth||1/0),_=Math.min(_,f.maxHeight||1/0),f.preserveAspectRatio){const x=v.width*_/v.height;b<x?_=v.height*b/v.width:b=x}const A=n.relativeDirection;if(f.allowReverse&&(k<=-b||z<=-_)){let x;"left"===A?k<=-b&&(x="right"):"right"===A?k<=-b&&(x="left"):"top"===A?z<=-_&&(x="bottom"):"bottom"===A?z<=-_&&(x="top"):"top-left"===A?k<=-b&&z<=-_?x="bottom-right":k<=-b?x="top-right":z<=-_&&(x="bottom-left"):"top-right"===A?k<=-b&&z<=-_?x="bottom-left":k<=-b?x="top-left":z<=-_&&(x="bottom-right"):"bottom-left"===A?k<=-b&&z<=-_?x="top-right":k<=-b?x="bottom-right":z<=-_&&(x="top-left"):"bottom-right"===A&&(k<=-b&&z<=-_?x="top-left":k<=-b?x="bottom-left":z<=-_&&(x="top-right"));const B=x;this.stopHandle();const X=this.container.querySelector(`.${this.resizeClassName}[data-position="${B}"]`);this.startHandle(X),this.prepareResizing(s,B),this.onMouseMove(s)}v.width===b&&v.height===_||(u.resize(b,_,{ui:!0,direction:n.direction,relativeDirection:n.relativeDirection,trueDirection:n.trueDirection,minWidth:f.minWidth,minHeight:f.minHeight,maxWidth:f.maxWidth,maxHeight:f.maxHeight,preserveAspectRatio:!0===f.preserveAspectRatio}),this.notify("node:resizing",s,t))}else if("rotating"===n.action){n.rotated||(t&&(t.addClass("node-rotating"),this.notify("node:rotate",s,t)),n.rotated=!0);const v=u.getAngle(),w=n.start-c.bR.create(p).theta(n.center);let b=n.angle+w;f.rotateGrid&&(b=c.fZ.snapToGrid(b,f.rotateGrid)),b=c.uM.normalize(b),v!==b&&(u.rotate(b,{absolute:!0}),this.notify("node:rotating",s,t))}}}onMouseUp(s){const t=this.getEventData(s);t.action&&(this.stopAction(s),this.model.stopBatch("resizing"===t.action?"resize":"rotate",{cid:this.cid}))}startHandle(s){if(this.handle=s||null,c.Jf.addClass(this.container,`${this.containerClassName}-active`),s){c.Jf.addClass(s,`${this.containerClassName}-active-handle`);const t=s.getAttribute("data-position");if(t){const n=K.DIRECTIONS[K.POSITIONS.indexOf(t)];c.Jf.addClass(this.container,`${this.containerClassName}-cursor-${n}`)}}}stopHandle(){if(c.Jf.removeClass(this.container,`${this.containerClassName}-active`),this.handle){c.Jf.removeClass(this.handle,`${this.containerClassName}-active-handle`);const s=this.handle.getAttribute("data-position");if(s){const t=K.DIRECTIONS[K.POSITIONS.indexOf(s)];c.Jf.removeClass(this.container,`${this.containerClassName}-cursor-${t}`)}this.handle=null}}startAction(s){this.startHandle(s.target),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(K.documentEvents,s.data)}stopAction(s){this.stopHandle(),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const t=this.graph.findViewByCell(this.node),n=this.getEventData(s);t&&(t.removeClass(`node-${n.action}`),"resizing"===n.action&&n.resized?this.notify("node:resized",s,t):"rotating"===n.action&&n.rotated&&this.notify("node:rotated",s,t))}notify(s,t,n,o={}){if(n){const r=n.graph,a=r.view.normalizeEvent(t),l=r.snapToGrid(a.clientX,a.clientY);this.trigger(s,Object.assign({e:a,view:n,node:n.cell,cell:n.cell,x:l.x,y:l.y},o))}}dispose(){this.stopListening(),this.remove(),this.off()}}!function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)}([c.Ss.dispose()],Re.prototype,"dispose",null),(i=K||(K={})).NODE_CLS="has-widget-transform",i.DIRECTIONS=["nw","n","ne","e","se","s","sw","w"],i.POSITIONS=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],i.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"},i.defaultOptions={minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,rotateGrid:15,rotatable:!0,preserveAspectRatio:!1,orthogonalResizing:!0,restrictedResizing:!1,autoScrollOnResizing:!0,allowReverse:!0},c.ke.prototype.createTransformWidget=function(i){const s=this.getPlugin("transform");return s&&s.createWidget(i),this},c.ke.prototype.clearTransformWidgets=function(){const i=this.getPlugin("transform");return i&&i.clearWidgets(),this};class wt extends c.Nb{constructor(s={}){super(),this.name="transform",this.widgets=new Map,this.disabled=!1,this.options=s,c.H.ensure(this.name,".x6-widget-transform {\n  position: absolute;\n  box-sizing: content-box !important;\n  margin: -5px 0 0 -5px;\n  padding: 4px;\n  border: 1px dashed #000;\n  border-radius: 5px;\n  user-select: none;\n  pointer-events: none;\n}\n.x6-widget-transform > div {\n  position: absolute;\n  box-sizing: border-box;\n  background-color: #fff;\n  border: 1px solid #000;\n  transition: background-color 0.2s;\n  pointer-events: auto;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-transform > div:hover {\n  background-color: #d3d3d3;\n}\n.x6-widget-transform-cursor-n {\n  cursor: n-resize;\n}\n.x6-widget-transform-cursor-s {\n  cursor: s-resize;\n}\n.x6-widget-transform-cursor-e {\n  cursor: e-resize;\n}\n.x6-widget-transform-cursor-w {\n  cursor: w-resize;\n}\n.x6-widget-transform-cursor-ne {\n  cursor: ne-resize;\n}\n.x6-widget-transform-cursor-nw {\n  cursor: nw-resize;\n}\n.x6-widget-transform-cursor-se {\n  cursor: se-resize;\n}\n.x6-widget-transform-cursor-sw {\n  cursor: sw-resize;\n}\n.x6-widget-transform-resize {\n  width: 10px;\n  height: 10px;\n  border-radius: 6px;\n}\n.x6-widget-transform-resize[data-position='top-left'] {\n  top: -5px;\n  left: -5px;\n}\n.x6-widget-transform-resize[data-position='top-right'] {\n  top: -5px;\n  right: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom-left'] {\n  bottom: -5px;\n  left: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom-right'] {\n  right: -5px;\n  bottom: -5px;\n}\n.x6-widget-transform-resize[data-position='top'] {\n  top: -5px;\n  left: 50%;\n  margin-left: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom'] {\n  bottom: -5px;\n  left: 50%;\n  margin-left: -5px;\n}\n.x6-widget-transform-resize[data-position='left'] {\n  top: 50%;\n  left: -5px;\n  margin-top: -5px;\n}\n.x6-widget-transform-resize[data-position='right'] {\n  top: 50%;\n  right: -5px;\n  margin-top: -5px;\n}\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='top'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='bottom'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='left'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='right'] {\n  display: none;\n}\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='bottom'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='left'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='right'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='top'] {\n  display: none;\n}\n.x6-widget-transform.no-resize .x6-widget-transform-resize {\n  display: none;\n}\n.x6-widget-transform-rotate {\n  top: -20px;\n  left: -20px;\n  width: 12px;\n  height: 12px;\n  border-radius: 6px;\n  cursor: crosshair;\n}\n.x6-widget-transform.no-rotate .x6-widget-transform-rotate {\n  display: none;\n}\n.x6-widget-transform-active {\n  border-color: transparent;\n  pointer-events: all;\n}\n.x6-widget-transform-active > div {\n  display: none;\n}\n.x6-widget-transform-active > .x6-widget-transform-active-handle {\n  display: block;\n  background-color: #808080;\n}\n")}init(s){this.graph=s,!this.disabled&&this.startListening()}startListening(){this.graph.on("node:click",this.onNodeClick,this),this.graph.on("blank:mousedown",this.onBlankMouseDown,this)}stopListening(){this.graph.off("node:click",this.onNodeClick,this),this.graph.off("blank:mousedown",this.onBlankMouseDown,this)}enable(){this.disabled&&(this.disabled=!1,this.startListening())}disable(){this.disabled||(this.disabled=!0,this.stopListening())}isEnabled(){return!this.disabled}createWidget(s){this.clearWidgets();const t=this.createTransform(s);t&&(this.widgets.set(s,t),t.on("*",(n,o)=>{this.trigger(n,o),this.graph.trigger(n,o)}))}onNodeClick({node:s}){this.createWidget(s)}onBlankMouseDown(){this.clearWidgets()}createTransform(s){const t=this.getTransformOptions(s);return t.resizable||t.rotatable?new Re(t,s,this.graph):null}getTransformOptions(s){this.options.resizing||(this.options.resizing={enabled:!1}),this.options.rotating||(this.options.rotating={enabled:!1}),"boolean"==typeof this.options.resizing&&(this.options.resizing={enabled:this.options.resizing}),"boolean"==typeof this.options.rotating&&(this.options.rotating={enabled:this.options.rotating});const t=wt.parseOptionGroup(this.graph,s,this.options.resizing),n=wt.parseOptionGroup(this.graph,s,this.options.rotating);return{resizable:!!t.enabled,minWidth:t.minWidth||0,maxWidth:t.maxWidth||Number.MAX_SAFE_INTEGER,minHeight:t.minHeight||0,maxHeight:t.maxHeight||Number.MAX_SAFE_INTEGER,orthogonalResizing:"boolean"!=typeof t.orthogonal||t.orthogonal,restrictedResizing:!!t.restrict,autoScrollOnResizing:"boolean"!=typeof t.autoScroll||t.autoScroll,preserveAspectRatio:!!t.preserveAspectRatio,allowReverse:"boolean"!=typeof t.allowReverse||t.allowReverse,rotatable:!!n.enabled,rotateGrid:n.grid||15}}clearWidgets(){this.widgets.forEach((s,t)=>{this.graph.getCellById(t.id)&&s.dispose()}),this.widgets.clear()}dispose(){this.clearWidgets(),this.stopListening(),this.off(),c.H.clean(this.name)}}(function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)})([c.Nb.dispose()],wt.prototype,"dispose",null),function(i){i.parseOptionGroup=function s(t,n,o){const r={};return Object.keys(o||{}).forEach(a=>{const l=o[a];r[a]="function"==typeof l?l.call(t,n):l}),r}}(wt||(wt={}));class Be extends c.Ss{get model(){return this.graph.model}get containerClassName(){return this.prefixClassName("widget-snapline")}get verticalClassName(){return`${this.containerClassName}-vertical`}get horizontalClassName(){return`${this.containerClassName}-horizontal`}constructor(s){super();const{graph:t}=s,n=function(i,s){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&s.indexOf(n)<0&&(t[n]=i[n]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)s.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(t[n[o]]=i[n[o]])}return t}(s,["graph"]);this.graph=t,this.options=Object.assign({},n),this.offset={x:0,y:0},this.render(),this.disabled||this.startListening()}get disabled(){return!0!==this.options.enabled}enable(){this.disabled&&(this.options.enabled=!0,this.startListening())}disable(){this.disabled||(this.options.enabled=!1,this.stopListening())}setFilter(s){this.options.filter=s}render(){const s=this.containerWrapper=new c.Mi("svg"),t=this.horizontal=new c.Mi("line"),n=this.vertical=new c.Mi("line");s.addClass(this.containerClassName),t.addClass(this.horizontalClassName),n.addClass(this.verticalClassName),s.setAttribute("width","100%"),s.setAttribute("height","100%"),t.setAttribute("display","none"),n.setAttribute("display","none"),s.append([t,n]),this.options.className&&s.addClass(this.options.className),this.container=this.containerWrapper.node}startListening(){this.stopListening(),this.graph.on("node:mousedown",this.captureCursorOffset,this),this.graph.on("node:mousemove",this.snapOnMoving,this),this.model.on("batch:stop",this.onBatchStop,this),this.delegateDocumentEvents({mouseup:"hide",touchend:"hide"})}stopListening(){this.graph.off("node:mousedown",this.captureCursorOffset,this),this.graph.off("node:mousemove",this.snapOnMoving,this),this.model.off("batch:stop",this.onBatchStop,this),this.undelegateDocumentEvents()}onBatchStop({name:s,data:t}){"resize"===s&&this.snapOnResizing(t.cell,t)}captureCursorOffset({view:s,x:t,y:n}){const o=s.getDelegatedView();if(o&&this.isNodeMovable(o)){const r=s.cell.getPosition();this.offset={x:t-r.x,y:n-r.y}}}isNodeMovable(s){return s&&s.cell.isNode()&&s.can("nodeMovable")}getRestrictArea(s){const t=this.graph.options.translating.restrict,n="function"==typeof t?c.eY.call(t,this.graph,s):t;return"number"==typeof n?this.graph.transform.getGraphArea().inflate(n):!0===n?this.graph.transform.getGraphArea():n||null}snapOnResizing(s,t){if(this.options.resizing&&!t.snapped&&t.ui&&t.direction&&t.trueDirection){const n=this.graph.renderer.findViewByCell(s);if(n&&n.cell.isNode()){const o=s.getBBox(),r=o.bbox(s.getAngle()),a=r.getTopLeft(),l=r.getBottomRight(),d=c.uM.normalize(s.getAngle()),p=this.options.tolerance||0;let h,u,f,v,w,b;const _={vertical:0,horizontal:0},k=t.direction,z=t.trueDirection,A=t.relativeDirection;_.vertical=-1!==z.indexOf("right")?l.x:a.x,_.horizontal=-1!==z.indexOf("bottom")?l.y:a.y,this.model.getNodes().some(j=>{if(this.isIgnored(s,j))return!1;const Q=j.getBBox().bbox(j.getAngle()),zt=Q.getTopLeft(),Ut=Q.getBottomRight(),Ee={vertical:[zt.x,Ut.x],horizontal:[zt.y,Ut.y]},Pt={};return Object.keys(Ee).forEach(En=>{const ae=En,In=Ee[ae].map(Tt=>({position:Tt,distance:Math.abs(Tt-_[ae])})).filter(Tt=>Tt.distance<=p);Pt[ae]=c.Rw.sortBy(In,Tt=>Tt.distance)}),null==h&&Pt.vertical.length>0&&(h=Pt.vertical[0].position,u=Math.min(r.y,Q.y),f=Math.max(l.y,Ut.y)-u),null==v&&Pt.horizontal.length>0&&(v=Pt.horizontal[0].position,w=Math.min(r.x,Q.x),b=Math.max(l.x,Ut.x)-w),null!=h&&null!=v}),this.hide();let x=0,B=0;(null!=v||null!=h)&&(null!=h&&(x=-1!==z.indexOf("right")?h-l.x:a.x-h),null!=v&&(B=-1!==z.indexOf("bottom")?v-l.y:a.y-v));let X=0,$=0;if(d%90==0)90===d||270===d?(X=B,$=x):(X=x,$=B);else{const j=d>=0&&d<90?1:d>=90&&d<180?4:d>=180&&d<270?3:2;null!=v&&null!=h&&(x<B?(B=0,v=void 0):(x=0,h=void 0));const Q=c.uM.toRad(d%90);x&&(X=3===j?x/Math.cos(Q):x/Math.sin(Q)),B&&($=3===j?B/Math.cos(Q):B/Math.sin(Q));const zt=1===j||3===j;switch(A){case"top":case"bottom":$=B?B/(zt?Math.cos(Q):Math.sin(Q)):x/(zt?Math.sin(Q):Math.cos(Q));break;case"left":case"right":X=x?x/(zt?Math.cos(Q):Math.sin(Q)):B/(zt?Math.sin(Q):Math.cos(Q))}}switch(A){case"top":case"bottom":X=0;break;case"left":case"right":$=0}const st=this.graph.getGridSize();let Z=Math.max(o.width+X,st),tt=Math.max(o.height+$,st);t.minWidth&&t.minWidth>st&&(Z=Math.max(Z,t.minWidth)),t.minHeight&&t.minHeight>st&&(tt=Math.max(tt,t.minHeight)),t.maxWidth&&(Z=Math.min(Z,t.maxWidth)),t.maxHeight&&(tt=Math.min(tt,t.maxHeight)),t.preserveAspectRatio&&($<X?tt=Z*(o.height/o.width):Z=tt*(o.width/o.height)),(Z!==o.width||tt!==o.height)&&(s.resize(Z,tt,{direction:k,relativeDirection:A,trueDirection:z,snapped:!0,snaplines:this.cid,restrict:this.getRestrictArea(n)}),f&&(f+=tt-o.height),b&&(b+=Z-o.width));const U=s.getBBox().bbox(d);h&&Math.abs(U.x-h)>1&&Math.abs(U.width+U.x-h)>1&&(h=void 0),v&&Math.abs(U.y-v)>1&&Math.abs(U.height+U.y-v)>1&&(v=void 0),this.update({verticalLeft:h,verticalTop:u,verticalHeight:f,horizontalTop:v,horizontalLeft:w,horizontalWidth:b})}}}snapOnMoving({view:s,e:t,x:n,y:o}){const r=s.getEventData(t).delegatedView||s;if(!this.isNodeMovable(r))return;const a=r.cell,l=a.getSize(),d=a.getPosition(),p=new c.M_(n-this.offset.x,o-this.offset.y,l.width,l.height),h=a.getAngle(),u=p.getCenter(),f=p.bbox(h),v=f.getTopLeft(),w=f.getBottomRight(),b=this.options.tolerance||0;let _,k,z,A,x,B,X=0,$=0;if(this.model.getNodes().some(st=>{if(this.isIgnored(a,st))return!1;const Z=st.getBBox().bbox(st.getAngle()),tt=Z.getCenter(),U=Z.getTopLeft(),j=Z.getBottomRight();return null==_&&(Math.abs(tt.x-u.x)<b?(_=tt.x,X=.5):Math.abs(U.x-v.x)<b?(_=U.x,X=0):Math.abs(U.x-w.x)<b?(_=U.x,X=1):Math.abs(j.x-w.x)<b?(_=j.x,X=1):Math.abs(j.x-v.x)<b&&(_=j.x),null!=_&&(k=Math.min(f.y,Z.y),z=Math.max(w.y,j.y)-k)),null==A&&(Math.abs(tt.y-u.y)<b?(A=tt.y,$=.5):Math.abs(U.y-v.y)<b?A=U.y:Math.abs(U.y-w.y)<b?(A=U.y,$=1):Math.abs(j.y-w.y)<b?(A=j.y,$=1):Math.abs(j.y-v.y)<b&&(A=j.y),null!=A&&(x=Math.min(f.x,Z.x),B=Math.max(w.x,j.x)-x)),null!=_&&null!=A}),this.hide(),null!=A||null!=_){null!=A&&(f.y=A-$*f.height),null!=_&&(f.x=_-X*f.width);const st=f.getCenter(),U=st.x-p.width/2-d.x,j=st.y-p.height/2-d.y;(0!==U||0!==j)&&(a.translate(U,j,{snapped:!0,restrict:this.getRestrictArea(r)}),B&&(B+=U),z&&(z+=j)),this.update({verticalLeft:_,verticalTop:k,verticalHeight:z,horizontalTop:A,horizontalLeft:x,horizontalWidth:B})}}isIgnored(s,t){return t.id===s.id||t.isDescendantOf(s)||!this.filter(t)}filter(s){const t=this.options.filter;return Array.isArray(t)?t.some(n=>"string"==typeof n?s.shape===n:s.id===n.id):"function"!=typeof t||c.eY.call(t,this.graph,s)}update(s){if(s.horizontalTop){const t=this.graph.localToGraph(new c.bR(s.horizontalLeft,s.horizontalTop)),n=this.graph.localToGraph(new c.bR(s.horizontalLeft+s.horizontalWidth,s.horizontalTop));this.horizontal.setAttributes({x1:this.options.sharp?`${t.x}`:"0",y1:`${t.y}`,x2:this.options.sharp?`${n.x}`:"100%",y2:`${n.y}`,display:"inherit"})}else this.horizontal.setAttribute("display","none");if(s.verticalLeft){const t=this.graph.localToGraph(new c.bR(s.verticalLeft,s.verticalTop)),n=this.graph.localToGraph(new c.bR(s.verticalLeft,s.verticalTop+s.verticalHeight));this.vertical.setAttributes({x1:`${t.x}`,y1:this.options.sharp?`${t.y}`:"0",x2:`${n.x}`,y2:this.options.sharp?`${n.y}`:"100%",display:"inherit"})}else this.vertical.setAttribute("display","none");this.show()}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}show(){return this.resetTimer(),null==this.container.parentNode&&this.graph.container.appendChild(this.container),this}hide(){this.resetTimer(),this.vertical.setAttribute("display","none"),this.horizontal.setAttribute("display","none");const s=this.options.clean,t="number"==typeof s?s:!1!==s?3e3:0;return t>0&&(this.timer=window.setTimeout(()=>{null!==this.container.parentNode&&this.unmount()},t)),this}onRemove(){this.stopListening(),this.hide()}dispose(){this.remove()}}!function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)}([c.Ss.dispose()],Be.prototype,"dispose",null),c.ke.prototype.isSnaplineEnabled=function(){const i=this.getPlugin("snapline");return!!i&&i.isEnabled()},c.ke.prototype.enableSnapline=function(){const i=this.getPlugin("snapline");return i&&i.enable(),this},c.ke.prototype.disableSnapline=function(){const i=this.getPlugin("snapline");return i&&i.disable(),this},c.ke.prototype.toggleSnapline=function(){const i=this.getPlugin("snapline");return i&&i.toggleEnabled(),this},c.ke.prototype.hideSnapline=function(){const i=this.getPlugin("snapline");return i&&i.hide(),this},c.ke.prototype.setSnaplineFilter=function(i){const s=this.getPlugin("snapline");return s&&s.setFilter(i),this},c.ke.prototype.isSnaplineOnResizingEnabled=function(){const i=this.getPlugin("snapline");return!!i&&i.isOnResizingEnabled()},c.ke.prototype.enableSnaplineOnResizing=function(){const i=this.getPlugin("snapline");return i&&i.enableOnResizing(),this},c.ke.prototype.disableSnaplineOnResizing=function(){const i=this.getPlugin("snapline");return i&&i.disableOnResizing(),this},c.ke.prototype.toggleSnaplineOnResizing=function(i){const s=this.getPlugin("snapline");return s&&s.toggleOnResizing(i),this},c.ke.prototype.isSharpSnapline=function(){const i=this.getPlugin("snapline");return!!i&&i.isSharp()},c.ke.prototype.enableSharpSnapline=function(){const i=this.getPlugin("snapline");return i&&i.enableSharp(),this},c.ke.prototype.disableSharpSnapline=function(){const i=this.getPlugin("snapline");return i&&i.disableSharp(),this},c.ke.prototype.toggleSharpSnapline=function(i){const s=this.getPlugin("snapline");return s&&s.toggleSharp(i),this},c.ke.prototype.getSnaplineTolerance=function(){const i=this.getPlugin("snapline");if(i)return i.getTolerance()},c.ke.prototype.setSnaplineTolerance=function(i){const s=this.getPlugin("snapline");return s&&s.setTolerance(i),this};class Oe extends c.jG{constructor(s={}){super(),this.name="snapline",this.options=Object.assign({enabled:!0,tolerance:10},s),c.H.ensure(this.name,".x6-widget-snapline {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  pointer-events: none;\n}\n.x6-widget-snapline-vertical,\n.x6-widget-snapline-horizontal {\n  stroke: #2ecc71;\n  stroke-width: 1px;\n}\n")}init(s){this.snaplineImpl=new Be(Object.assign(Object.assign({},this.options),{graph:s}))}isEnabled(){return!this.snaplineImpl.disabled}enable(){this.snaplineImpl.enable()}disable(){this.snaplineImpl.disable()}toggleEnabled(s){if(null==s)return this.isEnabled()?this.disable():this.enable(),this;s!==this.isEnabled()&&(s?this.enable():this.disable())}hide(){return this.snaplineImpl.hide(),this}setFilter(s){return this.snaplineImpl.setFilter(s),this}isOnResizingEnabled(){return!0===this.snaplineImpl.options.resizing}enableOnResizing(){return this.snaplineImpl.options.resizing=!0,this}disableOnResizing(){return this.snaplineImpl.options.resizing=!1,this}toggleOnResizing(s){return null!=s?s!==this.isOnResizingEnabled()&&(s?this.enableOnResizing():this.disableOnResizing()):this.isOnResizingEnabled()?this.disableOnResizing():this.enableOnResizing(),this}isSharp(){return!0===this.snaplineImpl.options.sharp}enableSharp(){return this.snaplineImpl.options.sharp=!0,this}disableSharp(){return this.snaplineImpl.options.sharp=!1,this}toggleSharp(s){return null!=s?s!==this.isSharp()&&(s?this.enableSharp():this.disableSharp()):this.isSharp()?this.disableSharp():this.enableSharp(),this}getTolerance(){return this.snaplineImpl.options.tolerance}setTolerance(s){return this.snaplineImpl.options.tolerance=s,this}captureCursorOffset(s){this.snaplineImpl.captureCursorOffset(s)}snapOnMoving(s){this.snaplineImpl.snapOnMoving(s)}dispose(){this.snaplineImpl.dispose(),c.H.clean(this.name)}}!function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)}([c.jG.dispose()],Oe.prototype,"dispose",null);class Yn{constructor(){this.cells=[]}copy(s,t,n={}){this.options=Object.assign({},n);const r=(c.Kx.isModel(t)?t:t.model).cloneSubGraph(s,n);this.cells=c.Rw.sortBy(Object.keys(r).map(a=>r[a]),a=>a.isEdge()?2:1),this.serialize(n)}cut(s,t,n={}){this.copy(s,t,n),(c.ke.isGraph(t)?t.model:t).batchUpdate("cut",()=>{s.forEach(r=>r.remove())})}paste(s,t={}){const n=Object.assign(Object.assign({},this.options),t),{offset:o,edgeProps:r,nodeProps:a}=n;let l=20,d=20;o&&(l="number"==typeof o?o:o.dx,d="number"==typeof o?o:o.dy),this.deserialize(n);const p=this.cells;p.forEach(u=>{u.model=null,u.removeProp("zIndex"),(l||d)&&u.translate(l,d),a&&u.isNode()&&u.prop(a),r&&u.isEdge()&&u.prop(r)});const h=c.ke.isGraph(s)?s.model:s;return h.batchUpdate("paste",()=>{h.addCells(this.cells)}),this.copy(p,s,t),p}serialize(s){!1!==s.useLocalStorage&&Lt.save(this.cells)}deserialize(s){if(s.useLocalStorage){const t=Lt.fetch();t&&(this.cells=t)}}isEmpty(s={}){return s.useLocalStorage&&this.deserialize(s),this.cells.length<=0}clean(){this.options={},this.cells=[],Lt.clean()}}(function(i){const s=`${c.TS.prefixCls}.clipboard.cells`;i.save=function t(r){if(window.localStorage){const a=r.map(l=>l.toJSON());localStorage.setItem(s,JSON.stringify(a))}},i.fetch=function n(){if(window.localStorage){const r=localStorage.getItem(s),a=r?JSON.parse(r):[];if(a)return c.Kx.fromJSON(a)}},i.clean=function o(){window.localStorage&&localStorage.removeItem(s)}})(Lt||(Lt={})),c.ke.prototype.isClipboardEnabled=function(){const i=this.getPlugin("clipboard");return!!i&&i.isEnabled()},c.ke.prototype.enableClipboard=function(){const i=this.getPlugin("clipboard");return i&&i.enable(),this},c.ke.prototype.disableClipboard=function(){const i=this.getPlugin("clipboard");return i&&i.disable(),this},c.ke.prototype.toggleClipboard=function(i){const s=this.getPlugin("clipboard");return s&&s.toggleEnabled(i),this},c.ke.prototype.isClipboardEmpty=function(i){const s=this.getPlugin("clipboard");return!s||s.isEmpty(i)},c.ke.prototype.getCellsInClipboard=function(){const i=this.getPlugin("clipboard");return i?i.getCellsInClipboard():[]},c.ke.prototype.cleanClipboard=function(){const i=this.getPlugin("clipboard");return i&&i.clean(),this},c.ke.prototype.copy=function(i,s){const t=this.getPlugin("clipboard");return t&&t.copy(i,s),this},c.ke.prototype.cut=function(i,s){const t=this.getPlugin("clipboard");return t&&t.cut(i,s),this},c.ke.prototype.paste=function(i,s){const t=this.getPlugin("clipboard");return t?t.paste(i,s):[]};class Ve extends c.Nb{get disabled(){return!0!==this.options.enabled}get cells(){return this.clipboardImpl.cells}constructor(s={}){super(),this.name="clipboard",this.options=Object.assign({enabled:!0},s)}init(s){this.graph=s,this.clipboardImpl=new Yn,this.clipboardImpl.deserialize(this.options)}isEnabled(){return!this.disabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}toggleEnabled(s){return null!=s?s!==this.isEnabled()&&(s?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}isEmpty(s={}){return this.clipboardImpl.isEmpty(s)}getCellsInClipboard(){return this.cells}clean(s){return(!this.disabled||s)&&(this.clipboardImpl.clean(),this.notify("clipboard:changed",{cells:[]})),this}copy(s,t={}){return this.disabled||(this.clipboardImpl.copy(s,this.graph,Object.assign(Object.assign({},this.commonOptions),t)),this.notify("clipboard:changed",{cells:s})),this}cut(s,t={}){return this.disabled||(this.clipboardImpl.cut(s,this.graph,Object.assign(Object.assign({},this.commonOptions),t)),this.notify("clipboard:changed",{cells:s})),this}paste(s={},t=this.graph){return this.disabled?[]:this.clipboardImpl.paste(t,Object.assign(Object.assign({},this.commonOptions),s))}get commonOptions(){return function(i,s){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&s.indexOf(n)<0&&(t[n]=i[n]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)s.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(t[n[o]]=i[n[o]])}return t}(this.options,["enabled"])}notify(s,t){this.trigger(s,t),this.graph.trigger(s,t)}dispose(){this.clean(!0),this.off()}}!function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)}([c.Nb.dispose()],Ve.prototype,"dispose",null);var Un=m(7184),Wn=m.n(Un);class It extends c.jG{get graph(){return this.options.graph}constructor(s){super(),this.options=s;const t=this.graph.getPlugin("scroller");this.container=t?t.container:this.graph.container,s.global?this.target=document:(this.target=this.container,this.disabled||this.target.setAttribute("tabindex","-1"),this.graph.on("cell:mouseup",this.focus,this),this.graph.on("blank:mouseup",this.focus,this)),this.mousetrap=It.createMousetrap(this)}get disabled(){return!0!==this.options.enabled}enable(){this.disabled&&(this.options.enabled=!0,this.target instanceof HTMLElement&&this.target.setAttribute("tabindex","-1"))}disable(){this.disabled||(this.options.enabled=!1,this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))}on(s,t,n){this.mousetrap.bind(this.getKeys(s),t,n)}off(s,t){this.mousetrap.unbind(this.getKeys(s),t)}clear(){this.mousetrap.reset()}trigger(s,t){this.mousetrap.trigger(s,t)}focus(s){this.isInputEvent(s.e)||this.target.focus({preventScroll:!0})}getKeys(s){return(Array.isArray(s)?s:[s]).map(t=>this.formatkey(t))}formatkey(s){const t=s.toLocaleLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command").replace("arrowup","up").replace("arrowright","right").replace("arrowdown","down").replace("arrowleft","left"),n=this.options.format;return n?c.eY.call(n,this.graph,t):t}isGraphEvent(s){const t=s.target;return!!t&&(t===this.target||s.currentTarget===this.target||t===document.body||c.Jf.contains(this.container,t))}isInputEvent(s){var t;const n=s.target,o=null===(t=n?.tagName)||void 0===t?void 0:t.toLowerCase();let r=["input","textarea"].includes(o);return"true"===c.Jf.attr(n,"contenteditable")&&(r=!0),r}isEnabledForEvent(s){const t=!this.disabled&&this.isGraphEvent(s),n=this.isInputEvent(s);if(t){if(n&&("Backspace"===s.key||"Delete"===s.key))return!1;if(this.options.guard)return c.eY.call(this.options.guard,this.graph,s)}return t}dispose(){this.mousetrap.reset()}}(function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)})([c.jG.dispose()],It.prototype,"dispose",null),function(i){i.createMousetrap=function s(t){const n=new(Wn())(t.target),o=n.stopCallback;return n.stopCallback=(r,a,l)=>!t.isEnabledForEvent(r)||!!o&&o.call(n,r,a,l),n}}(It||(It={})),c.ke.prototype.isKeyboardEnabled=function(){const i=this.getPlugin("keyboard");return!!i&&i.isEnabled()},c.ke.prototype.enableKeyboard=function(){const i=this.getPlugin("keyboard");return i&&i.enable(),this},c.ke.prototype.disableKeyboard=function(){const i=this.getPlugin("keyboard");return i&&i.disable(),this},c.ke.prototype.toggleKeyboard=function(i){const s=this.getPlugin("keyboard");return s&&s.toggleEnabled(i),this},c.ke.prototype.bindKey=function(i,s,t){const n=this.getPlugin("keyboard");return n&&n.bindKey(i,s,t),this},c.ke.prototype.unbindKey=function(i,s){const t=this.getPlugin("keyboard");return t&&t.unbindKey(i,s),this},c.ke.prototype.clearKeys=function(){const i=this.getPlugin("keyboard");return i&&i.clear(),this},c.ke.prototype.triggerKey=function(i,s){const t=this.getPlugin("keyboard");return t&&t.trigger(i,s),this};class Fe extends c.jG{constructor(s={}){super(),this.name="keyboard",this.options=Object.assign({enabled:!0},s)}init(s){this.keyboardImpl=new It(Object.assign(Object.assign({},this.options),{graph:s}))}isEnabled(){return!this.keyboardImpl.disabled}enable(){this.keyboardImpl.enable()}disable(){this.keyboardImpl.disable()}toggleEnabled(s){return null!=s?s!==this.isEnabled()&&(s?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}bindKey(s,t,n){return this.keyboardImpl.on(s,t,n),this}trigger(s,t){return this.keyboardImpl.trigger(s,t),this}clear(){return this.keyboardImpl.clear(),this}unbindKey(s,t){return this.keyboardImpl.off(s,t),this}dispose(){this.keyboardImpl.dispose()}}(function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)})([c.jG.dispose()],Fe.prototype,"dispose",null),c.ke.prototype.isHistoryEnabled=function(){const i=this.getPlugin("history");return!!i&&i.isEnabled()},c.ke.prototype.enableHistory=function(){const i=this.getPlugin("history");return i&&i.enable(),this},c.ke.prototype.disableHistory=function(){const i=this.getPlugin("history");return i&&i.disable(),this},c.ke.prototype.toggleHistory=function(i){const s=this.getPlugin("history");return s&&s.toggleEnabled(i),this},c.ke.prototype.undo=function(i){const s=this.getPlugin("history");return s&&s.undo(i),this},c.ke.prototype.redo=function(i){const s=this.getPlugin("history");return s&&s.redo(i),this},c.ke.prototype.undoAndCancel=function(i){const s=this.getPlugin("history");return s&&s.cancel(i),this},c.ke.prototype.canUndo=function(){const i=this.getPlugin("history");return!!i&&i.canUndo()},c.ke.prototype.canRedo=function(){const i=this.getPlugin("history");return!!i&&i.canRedo()},c.ke.prototype.cleanHistory=function(i){const s=this.getPlugin("history");return s&&s.clean(i),this},c.ke.prototype.getHistoryStackSize=function(){return this.getPlugin("history").getSize()},c.ke.prototype.getUndoStackSize=function(){return this.getPlugin("history").getUndoSize()},c.ke.prototype.getRedoStackSize=function(){return this.getPlugin("history").getRedoSize()},c.ke.prototype.getUndoRemainSize=function(){return this.getPlugin("history").getUndoRemainSize()};var Y,nt,Ge=function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);return o>3&&r&&Object.defineProperty(s,t,r),r};class Nt extends c.Nb{constructor(s={}){super(),this.name="history",this.batchCommands=null,this.batchLevel=0,this.lastBatchIndex=-1,this.freezed=!1,this.stackSize=0,this.handlers=[];const{stackSize:t=0}=s;this.stackSize=t,this.options=Y.getOptions(s),this.validator=new Nt.Validator({history:this,cancelInvalid:this.options.cancelInvalid})}init(s){this.graph=s,this.model=this.graph.model,this.clean(),this.startListening()}isEnabled(){return!this.disabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}toggleEnabled(s){return null!=s?s!==this.isEnabled()&&(s?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}undo(s={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,s),this.redoStack.push(t),this.notify("undo",t,s))}return this}redo(s={}){if(!this.disabled){const t=this.redoStack.pop();t&&(this.applyCommand(t,s),this.undoStackPush(t),this.notify("redo",t,s))}return this}cancel(s={}){if(!this.disabled){const t=this.undoStack.pop();t&&(this.revertCommand(t,s),this.redoStack=[],this.notify("cancel",t,s))}return this}getSize(){return this.stackSize}getUndoRemainSize(){return this.stackSize-this.undoStack.length}getUndoSize(){return this.undoStack.length}getRedoSize(){return this.redoStack.length}canUndo(){return!this.disabled&&this.undoStack.length>0}canRedo(){return!this.disabled&&this.redoStack.length>0}clean(s={}){return this.undoStack=[],this.redoStack=[],this.notify("clean",null,s),this}get disabled(){return!0!==this.options.enabled}validate(s,...t){return this.validator.validate(s,...t),this}startListening(){this.model.on("batch:start",this.initBatchCommand,this),this.model.on("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&this.options.eventNames.forEach((s,t)=>{this.handlers[t]=this.addCommand.bind(this,s),this.model.on(s,this.handlers[t])}),this.validator.on("invalid",s=>this.trigger("invalid",s))}stopListening(){this.model.off("batch:start",this.initBatchCommand,this),this.model.off("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&(this.options.eventNames.forEach((s,t)=>{this.model.off(s,this.handlers[t])}),this.handlers.length=0),this.validator.off("invalid")}createCommand(s){return{batch:!!s&&s.batch,data:{}}}revertCommand(s,t){this.freezed=!0;const n=Array.isArray(s)?Y.sortBatchCommands(s):[s];for(let o=n.length-1;o>=0;o-=1){const r=n[o],a=Object.assign(Object.assign({},t),c.D5.pick(r.options,this.options.revertOptionsList||[]));this.executeCommand(r,!0,a)}this.freezed=!1}applyCommand(s,t){this.freezed=!0;const n=Array.isArray(s)?Y.sortBatchCommands(s):[s];for(let o=0;o<n.length;o+=1){const r=n[o],a=Object.assign(Object.assign({},t),c.D5.pick(r.options,this.options.applyOptionsList||[]));this.executeCommand(r,!1,a)}this.freezed=!1}executeCommand(s,t,n){const o=this.model,r=o.getCell(s.data.id),a=s.event;if(Y.isAddEvent(a)&&t||Y.isRemoveEvent(a)&&!t)r&&r.remove(n);else if(Y.isAddEvent(a)&&!t||Y.isRemoveEvent(a)&&t){const l=s.data;l.node?o.addNode(l.props,n):l.edge&&o.addEdge(l.props,n)}else if(Y.isChangeEvent(a)){const l=s.data,d=l.key;if(d&&r){const p=t?l.prev[d]:l.next[d];"attrs"===l.key&&this.ensureUndefinedAttrs(p,t?l.next[d]:l.prev[d])&&(n.dirty=!0),r.prop(d,p,n)}}else{const l=this.options.executeCommand;l&&c.eY.call(l,this,s,t,n)}}addCommand(s,t){if(this.freezed||this.disabled)return;const n=t,o=n.options||{};if(o.dryrun||Y.isAddEvent(s)&&this.options.ignoreAdd||Y.isRemoveEvent(s)&&this.options.ignoreRemove||Y.isChangeEvent(s)&&this.options.ignoreChange)return;const r=this.options.beforeAddCommand;if(null!=r&&!1===c.eY.call(r,this,s,t))return;"cell:change:*"===s&&(s=`cell:change:${n.key}`);const a=n.cell,l=c.Kx.isModel(a);let d;if(this.batchCommands){if(d=this.batchCommands[Math.max(this.lastBatchIndex,0)],this.lastBatchIndex>=0&&(l&&!d.modelChange||d.data.id!==a.id||d.event!==s)){const f=this.batchCommands.findIndex(v=>(l&&v.modelChange||v.data.id===a.id)&&v.event===s);f<0||Y.isAddEvent(s)||Y.isRemoveEvent(s)?d=this.createCommand({batch:!0}):(d=this.batchCommands[f],this.batchCommands.splice(f,1)),this.batchCommands.push(d),this.lastBatchIndex=this.batchCommands.length-1}}else d=this.createCommand({batch:!1});if(Y.isAddEvent(s)||Y.isRemoveEvent(s)){const h=d.data;return d.event=s,d.options=o,h.id=a.id,h.props=c.D5.cloneDeep(a.toJSON()),a.isEdge()?h.edge=!0:a.isNode()&&(h.node=!0),this.push(d,o)}if(Y.isChangeEvent(s)){const h=t.key,u=d.data;return(!d.batch||!d.event)&&(d.event=s,d.options=o,u.key=h,null==u.prev&&(u.prev={}),u.prev[h]=c.D5.cloneDeep(a.previous(h)),l?d.modelChange=!0:u.id=a.id),null==u.next&&(u.next={}),u.next[h]=c.D5.cloneDeep(a.prop(h)),this.push(d,o)}const p=this.options.afterAddCommand;p&&c.eY.call(p,this,s,t,d),this.push(d,o)}initBatchCommand(s){this.freezed||(this.batchCommands?this.batchLevel+=1:(this.batchCommands=[this.createCommand({batch:!0})],this.batchLevel=0,this.lastBatchIndex=-1))}storeBatchCommand(s){if(!this.freezed)if(this.batchCommands&&this.batchLevel<=0){const t=this.filterBatchCommand(this.batchCommands);t.length>0&&(this.redoStack=[],this.undoStackPush(t),this.consolidateCommands(),this.notify("add",t,s)),this.batchCommands=null,this.lastBatchIndex=-1,this.batchLevel=0}else this.batchCommands&&this.batchLevel>0&&(this.batchLevel-=1)}filterBatchCommand(s){let t=s.slice();const n=[];for(;t.length>0;){const o=t.shift(),r=o.event,a=o.data.id;if(null!=r&&(null!=a||o.modelChange)){if(Y.isAddEvent(r)){const l=t.findIndex(d=>Y.isRemoveEvent(d.event)&&d.data.id===a);if(l>=0){t=t.filter((d,p)=>l<p||d.data.id!==a);continue}}else if(Y.isRemoveEvent(r)){const l=t.findIndex(d=>Y.isAddEvent(d.event)&&d.data.id===a);if(l>=0){t.splice(l,1);continue}}else if(Y.isChangeEvent(r)){const l=o.data;if(c.D5.isEqual(l.prev,l.next))continue}n.push(o)}}return n}notify(s,t,n){const o=null==t?null:Array.isArray(t)?t:[t];this.emit(s,{cmds:o,options:n}),this.graph.trigger(`history:${s}`,{cmds:o,options:n}),this.emit("change",{cmds:o,options:n}),this.graph.trigger("history:change",{cmds:o,options:n})}push(s,t){this.redoStack=[],s.batch?(this.lastBatchIndex=Math.max(this.lastBatchIndex,0),this.emit("batch",{cmd:s,options:t})):(this.undoStackPush(s),this.consolidateCommands(),this.notify("add",s,t))}consolidateCommands(){var s;const t=this.undoStack[this.undoStack.length-1],n=this.undoStack[this.undoStack.length-2];if(!Array.isArray(t))return;const o=new Set(t.map(a=>a.event));if(!(2===o.size&&o.has("cell:change:parent")&&o.has("cell:change:children")&&t.every(a=>{var l;return a.batch&&(null===(l=a.options)||void 0===l?void 0:l.ui)})&&Array.isArray(n)&&1===n.length))return;const r=n[0];"cell:change:position"!==r.event||null===(s=r.options)||void 0===s||!s.ui||(n.push(...t),this.undoStack.pop())}undoStackPush(s){0!==this.stackSize?(this.undoStack.length>=this.stackSize&&this.undoStack.shift(),this.undoStack.push(s)):this.undoStack.push(s)}ensureUndefinedAttrs(s,t){let n=!1;return null!==s&&null!==t&&"object"==typeof s&&"object"==typeof t&&Object.keys(t).forEach(o=>{void 0===s[o]&&void 0!==t[o]?(s[o]=void 0,n=!0):"object"==typeof s[o]&&"object"==typeof t[o]&&(n=this.ensureUndefinedAttrs(s[o],t[o]))}),n}dispose(){this.validator.dispose(),this.clean(),this.stopListening(),this.off()}}Ge([c.Nb.dispose()],Nt.prototype,"dispose",null),function(i){class s extends c.Nb{constructor(n){super(),this.map={},this.command=n.history,this.cancelInvalid=!1!==n.cancelInvalid,this.command.on("add",this.onCommandAdded,this)}onCommandAdded({cmds:n}){return Array.isArray(n)?n.every(o=>this.isValidCommand(o)):this.isValidCommand(n)}isValidCommand(n){if(n.options&&!1===n.options.validation)return!0;let r=null;return(n.event&&this.map[n.event]||[]).forEach(a=>{let l=0;const d=p=>{const h=a[l];l+=1;try{if(!h)return void(r=p);h(p,n,d)}catch(u){d(u)}};d(r)}),!r||(this.cancelInvalid&&this.command.cancel(),this.emit("invalid",{err:r}),!1)}validate(n,...o){const r=Array.isArray(n)?n:n.split(/\s+/);return o.forEach(a=>{if("function"!=typeof a)throw new Error(`${r.join(" ")} requires callback functions.`)}),r.forEach(a=>{null==this.map[a]&&(this.map[a]=[]),this.map[a].push(o)}),this}dispose(){this.command.off("add",this.onCommandAdded,this)}}Ge([c.Nb.dispose()],s.prototype,"dispose",null),i.Validator=s}(Nt||(Nt={})),function(i){i.isAddEvent=function s(a){return"cell:added"===a},i.isRemoveEvent=function t(a){return"cell:removed"===a},i.isChangeEvent=function n(a){return null!=a&&a.startsWith("cell:change:")},i.getOptions=function o(a){const l=["cell:added","cell:removed","cell:change:*"],d=["batch:start","batch:stop"],p=a.eventNames?a.eventNames.filter(h=>!(i.isChangeEvent(h)||l.includes(h)||d.includes(h))):l;return Object.assign(Object.assign({enabled:!0},a),{eventNames:p,applyOptionsList:a.applyOptionsList||["propertyPath"],revertOptionsList:a.revertOptionsList||["propertyPath"]})},i.sortBatchCommands=function r(a){const l=[];for(let d=0,p=a.length;d<p;d+=1){const h=a[d];let u=null;if(i.isAddEvent(h.event)){const f=h.data.id;for(let v=0;v<d;v+=1)if(a[v].data.id===f){u=v;break}}null!==u?l.splice(u,0,h):l.push(h)}return l}}(Y||(Y={}));class je extends c.Ss{get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(nt.classNames.box)}get $boxes(){return c.Jf.children(this.container,this.boxClassName)}get handleOptions(){return this.options}constructor(s){super(),this.options=s,this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new c.pM([],{comparator:nt.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.startListening()}startListening(){const s=this.graph,t=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),s.on("scale",this.onGraphTransformed,this),s.on("translate",this.onGraphTransformed,this),s.model.on("updated",this.onModelUpdated,this),t.on("added",this.onCellAdded,this),t.on("removed",this.onCellRemoved,this),t.on("reseted",this.onReseted,this),t.on("updated",this.onCollectionUpdated,this),t.on("node:change:position",this.onNodePositionChanged,this),t.on("cell:changed",this.onCellChanged,this)}stopListening(){const s=this.graph,t=this.collection;this.undelegateEvents(),s.off("scale",this.onGraphTransformed,this),s.off("translate",this.onGraphTransformed,this),s.model.off("updated",this.onModelUpdated,this),t.off("added",this.onCellAdded,this),t.off("removed",this.onCellRemoved,this),t.off("reseted",this.onReseted,this),t.off("updated",this.onCollectionUpdated,this),t.off("node:change:position",this.onNodePositionChanged,this),t.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes()}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:s,options:t}){const{showNodeSelectionBox:n,pointerEvents:o}=this.options,{ui:r,selection:a,translateBy:l,snapped:d}=t;if((!0!==n||o&&"none"===this.getPointerEventsValue(o))&&!this.translating&&!a&&(r&&l&&s.id===l||d)){this.translating=!0;const u=s.position(),f=s.previous("position"),v=u.x-f.x,w=u.y-f.y;(0!==v||0!==w)&&this.translateSelectedNodes(v,w,s,t),this.translating=!1}}onModelUpdated({removed:s}){s&&s.length&&this.unselect(s)}isEmpty(){return this.length<=0}isSelected(s){return this.collection.has(s)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(s,t={}){t.dryrun=!0;const n=this.filter(Array.isArray(s)?s:[s]);return this.collection.add(n,t),this}unselect(s,t={}){return t.dryrun=!0,this.collection.remove(Array.isArray(s)?s:[s],t),this}reset(s,t={}){if(s){if(t.batch){const p=this.filter(Array.isArray(s)?s:[s]);return this.collection.reset(p,Object.assign(Object.assign({},t),{ui:!0})),this}const n=this.cells,o=this.filter(Array.isArray(s)?s:[s]),r={},a={};n.forEach(p=>r[p.id]=p),o.forEach(p=>a[p.id]=p);const l=[],d=[];return o.forEach(p=>{r[p.id]||l.push(p)}),n.forEach(p=>{a[p.id]||d.push(p)}),d.length&&this.unselect(d,Object.assign(Object.assign({},t),{ui:!0})),l.length&&this.select(l,Object.assign(Object.assign({},t),{ui:!0})),0===d.length&&0===l.length&&this.updateContainer(),this}return this.clean(t)}clean(s={}){return this.length&&(!1===s.batch?this.unselect(this.cells,s):this.collection.reset([],Object.assign(Object.assign({},s),{ui:!0}))),this}setFilter(s){this.options.filter=s}setContent(s){this.options.content=s}startSelecting(s){let t,n;s=this.normalizeEvent(s),this.clean();const o=this.graph.container;if(null!=s.offsetX&&null!=s.offsetY&&o.contains(s.target))t=s.offsetX,n=s.offsetY;else{const r=c.Jf.offset(o);t=s.clientX-r.left+window.pageXOffset+o.scrollLeft,n=s.clientY-r.top+window.pageYOffset+o.scrollTop}c.Jf.css(this.container,{top:n,left:t,width:1,height:1}),this.setEventData(s,{action:"selecting",clientX:s.clientX,clientY:s.clientY,offsetX:t,offsetY:n,scrollerX:0,scrollerY:0,moving:!1}),this.delegateDocumentEvents(nt.documentEvents,s.data)}filter(s){const t=this.options.filter;return s.filter(n=>Array.isArray(t)?t.some(o=>"string"==typeof o?n.shape===o:n.id===o.id):"function"!=typeof t||c.eY.call(t,this.graph,n))}stopSelecting(s){const t=this.graph,n=this.getEventData(s);switch(n.action){case"selecting":{let r=c.Jf.width(this.container),a=c.Jf.height(this.container);const l=c.Jf.offset(this.container),d=t.pageToLocal(l.left,l.top),p=t.transform.getScale();r/=p.sx,a/=p.sy;const h=new c.M_(d.x,d.y,r,a),u=this.getCellViewsInArea(h).map(f=>f.cell);this.reset(u,{batch:!0}),this.hideRubberband();break}case"translating":{const r=t.snapToGrid(s.clientX,s.clientY);this.options.following||this.updateSelectedNodesPosition({dx:n.clientX-n.originX,dy:n.clientY-n.originY}),this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",s,r.x,r.y);break}default:this.clean()}}onMouseUp(s){this.getEventData(s).action&&(this.stopSelecting(s),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(s){this.options.following||s.stopPropagation();const t=this.normalizeEvent(s);this.options.movable&&this.startTranslating(t);const n=this.getCellViewFromElem(t.target);this.setEventData(t,{activeView:n});const o=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,o.x,o.y),this.delegateDocumentEvents(nt.documentEvents,t.data)}startTranslating(s){this.graph.model.startBatch("move-selection");const t=this.graph.snapToGrid(s.clientX,s.clientY);this.setEventData(s,{action:"translating",clientX:t.x,clientY:t.y,originX:t.x,originY:t.y})}getRestrictArea(){const s=this.graph.options.translating.restrict,t="function"==typeof s?c.eY.call(s,this.graph,null):s;return"number"==typeof t?this.graph.transform.getGraphArea().inflate(t):!0===t?this.graph.transform.getGraphArea():t||null}getSelectionOffset(s,t){let n=s.x-t.clientX,o=s.y-t.clientY;const r=this.getRestrictArea();if(r){const a=this.collection.toArray(),l=c.fh.getCellsBBox(a,{deep:!0})||c.M_.create(),d=r.x-l.x,p=r.y-l.y,h=r.x+r.width-(l.x+l.width),u=r.y+r.height-(l.y+l.height);if(n<d&&(n=d),o<p&&(o=p),h<n&&(n=h),u<o&&(o=u),!this.options.following){const f=s.x-t.originX,v=s.y-t.originY;n=f<=d||f>=h?0:n,o=v<=p||v>=u?0:o}}return{dx:n,dy:o}}updateElementPosition(s,t,n){const o=c.Jf.css(s,"left"),r=c.Jf.css(s,"top"),a=o?parseFloat(o):0,l=r?parseFloat(r):0;c.Jf.css(s,"left",a+t),c.Jf.css(s,"top",l+n)}updateSelectedNodesPosition(s){const{dx:t,dy:n}=s;if(t||n)if(this.translateSelectedNodes(t,n),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const o=this.graph.transform.getScale();for(let r=0,a=this.$boxes,l=a.length;r<l;r+=1)this.updateElementPosition(a[r],t*o.sx,n*o.sy);this.updateElementPosition(this.selectionContainer,t*o.sx,n*o.sy)}}autoScrollGraph(s,t){const n=this.graph.getPlugin("scroller");return n?n.autoScroll(s,t):{scrollerX:0,scrollerY:0}}adjustSelection(s){const t=this.normalizeEvent(s),n=this.getEventData(t);switch(n.action){case"selecting":{const r=n;!0!==r.moving&&(c.Jf.appendTo(this.container,this.graph.container),this.showRubberband(),r.moving=!0);const{scrollerX:a,scrollerY:l}=this.autoScrollGraph(t.clientX,t.clientY);r.scrollerX+=a,r.scrollerY+=l;const d=t.clientX-r.clientX+r.scrollerX,p=t.clientY-r.clientY+r.scrollerY,h=parseInt(c.Jf.css(this.container,"left")||"0",10),u=parseInt(c.Jf.css(this.container,"top")||"0",10);c.Jf.css(this.container,{left:d<0?r.offsetX+d:h,top:p<0?r.offsetY+p:u,width:Math.abs(d),height:Math.abs(p)});break}case"translating":{const r=this.graph.snapToGrid(t.clientX,t.clientY),a=n,l=this.getSelectionOffset(r,a);this.options.following?this.updateSelectedNodesPosition(l):this.updateContainerPosition(l),l.dx&&(a.clientX=r.x),l.dy&&(a.clientY=r.y),this.notifyBoxEvent("box:mousemove",s,r.x,r.y);break}}this.boxesUpdated=!1}translateSelectedNodes(s,t,n,o){const r={},a=[];if(n&&(r[n.id]=!0),this.collection.toArray().forEach(l=>{l.getDescendants({deep:!0}).forEach(d=>{r[d.id]=!0})}),o&&o.translateBy){const l=this.graph.getCellById(o.translateBy);l&&(r[l.id]=!0,l.getDescendants({deep:!0}).forEach(d=>{r[d.id]=!0}),a.push(l))}this.collection.toArray().forEach(l=>{if(!r[l.id]){const d=Object.assign(Object.assign({},o),{selection:this.cid,exclude:a});l.translate(s,t,d),this.graph.model.getConnectedEdges(l).forEach(p=>{r[p.id]||(p.translate(s,t,d),r[p.id]=!0)})}})}getCellViewsInArea(s){const t=this.graph,n={strict:this.options.strict};let o=[];return this.options.rubberNode&&(o=o.concat(t.model.getNodesInArea(s,n).map(r=>t.renderer.findViewByCell(r)).filter(r=>null!=r))),this.options.rubberEdge&&(o=o.concat(t.model.getEdgesInArea(s,n).map(r=>t.renderer.findViewByCell(r)).filter(r=>null!=r))),o}notifyBoxEvent(s,t,n,o){const a=this.getEventData(t).activeView;this.trigger(s,{e:t,view:a,x:n,y:o,cell:a.cell})}getSelectedClassName(s){return this.prefixClassName((s.isNode()?"node":"edge")+"-selected")}addCellSelectedClassName(s){const t=this.graph.renderer.findViewByCell(s);t&&t.addClass(this.getSelectedClassName(s))}removeCellUnSelectedClassName(s){const t=this.graph.renderer.findViewByCell(s);t&&t.removeClass(this.getSelectedClassName(s))}destroySelectionBox(s){this.removeCellUnSelectedClassName(s),this.canShowSelectionBox(s)&&(c.Jf.remove(this.container.querySelector(`[data-cell-id="${s.id}"]`)),0===this.$boxes.length&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(s){s.forEach(t=>this.removeCellUnSelectedClassName(t)),this.hide(),c.Jf.remove(this.$boxes),this.boxCount=0}hide(){c.Jf.removeClass(this.container,this.prefixClassName(nt.classNames.rubberband)),c.Jf.removeClass(this.container,this.prefixClassName(nt.classNames.selected))}showRubberband(){c.Jf.addClass(this.container,this.prefixClassName(nt.classNames.rubberband))}hideRubberband(){c.Jf.removeClass(this.container,this.prefixClassName(nt.classNames.rubberband))}showSelected(){c.Jf.removeAttribute(this.container,"style"),c.Jf.addClass(this.container,this.prefixClassName(nt.classNames.selected))}createContainer(){this.container=document.createElement("div"),c.Jf.addClass(this.container,this.prefixClassName(nt.classNames.root)),this.options.className&&c.Jf.addClass(this.container,this.options.className),this.selectionContainer=document.createElement("div"),c.Jf.addClass(this.selectionContainer,this.prefixClassName(nt.classNames.inner)),this.selectionContent=document.createElement("div"),c.Jf.addClass(this.selectionContent,this.prefixClassName(nt.classNames.content)),c.Jf.append(this.selectionContainer,this.selectionContent),c.Jf.attr(this.selectionContainer,"data-selection-length",this.collection.length),c.Jf.prepend(this.container,this.selectionContainer)}updateContainerPosition(s){(s.dx||s.dy)&&this.updateElementPosition(this.selectionContainer,s.dx,s.dy)}updateContainer(){const s={x:1/0,y:1/0},t={x:0,y:0};this.collection.toArray().filter(r=>this.canShowSelectionBox(r)).forEach(r=>{const a=this.graph.renderer.findViewByCell(r);if(a){const l=a.getBBox({useCellGeometry:!0});s.x=Math.min(s.x,l.x),s.y=Math.min(s.y,l.y),t.x=Math.max(t.x,l.x+l.width),t.y=Math.max(t.y,l.y+l.height)}}),c.Jf.css(this.selectionContainer,{position:"absolute",pointerEvents:"none",left:s.x,top:s.y,width:t.x-s.x,height:t.y-s.y}),c.Jf.attr(this.selectionContainer,"data-selection-length",this.collection.length);const o=this.options.content;if(o)if("function"==typeof o){const r=c.eY.call(o,this.graph,this,this.selectionContent);r&&(this.selectionContent.innerHTML=r)}else this.selectionContent.innerHTML=o;this.collection.length>0&&!this.container.parentNode?c.Jf.appendTo(this.container,this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(s){return s.isNode()&&!0===this.options.showNodeSelectionBox||s.isEdge()&&!0===this.options.showEdgeSelectionBox}getPointerEventsValue(s){return"string"==typeof s?s:s(this.cells)}createSelectionBox(s){if(this.addCellSelectedClassName(s),this.canShowSelectionBox(s)){const t=this.graph.renderer.findViewByCell(s);if(t){const n=t.getBBox({useCellGeometry:!0}),o=this.boxClassName,r=document.createElement("div"),a=this.options.pointerEvents;c.Jf.addClass(r,o),c.Jf.addClass(r,`${o}-${s.isNode()?"node":"edge"}`),c.Jf.attr(r,"data-cell-id",s.id),c.Jf.css(r,{position:"absolute",left:n.x,top:n.y,width:n.width,height:n.height,pointerEvents:a?this.getPointerEventsValue(a):"auto"}),c.Jf.appendTo(r,this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(){this.collection.length>0&&(this.boxesUpdated=!0,this.confirmUpdate())}confirmUpdate(){if(this.boxCount){this.hide();for(let s=0,t=this.$boxes,n=t.length;s<n;s+=1){const o=t[s],r=c.Jf.attr(o,"data-cell-id");c.Jf.remove(o),this.boxCount-=1;const a=this.collection.get(r);a&&this.createSelectionBox(a)}this.updateContainer()}return 0}getCellViewFromElem(s){const t=s.getAttribute("data-cell-id");if(t){const n=this.collection.get(t);if(n)return this.graph.renderer.findViewByCell(n)}return null}onCellRemoved({cell:s}){this.destroySelectionBox(s),this.updateContainer()}onReseted({previous:s,current:t}){this.destroyAllSelectionBoxes(s),t.forEach(n=>{this.listenCellRemoveEvent(n),this.createSelectionBox(n)}),this.updateContainer()}onCellAdded({cell:s}){this.listenCellRemoveEvent(s),this.createSelectionBox(s),this.updateContainer()}listenCellRemoveEvent(s){s.off("removed",this.onCellRemoved,this),s.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:s,removed:t,options:n}){s.forEach(r=>{this.trigger("cell:selected",{cell:r,options:n}),r.isNode()?this.trigger("node:selected",{cell:r,options:n,node:r}):r.isEdge()&&this.trigger("edge:selected",{cell:r,options:n,edge:r})}),t.forEach(r=>{this.trigger("cell:unselected",{cell:r,options:n}),r.isNode()?this.trigger("node:unselected",{cell:r,options:n,node:r}):r.isEdge()&&this.trigger("edge:unselected",{cell:r,options:n,edge:r})});const o={added:s,removed:t,options:n,selected:this.cells.filter(r=>!!this.graph.getCellById(r.id))};this.trigger("selection:changed",o)}dispose(){this.clean(),this.remove(),this.off()}}!function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)}([c.Ss.dispose()],je.prototype,"dispose",null),function(i){const s="widget-selection";i.classNames={root:s,inner:`${s}-inner`,box:`${s}-box`,content:`${s}-content`,rubberband:`${s}-rubberband`,selected:`${s}-selected`},i.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},i.depthComparator=function t(n){return n.getAncestors().length}}(nt||(nt={})),c.ke.prototype.isSelectionEnabled=function(){const i=this.getPlugin("selection");return!!i&&i.isEnabled()},c.ke.prototype.enableSelection=function(){const i=this.getPlugin("selection");return i&&i.enable(),this},c.ke.prototype.disableSelection=function(){const i=this.getPlugin("selection");return i&&i.disable(),this},c.ke.prototype.toggleSelection=function(i){const s=this.getPlugin("selection");return s&&s.toggleEnabled(i),this},c.ke.prototype.isMultipleSelection=function(){const i=this.getPlugin("selection");return!!i&&i.isMultipleSelection()},c.ke.prototype.enableMultipleSelection=function(){const i=this.getPlugin("selection");return i&&i.enableMultipleSelection(),this},c.ke.prototype.disableMultipleSelection=function(){const i=this.getPlugin("selection");return i&&i.disableMultipleSelection(),this},c.ke.prototype.toggleMultipleSelection=function(i){const s=this.getPlugin("selection");return s&&s.toggleMultipleSelection(i),this},c.ke.prototype.isSelectionMovable=function(){const i=this.getPlugin("selection");return!!i&&i.isSelectionMovable()},c.ke.prototype.enableSelectionMovable=function(){const i=this.getPlugin("selection");return i&&i.enableSelectionMovable(),this},c.ke.prototype.disableSelectionMovable=function(){const i=this.getPlugin("selection");return i&&i.disableSelectionMovable(),this},c.ke.prototype.toggleSelectionMovable=function(i){const s=this.getPlugin("selection");return s&&s.toggleSelectionMovable(i),this},c.ke.prototype.isRubberbandEnabled=function(){const i=this.getPlugin("selection");return!!i&&i.isRubberbandEnabled()},c.ke.prototype.enableRubberband=function(){const i=this.getPlugin("selection");return i&&i.enableRubberband(),this},c.ke.prototype.disableRubberband=function(){const i=this.getPlugin("selection");return i&&i.disableRubberband(),this},c.ke.prototype.toggleRubberband=function(i){const s=this.getPlugin("selection");return s&&s.toggleRubberband(i),this},c.ke.prototype.isStrictRubberband=function(){const i=this.getPlugin("selection");return!!i&&i.isStrictRubberband()},c.ke.prototype.enableStrictRubberband=function(){const i=this.getPlugin("selection");return i&&i.enableStrictRubberband(),this},c.ke.prototype.disableStrictRubberband=function(){const i=this.getPlugin("selection");return i&&i.disableStrictRubberband(),this},c.ke.prototype.toggleStrictRubberband=function(i){const s=this.getPlugin("selection");return s&&s.toggleStrictRubberband(i),this},c.ke.prototype.setRubberbandModifiers=function(i){const s=this.getPlugin("selection");return s&&s.setRubberbandModifiers(i),this},c.ke.prototype.setSelectionFilter=function(i){const s=this.getPlugin("selection");return s&&s.setSelectionFilter(i),this},c.ke.prototype.setSelectionDisplayContent=function(i){const s=this.getPlugin("selection");return s&&s.setSelectionDisplayContent(i),this},c.ke.prototype.isSelectionEmpty=function(){const i=this.getPlugin("selection");return!i||i.isEmpty()},c.ke.prototype.cleanSelection=function(i){const s=this.getPlugin("selection");return s&&s.clean(i),this},c.ke.prototype.resetSelection=function(i,s){const t=this.getPlugin("selection");return t&&t.reset(i,s),this},c.ke.prototype.getSelectedCells=function(){const i=this.getPlugin("selection");return i?i.getSelectedCells():[]},c.ke.prototype.getSelectedCellCount=function(){const i=this.getPlugin("selection");return i?i.getSelectedCellCount():0},c.ke.prototype.isSelected=function(i){const s=this.getPlugin("selection");return!!s&&s.isSelected(i)},c.ke.prototype.select=function(i,s){const t=this.getPlugin("selection");return t&&t.select(i,s),this},c.ke.prototype.unselect=function(i,s){const t=this.getPlugin("selection");return t&&t.unselect(i,s),this};class Dt extends c.Nb{get rubberbandDisabled(){return!0!==this.options.enabled||!0!==this.options.rubberband}get disabled(){return!0!==this.options.enabled}get length(){return this.selectionImpl.length}get cells(){return this.selectionImpl.cells}constructor(s={}){super(),this.name="selection",this.movedMap=new WeakMap,this.unselectMap=new WeakMap,this.options=Object.assign(Object.assign({enabled:!0},Dt.defaultOptions),s),c.H.ensure(this.name,".x6-widget-selection {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: none;\n  width: 0;\n  height: 0;\n  touch-action: none;\n}\n.x6-widget-selection-rubberband {\n  display: block;\n  overflow: visible;\n  opacity: 0.3;\n}\n.x6-widget-selection-selected {\n  display: block;\n}\n.x6-widget-selection-box {\n  cursor: move;\n}\n.x6-widget-selection-inner[data-selection-length='0'],\n.x6-widget-selection-inner[data-selection-length='1'] {\n  display: none;\n}\n.x6-widget-selection-content {\n  position: absolute;\n  top: 100%;\n  right: -20px;\n  left: -20px;\n  margin-top: 30px;\n  padding: 6px;\n  line-height: 14px;\n  text-align: center;\n  border-radius: 6px;\n}\n.x6-widget-selection-content:empty {\n  display: none;\n}\n.x6-widget-selection-rubberband {\n  background-color: #3498db;\n  border: 2px solid #2980b9;\n}\n.x6-widget-selection-box {\n  box-sizing: content-box !important;\n  margin-top: -4px;\n  margin-left: -4px;\n  padding-right: 4px;\n  padding-bottom: 4px;\n  border: 2px dashed #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-inner {\n  box-sizing: content-box !important;\n  margin-top: -8px;\n  margin-left: -8px;\n  padding-right: 12px;\n  padding-bottom: 12px;\n  border: 2px solid #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-content {\n  color: #fff;\n  font-size: 10px;\n  background-color: #6a6b8a;\n}\n")}init(s){this.graph=s,this.selectionImpl=new je(Object.assign(Object.assign({},this.options),{graph:s})),this.setup(),this.startListening()}isEnabled(){return!this.disabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}toggleEnabled(s){return null!=s?s!==this.isEnabled()&&(s?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}isMultipleSelection(){return this.isMultiple()}enableMultipleSelection(){return this.enableMultiple(),this}disableMultipleSelection(){return this.disableMultiple(),this}toggleMultipleSelection(s){return null!=s?s!==this.isMultipleSelection()&&(s?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return!1!==this.options.movable}enableSelectionMovable(){return this.selectionImpl.options.movable=!0,this}disableSelectionMovable(){return this.selectionImpl.options.movable=!1,this}toggleSelectionMovable(s){return null!=s?s!==this.isSelectionMovable()&&(s?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.rubberbandDisabled}enableRubberband(){return this.rubberbandDisabled&&(this.options.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.options.rubberband=!1),this}toggleRubberband(s){return null!=s?s!==this.isRubberbandEnabled()&&(s?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return!0===this.selectionImpl.options.strict}enableStrictRubberband(){return this.selectionImpl.options.strict=!0,this}disableStrictRubberband(){return this.selectionImpl.options.strict=!1,this}toggleStrictRubberband(s){return null!=s?s!==this.isStrictRubberband()&&(s?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(s){this.setModifiers(s)}setSelectionFilter(s){return this.setFilter(s),this}setSelectionDisplayContent(s){return this.setContent(s),this}isEmpty(){return this.length<=0}clean(s={}){return this.selectionImpl.clean(s),this}reset(s,t={}){return this.selectionImpl.reset(s?this.getCells(s):[],t),this}getSelectedCells(){return this.cells}getSelectedCellCount(){return this.length}isSelected(s){return this.selectionImpl.isSelected(s)}select(s,t={}){const n=this.getCells(s);return n.length&&(this.isMultiple()?this.selectionImpl.select(n,t):this.reset(n.slice(0,1),t)),this}unselect(s,t={}){return this.selectionImpl.unselect(this.getCells(s),t),this}setup(){this.selectionImpl.on("*",(s,t)=>{this.trigger(s,t),this.graph.trigger(s,t)})}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e:s}){if(!this.allowBlankMouseDown(s))return;const t=this.graph.panning.allowPanning(s,!0),n=this.graph.getPlugin("scroller"),o=n&&n.allowPanning(s,!0);(this.allowRubberband(s,!0)||this.allowRubberband(s)&&!o&&!t)&&this.startRubberband(s)}allowBlankMouseDown(s){const t=this.options.eventTypes;return t?.includes("leftMouseDown")&&0===s.button||t?.includes("mouseWheelDown")&&1===s.button}onBlankClick(){this.clean()}allowRubberband(s,t){return!this.rubberbandDisabled&&c.xH.isMatch(s,this.options.modifiers,t)}allowMultipleSelection(s){return this.isMultiple()&&c.xH.isMatch(s,this.options.multipleSelectionModifiers)}onCellMouseMove({cell:s}){this.movedMap.set(s,!0)}onCellMouseUp({e:s,cell:t}){const n=this.options;let o=this.disabled;!o&&this.movedMap.has(t)&&(o=!1===n.selectCellOnMoved,o||(o=!1===n.selectNodeOnMoved&&t.isNode()),o||(o=!1===n.selectEdgeOnMoved&&t.isEdge())),o||(this.allowMultipleSelection(s)?this.unselectMap.has(t)?this.unselectMap.delete(t):this.isSelected(t)?this.unselect(t):this.select(t):this.reset(t)),this.movedMap.delete(t)}onBoxMouseDown({e:s,cell:t}){this.disabled||this.allowMultipleSelection(s)&&(this.unselect(t),this.unselectMap.set(t,!0))}getCells(s){return(Array.isArray(s)?s:[s]).map(t=>"string"==typeof t?this.graph.getCellById(t):t).filter(t=>null!=t)}startRubberband(s){return this.rubberbandDisabled||this.selectionImpl.startSelecting(s),this}isMultiple(){return!1!==this.options.multiple}enableMultiple(){return this.options.multiple=!0,this}disableMultiple(){return this.options.multiple=!1,this}setModifiers(s){return this.options.modifiers=s,this}setContent(s){return this.selectionImpl.setContent(s),this}setFilter(s){return this.selectionImpl.setFilter(s),this}dispose(){this.stopListening(),this.off(),this.selectionImpl.dispose(),c.H.clean(this.name)}}(function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)})([c.Nb.dispose()],Dt.prototype,"dispose",null),function(i){i.defaultOptions={rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,following:!0,content:null,eventTypes:["leftMouseDown","mouseWheelDown"]}}(Dt||(Dt={})),c.ke.prototype.toSVG=function(i,s){const t=this.getPlugin("export");t&&t.toSVG(i,s)},c.ke.prototype.toPNG=function(i,s){const t=this.getPlugin("export");t&&t.toPNG(i,s)},c.ke.prototype.toJPEG=function(i,s){const t=this.getPlugin("export");t&&t.toJPEG(i,s)},c.ke.prototype.exportPNG=function(i,s){const t=this.getPlugin("export");t&&t.exportPNG(i,s)},c.ke.prototype.exportJPEG=function(i,s){const t=this.getPlugin("export");t&&t.exportJPEG(i,s)},c.ke.prototype.exportSVG=function(i,s){const t=this.getPlugin("export");t&&t.exportSVG(i,s)};class Le extends c.Nb{constructor(){super(),this.name="export"}get view(){return this.graph.view}init(s){this.graph=s}exportPNG(s="chart",t={}){this.toPNG(n=>{c.B6.downloadDataUri(n,s)},t)}exportJPEG(s="chart",t={}){this.toPNG(n=>{c.B6.downloadDataUri(n,s)},t)}exportSVG(s="chart",t={}){this.toSVG(n=>{c.B6.downloadDataUri(c.B6.svgToDataUrl(n),s)},t)}toSVG(s,t={}){this.notify("before:export",t);const n=this.view.svg,o=c.Mi.create(n).clone();let r=o.node;const a=o.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`),l=t.viewBox||this.graph.graphToLocal(this.graph.getContentBBox()),d=t.preserveDimensions;if(d){const u="boolean"==typeof d?l:d;o.attr({width:u.width,height:u.height})}if(o.removeAttribute("style").attr("viewBox",[l.x,l.y,l.width,l.height].join(" ")),a.removeAttribute("transform"),!1!==t.copyStyles){const u=n.ownerDocument,f=Array.from(n.querySelectorAll("*")),v=Array.from(r.querySelectorAll("*")),w=u.styleSheets.length,b=[];for(let z=w-1;z>=0;z-=1)b[z]=u.styleSheets[z],u.styleSheets[z].disabled=!0;const _={};f.forEach((z,A)=>{const x=window.getComputedStyle(z,null),B={};Object.keys(x).forEach(X=>{B[X]=x.getPropertyValue(X)}),_[A]=B}),w!==u.styleSheets.length&&b.forEach((z,A)=>{u.styleSheets[A]=z});for(let z=0;z<w;z+=1)u.styleSheets[z].disabled=!1;const k={};f.forEach((z,A)=>{const x=window.getComputedStyle(z,null),B=_[A],X={};Object.keys(x).forEach($=>{!c.Dc.isNumber($)&&x.getPropertyValue($)!==B[$]&&(X[$]=x.getPropertyValue($))}),k[A]=X}),v.forEach((z,A)=>{c.Jf.css(z,k[A])})}const p=t.stylesheet;if("string"==typeof p){const u=n.ownerDocument.implementation.createDocument(null,"xml",null).createCDATASection(p);o.prepend(c.Mi.create("style",{type:"text/css"},[u]))}const h=()=>{const u=t.beforeSerialize;if("function"==typeof u){const v=c.eY.call(u,this.graph,r);v instanceof SVGSVGElement&&(r=v)}const f=(new XMLSerializer).serializeToString(r).replace(/&nbsp;/g,"\xa0");this.notify("after:export",t),s(f)};if(t.serializeImages){const u=o.find("image").map(f=>new Promise(v=>{const w=f.attr("xlink:href")||f.attr("href");c.B6.imageToDataUri(w,(b,_)=>{!b&&_&&f.attr("xlink:href",_),v()})}));Promise.all(u).then(h)}else h()}toDataURL(s,t){let n=t.viewBox||this.graph.getContentBBox();const o=c.Dc.normalizeSides(t.padding);t.width&&t.height&&(o.left+o.right>=t.width&&(o.left=o.right=0),o.top+o.bottom>=t.height&&(o.top=o.bottom=0));const r=new c.M_(-o.left,-o.top,o.left+o.right,o.top+o.bottom);t.width&&t.height&&r.scale((n.width+o.left+o.right)/t.width,(n.height+o.top+o.bottom)/t.height),n=c.M_.create(n).moveAndExpand(r);const a="number"==typeof t.width&&"number"==typeof t.height?{width:t.width,height:t.height}:n;let l=t.ratio?parseFloat(t.ratio):1;(!Number.isFinite(l)||0===l)&&(l=1);const d={width:Math.max(Math.round(a.width*l),1),height:Math.max(Math.round(a.height*l),1)};{const h=document.createElement("canvas"),u=h.getContext("2d");h.width=d.width,h.height=d.height;const f=d.width-1,v=d.height-1;u.fillStyle="rgb(1,1,1)",u.fillRect(f,v,1,1);const w=u.getImageData(f,v,1,1).data;if(1!==w[0]||1!==w[1]||1!==w[2])throw new Error("size exceeded")}const p=new Image;p.onload=()=>{const h=document.createElement("canvas");h.width=d.width,h.height=d.height;const u=h.getContext("2d");u.fillStyle=t.backgroundColor||"white",u.fillRect(0,0,d.width,d.height);try{u.drawImage(p,0,0,d.width,d.height);const f=h.toDataURL(t.type,t.quality);s(f)}catch{}},this.toSVG(h=>{p.src=`data:image/svg+xml,${encodeURIComponent(h)}`},Object.assign(Object.assign({},t),{viewBox:n,serializeImages:!0,preserveDimensions:Object.assign({},d)}))}toPNG(s,t={}){this.toDataURL(s,Object.assign(Object.assign({},t),{type:"image/png"}))}toJPEG(s,t={}){this.toDataURL(s,Object.assign(Object.assign({},t),{type:"image/jpeg"}))}notify(s,t){this.trigger(s,t),this.graph.trigger(s,t)}dispose(){this.off()}}!function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)}([c.Nb.dispose()],Le.prototype,"dispose",null);class St extends c.Ss{get targetScroller(){return this.options.target.getPlugin("scroller")}get targetGraph(){return this.options.target}get targetModel(){return this.targetGraph.model}get snapline(){return this.options.target.getPlugin("snapline")}constructor(s){super(),this.name="dnd",this.options=Object.assign(Object.assign({},St.defaults),s),this.init()}init(){c.H.ensure(this.name,".x6-widget-dnd {\n  position: absolute;\n  top: -10000px;\n  left: -10000px;\n  z-index: 999999;\n  display: none;\n  cursor: move;\n  opacity: 0.7;\n  pointer-events: 'cursor';\n}\n.x6-widget-dnd.dragging {\n  display: inline-block;\n}\n.x6-widget-dnd.dragging * {\n  pointer-events: none !important;\n}\n.x6-widget-dnd .x6-graph {\n  background: transparent;\n  box-shadow: none;\n}\n"),this.container=document.createElement("div"),c.Jf.addClass(this.container,this.prefixClassName("widget-dnd")),this.draggingGraph=new c.ke(Object.assign(Object.assign({},this.options.delegateGraphOptions),{container:document.createElement("div"),width:1,height:1,async:!1})),c.Jf.append(this.container,this.draggingGraph.container)}start(s,t){const n=t;n.preventDefault(),this.targetModel.startBatch("dnd"),c.Jf.addClass(this.container,"dragging"),c.Jf.appendTo(this.container,this.options.draggingContainer||document.body),this.sourceNode=s,this.prepareDragging(s,n.clientX,n.clientY);const o=this.updateNodePosition(n.clientX,n.clientY);this.isSnaplineEnabled()&&(this.snapline.captureCursorOffset({e:n,node:s,cell:s,view:this.draggingView,x:o.x,y:o.y}),this.draggingNode.on("change:position",this.snap,this)),this.delegateDocumentEvents(St.documentEvents,n.data)}isSnaplineEnabled(){return this.snapline&&this.snapline.isEnabled()}prepareDragging(s,t,n){const o=this.draggingGraph,r=o.model,a=this.options.getDragNode(s,{sourceNode:s,draggingGraph:o,targetGraph:this.targetGraph});a.position(0,0);let l=5;if(this.isSnaplineEnabled()&&(l+=this.snapline.options.tolerance||0),this.isSnaplineEnabled()||this.options.scaled){const h=this.targetGraph.transform.getScale();o.scale(h.sx,h.sy),l*=Math.max(h.sx,h.sy)}else o.scale(1,1);this.clearDragging(),r.resetCells([a]);const d=o.findViewByCell(a);d.undelegateEvents(),d.cell.off("changed"),o.fitToContent({padding:l,allowNewOrigin:"any",useCellGeometry:!1});const p=d.getBBox();this.geometryBBox=d.getBBox({useCellGeometry:!0}),this.delta=this.geometryBBox.getTopLeft().diff(p.getTopLeft()),this.draggingNode=a,this.draggingView=d,this.draggingBBox=a.getBBox(),this.padding=l,this.originOffset=this.updateGraphPosition(t,n)}updateGraphPosition(s,t){const n=document.body.scrollTop||document.documentElement.scrollTop,o=document.body.scrollLeft||document.documentElement.scrollLeft,r=this.delta,a=this.geometryBBox,l=this.padding||5,d={left:s-r.x-a.width/2-l+o,top:t-r.y-a.height/2-l+n};return this.draggingGraph&&c.Jf.css(this.container,{left:`${d.left}px`,top:`${d.top}px`}),d}updateNodePosition(s,t){const n=this.targetGraph.clientToLocal(s,t),o=this.draggingBBox;return n.x-=o.width/2,n.y-=o.height/2,this.draggingNode.position(n.x,n.y),n}snap({cell:s,current:t,options:n}){const o=s;if(n.snapped){const r=this.draggingBBox;o.position(r.x+n.tx,r.y+n.ty,{silent:!0}),this.draggingView.translate(),o.position(t.x,t.y,{silent:!0}),this.snapOffset={x:n.tx,y:n.ty}}else this.snapOffset=null}onDragging(s){const t=this.draggingView;if(t){s.preventDefault();const n=this.normalizeEvent(s),o=n.clientX,r=n.clientY;this.updateGraphPosition(o,r);const a=this.updateNodePosition(o,r),l=this.targetGraph.options.embedding.enabled,d=(l||this.isSnaplineEnabled())&&this.isInsideValidArea({x:o,y:r});if(l){t.setEventData(n,{graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView});const p=t.getEventData(n);d?t.processEmbedding(n,p):t.clearEmbedding(p),this.candidateEmbedView=p.candidateEmbedView}this.isSnaplineEnabled()&&(d?this.snapline.snapOnMoving({e:n,view:t,x:a.x,y:a.y}):this.snapline.hide())}}onDragEnd(s){const t=this.draggingNode;if(t){const n=this.normalizeEvent(s),o=this.draggingView,r=this.draggingBBox,a=this.snapOffset;let l=r.x,d=r.y;a&&(l+=a.x,d+=a.y),t.position(l,d,{silent:!0});const p=this.drop(t,{x:n.clientX,y:n.clientY}),h=u=>{u?(this.onDropped(t),this.targetGraph.options.embedding.enabled&&o&&(o.setEventData(n,{cell:u,graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView}),o.finalizeEmbedding(n,o.getEventData(n)))):this.onDropInvalid(),this.candidateEmbedView=null,this.targetModel.stopBatch("dnd")};c.eY.isAsync(p)?(this.undelegateDocumentEvents(),p.then(h)):h(p)}}clearDragging(){this.draggingNode&&(this.sourceNode=null,this.draggingNode.remove(),this.draggingNode=null,this.draggingView=null,this.delta=null,this.padding=null,this.snapOffset=null,this.originOffset=null,this.undelegateDocumentEvents())}onDropped(s){this.draggingNode===s&&(this.clearDragging(),c.Jf.removeClass(this.container,"dragging"),c.Jf.remove(this.container))}onDropInvalid(){const s=this.draggingNode;s&&this.onDropped(s)}isInsideValidArea(s){let t,n=null;const o=this.targetGraph,r=this.targetScroller;this.options.dndContainer&&(n=this.getDropArea(this.options.dndContainer));const a=n&&n.containsPoint(s);if(r)if(r.options.autoResize)t=this.getDropArea(r.container);else{const l=this.getDropArea(r.container);t=this.getDropArea(o.container).intersectsWithRect(l)}else t=this.getDropArea(o.container);return!a&&t&&t.containsPoint(s)}getDropArea(s){const t=c.Jf.offset(s),n=document.body.scrollTop||document.documentElement.scrollTop,o=document.body.scrollLeft||document.documentElement.scrollLeft;return c.M_.create({x:t.left+parseInt(c.Jf.css(s,"border-left-width"),10)-o,y:t.top+parseInt(c.Jf.css(s,"border-top-width"),10)-n,width:s.clientWidth,height:s.clientHeight})}drop(s,t){if(this.isInsideValidArea(t)){const n=this.targetGraph,o=n.model,r=n.clientToLocal(t),a=this.sourceNode,l=this.options.getDropNode(s,{sourceNode:a,draggingNode:s,targetGraph:this.targetGraph,draggingGraph:this.draggingGraph}),d=l.getBBox();r.x+=d.x-d.width/2,r.y+=d.y-d.height/2;const p=this.snapOffset?1:n.getGridSize();l.position(c.fZ.snapToGrid(r.x,p),c.fZ.snapToGrid(r.y,p)),l.removeZIndex();const h=this.options.validateNode,u=!h||h(l,{sourceNode:a,draggingNode:s,droppingNode:l,targetGraph:n,draggingGraph:this.draggingGraph});return"boolean"==typeof u?u?(o.addCell(l,{stencil:this.cid}),l):null:c.eY.toDeferredBoolean(u).then(f=>f?(o.addCell(l,{stencil:this.cid}),l):null)}return null}onRemove(){this.draggingGraph&&(this.draggingGraph.view.remove(),this.draggingGraph.dispose())}dispose(){this.remove(),c.H.clean(this.name)}}(function(i,s,t,n){var a,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(o<3?a(r):o>3?a(s,t,r):a(s,t))||r);o>3&&r&&Object.defineProperty(s,t,r)})([c.Ss.dispose()],St.prototype,"dispose",null),function(i){i.defaults={getDragNode:s=>s.clone(),getDropNode:s=>s.clone()},i.documentEvents={mousemove:"onDragging",touchmove:"onDragging",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"}}(St||(St={}));var ni=m(3179),ii=m(6504);let oi=(()=>{class i{set page(t){this._page=t,this.render(t)}get page(){return this._page}constructor(t,n,o,r){this.cs=t,this.ns=n,this.injector=o,this.graph=new c.ke({container:r.nativeElement,background:{},grid:{size:10,visible:JSON.parse(localStorage.getItem("nuwa-editor-grid")||"true"),type:"fixedDot"}}),this.graph.use(new Le),this.graph.use(new Fe({enabled:!0})),this.graph.use(new wt({resizing:!0,rotating:!0})),this.graph.use(new Oe({enabled:!0})),this.graph.use(new Ve({enabled:!0})),this.graph.use(new Nt({enabled:!0})),this.graph.use(new Dt({enabled:!0,multiple:!0,rubberband:!0,rubberEdge:!0,movable:!0,strict:!0,showNodeSelectionBox:!0})),this.dnd=new St({target:this.graph}),this.graph.bindKey("ctrl+s",a=>{this.graph.exportPNG(),a.preventDefault()}),this.graph.bindKey("ctrl+z",()=>this.graph.undo()),this.graph.bindKey("ctrl+y",()=>this.graph.redo()),this.graph.bindKey("ctrl+x",()=>this.graph.cut(this.graph.getSelectedCells(),{deep:!0})),this.graph.bindKey("ctrl+c",()=>this.graph.copy(this.graph.getSelectedCells(),{deep:!0})),this.graph.bindKey("ctrl+v",()=>this.graph.resetSelection(this.graph.paste())),this.graph.bindKey("backspace",()=>this.graph.getSelectedCells().forEach(a=>a.remove())),this.graph.bindKey("delete",()=>this.graph.getSelectedCells().forEach(a=>a.remove())),this.graph.bindKey("escape",()=>{this.drawingEdge&&(this.drawingEdge=void 0)}),this.graph.container.onclick=a=>{this.drawingEdgeComponent?(this.drawingEdge=this.graph.addEdge({shape:this.drawingEdgeComponent.id,source:[a.offsetX,a.offsetY],target:[a.offsetX+10,a.offsetY+10],...this.drawingEdgeComponent.metadata}),this.drawingEdgeComponent=void 0):this.drawingEdge=void 0},this.graph.container.onmousemove=a=>{this.drawingEdge&&this.drawingEdge.setTerminal("target",{x:a.offsetX,y:a.offsetY})},this.graph.on("edge:selected",c.eY.debounce(({edge:a})=>{a.addTools([{name:"source-arrowhead"},{name:"target-arrowhead"},{name:"vertices"},{name:"segments"}])})),this.graph.on("edge:unselected",({cell:a})=>{a.removeTools()})}render(t){t.content?.cells?.forEach(n=>{this.cs.Get(n.shape)}),this.graph.drawBackground({color:t.background_color,image:t.background_image}),this.graph.fromJSON(t.content)}drawEdge(t){this.drawingEdgeComponent=void 0,this.checkRegister(t)&&"line"==t.type&&(this.drawingEdgeComponent=t)}drawNode(t,n,o={}){let r;if(!this.checkRegister(n))return;if("line"==n.type)return void this.ns.error("\u9519\u8bef","\u7ebf\u6761\u4e0d\u80fd\u62d6\u653e");let a={};n.properties?.forEach(l=>{void 0!==l.default&&(a[l.key]=l.default)}),n.bindings?.forEach(l=>a[l.name]=l.default),r=this.graph.createNode({shape:n.id,...n.metadata}),Object.keys(a).forEach(l=>{r.setPropByPath(l,a[l])}),Object.keys(o).forEach(l=>{r.setPropByPath(l,o[l])}),this.dnd.start(r,t)}checkRegister(t){if(t.registered||t.internal)return!0;switch(t.registered=!0,t.type){case"line":if(t.extends)return c.ke.registerEdge(t.id,t.extends),!0;this.ns.error("\u7f16\u8bd1\u9519\u8bef",t.id+" "+t.name+"\u7f3a\u5c11extends");break;case"shape":if(t.extends)return c.ke.registerNode(t.id,t.extends),!0;this.ns.error("\u7f16\u8bd1\u9519\u8bef",t.id+" "+t.name+"\u7f3a\u5c11extends");break;case"html":c.yp.g3.register({shape:t.id,width:t.metadata?.width||100,height:t.metadata?.height||100,html:t.html});break;case"angular":if(t.content)return(0,ni.kz)({shape:t.id,width:t.metadata?.width||100,height:t.metadata?.height||100,content:t.content,injector:this.injector}),t.registered=!0,!0;this.ns.error("\u7f16\u8bd1\u9519\u8bef",t.id+" "+t.name+"\u7f3a\u5c11content")}return!1}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(it.b),e.rXU(ii.xY),e.rXU(e.zZn),e.rXU(e.aKT))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-canvas"]],inputs:{page:"page"},decls:0,vars:0,template:function(n,o){},styles:["[_nghost-%COMP%]{display:block;position:relative;box-shadow:#a8a8a8 2px 2px 10px;background-color:#fff;width:100%;height:100%}"]})}return i})();var ue=m(3053),Yt=m(7529),Xt=m(8927),ge=m(1011);let si=(()=>{class i{set project(t){t&&this.group.patchValue(t)}constructor(t){this.fb=t,this.build()}build(t){this.group=this.fb.group({id:[(t=t||{}).id||"",[E.k0.required]],name:[t.name||"",[E.k0.required]],desc:[t.desc||"",[]],width:[t.width||400,[E.k0.required]],height:[t.height||400,[E.k0.required]]})}setData(t){const n=this.group.value;for(const o in n)n[o]=t[o];this.group.setValue(n)}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(E.ok))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-project-setting"]],inputs:{project:"project"},decls:26,vars:11,consts:[["nz-form","",3,"formGroup"],["nzRequired","","nzFor","id",3,"nzSpan"],["nzErrorTip","ID\u4e0d\u53ef\u4e3a\u7a7a!",3,"nzSpan"],["nz-input","","name","id","formControlName","id"],["nzRequired","","nzFor","name",3,"nzSpan"],["nzErrorTip","\u540d\u79f0\u4e0d\u53ef\u4e3a\u7a7a!",3,"nzSpan"],["nz-input","","name","name","formControlName","name"],["nzFor","width",3,"nzSpan"],[3,"nzSpan"],["formControlName","width"],["nzFor","height",3,"nzSpan"],["formControlName","height"],["nzFor","desc",3,"nzSpan"],["nz-input","","name","desc","formControlName","desc"]],template:function(n,o){1&n&&(e.j41(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),e.EFF(3,"ID"),e.k0s(),e.j41(4,"nz-form-control",2),e.nrm(5,"input",3),e.k0s()(),e.j41(6,"nz-form-item")(7,"nz-form-label",4),e.EFF(8,"\u540d\u79f0"),e.k0s(),e.j41(9,"nz-form-control",5),e.nrm(10,"input",6),e.k0s()(),e.j41(11,"nz-form-item")(12,"nz-form-label",7),e.EFF(13,"\u5bbd\u5ea6"),e.k0s(),e.j41(14,"nz-form-control",8),e.nrm(15,"nz-input-number",9),e.k0s()(),e.j41(16,"nz-form-item")(17,"nz-form-label",10),e.EFF(18,"\u9ad8\u5ea6"),e.k0s(),e.j41(19,"nz-form-control",8),e.nrm(20,"nz-input-number",11),e.k0s()(),e.j41(21,"nz-form-item")(22,"nz-form-label",12),e.EFF(23,"\u8bf4\u660e"),e.k0s(),e.j41(24,"nz-form-control",8),e.nrm(25,"input",13),e.k0s()()()),2&n&&(e.Y8G("formGroup",o.group),e.R7$(2),e.Y8G("nzSpan",5),e.R7$(2),e.Y8G("nzSpan",16),e.R7$(3),e.Y8G("nzSpan",5),e.R7$(2),e.Y8G("nzSpan",16),e.R7$(3),e.Y8G("nzSpan",5),e.R7$(2),e.Y8G("nzSpan",16),e.R7$(3),e.Y8G("nzSpan",5),e.R7$(2),e.Y8G("nzSpan",16),e.R7$(3),e.Y8G("nzSpan",5),e.R7$(2),e.Y8G("nzSpan",16))},dependencies:[E.qT,E.me,E.BC,E.cb,E.j4,E.JD,Yt.Uq,Yt.e,Xt.CA,Xt.Ls,Xt.Mo,Xt.zS,ge.Sy,$t.FG]})}return i})();function ri(i,s){if(1&i&&(e.j41(0,"p")(1,"a",2),e.EFF(2),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.Y8G("href",t.url,e.B4B),e.R7$(),e.JRh(t.name),e.R7$(),e.SpI(" ",t.email,"\n")}}let ai=(()=>{class i{constructor(){this.contributors=[{name:"\u6770\u795e",url:"https://github.com/zgwit",email:"jason@zgwit.com"},{name:"EnTrouble",url:"https://github.com/EnTrouble",email:"hutianqi@zgwit.cn"}]}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-about"]],decls:6,vars:1,consts:[["href","https://github.com/antvis/X6"],[4,"ngFor","ngForOf"],["target","_blank",3,"href"]],template:function(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"\u7269\u8054\u5927\u5e08Web\u7ec4\u6001\u63d2\u4ef6\uff0c\u57fa\u4e8e\u963f\u91cc"),e.j41(2,"a",0),e.EFF(3,"AntV-X6"),e.k0s(),e.EFF(4,"\u5b9e\u73b0\uff0c\u5e95\u5c42\u4f7f\u7528Canvas\u548cSVG\u6280\u672f\uff0c\u8d21\u732e\u8005\u540d\u5355\uff1a"),e.k0s(),e.DNE(5,ri,4,3,"p",1)),2&n&&(e.R7$(5),e.Y8G("ngForOf",o.contributors))},dependencies:[T.Sq]})}return i})();function li(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzText)}}function ci(i,s){if(1&i&&(e.j41(0,"span",0),e.DNE(1,li,2,1,"ng-container",1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzText)}}let Ye=(()=>{class i{constructor(){this.nzType="horizontal",this.nzOrientation="center",this.nzDashed=!1,this.nzPlain=!1}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:16,hostBindings:function(n,o){2&n&&e.AVh("ant-divider-horizontal","horizontal"===o.nzType)("ant-divider-vertical","vertical"===o.nzType)("ant-divider-with-text",o.nzText)("ant-divider-plain",o.nzPlain)("ant-divider-with-text-left",o.nzText&&"left"===o.nzOrientation)("ant-divider-with-text-right",o.nzText&&"right"===o.nzOrientation)("ant-divider-with-text-center",o.nzText&&"center"===o.nzOrientation)("ant-divider-dashed",o.nzDashed)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzDashed:"nzDashed",nzPlain:"nzPlain"},exportAs:["nzDivider"],standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function(n,o){1&n&&e.DNE(0,ci,2,1,"span",0),2&n&&e.vxM(0,o.nzText?0:-1)},dependencies:[F.C,F.m],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzDashed",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzPlain",void 0),i})(),di=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[Ye]})}return i})();var Jt=m(513),Xe=m(6389),fe=m(1997),ht=m(1868),ut=m(2602);const pi=()=>({standalone:!0});let hi=(()=>{class i{constructor(t,n,o,r){this.cs=t,this.modal=n,this.msg=o,this.viewContainerRef=r,this.onSave=new e.bkB,this.scale=1,this.scaleChange=new e.bkB,this.showGrid=JSON.parse(localStorage.getItem("nuwa-editor-grid")||"true")}handleSave(){this.onSave.emit()}handleExport(t){switch(console.log(this.graph),t){case"SVG":this.graph.exportSVG();break;case"PNG":this.graph.exportPNG();break;case"JPEG":this.graph.exportJPEG();break;case"file":this.savefiles(this.graph.toJSON(),Date.now()+"")}}handleUndo(){this.graph.undo()}handleRedo(){this.graph.redo()}handleCut(){this.graph.getSelectedCells().forEach(t=>t.removeTools()),this.graph.cut(this.graph.getSelectedCells(),{deep:!0})}handleCopy(){this.graph.getSelectedCells().forEach(t=>t.removeTools()),this.graph.copy(this.graph.getSelectedCells(),{deep:!0})}handlePaste(){this.graph.paste()}handleDelete(){this.graph.getSelectedCells().forEach(t=>t.remove())}handleAlignLeft(){let t;this.graph.getSelectedCells().forEach(n=>{if(!n.isNode())return;let o=n,r=o.position();void 0===t?t=r.x:(r.x=t,o.setPosition(r))})}handleAlignCenter(){let t;this.graph.getSelectedCells().forEach(n=>{if(!n.isNode())return;let o=n,r=o.position(),a=o.size();void 0===t?t=r.x+.5*a.width:(r.x=t-.5*a.width,o.setPosition(r))})}handleAlignRight(){let t;this.graph.getSelectedCells().forEach(n=>{if(!n.isNode())return;let o=n,r=o.position(),a=o.size();void 0===t?t=r.x+a.width:(r.x=t-a.width,o.setPosition(r))})}handleValignTop(){let t;this.graph.getSelectedCells().forEach(n=>{if(!n.isNode())return;let o=n,r=o.position();void 0===t?t=r.y:(r.y=t,o.setPosition(r))})}handleValignMiddle(){let t;this.graph.getSelectedCells().forEach(n=>{if(!n.isNode())return;let o=n,r=o.position(),a=o.size();void 0===t?t=r.y+.5*a.height:(r.y=t-.5*a.height,o.setPosition(r))})}handleValignBottom(){let t;this.graph.getSelectedCells().forEach(n=>{if(!n.isNode())return;let o=n,r=o.position(),a=o.size();void 0===t?t=r.y+a.height:(r.y=t-a.height,o.setPosition(r))})}handleMoveTop(){this.graph.getSelectedCells().forEach(t=>{t.toFront()})}handleMoveUp(){const t=this.graph.getSelectedCells()[0];t.setZIndex(Number(t.getZIndex()||0)+1)}handleMoveDown(){const t=this.graph.getSelectedCells()[0];t.setZIndex(Number(t.getZIndex()||0)-1)}handleMoveBottom(){this.graph.getSelectedCells().forEach(t=>{t.toBack()})}handleGroup(){let t=this.graph.getSelectedCells().map(r=>r.getBBox()),n={x:t.reduce((r,a)=>r.x<a.x?r:a).x-10,y:t.reduce((r,a)=>r.y<a.y?r:a).y-10,right:t.reduce((r,a)=>r.right>a.right?r:a).right+10,bottom:t.reduce((r,a)=>r.bottom>a.bottom?r:a).bottom+10};console.log("group",n),this.cs.Get("group");let o=this.graph.addNode({shape:"group",x:n.x,y:n.y,width:n.right-n.x,height:n.bottom-n.y});this.graph.getSelectedCells().forEach(r=>{r.setZIndex(o.zIndex+r.zIndex),o.addChild(r)})}handleUngroup(){this.graph.getSelectedCells().forEach(t=>{"group"==t.shape&&(t.getChildren()?.forEach(n=>{n.setParent(null)}),t.setChildren(null),t.remove())})}isGroup(){return 1===this.graph.getSelectedCellCount()&&this.graph.getSelectedCells()[0].getChildCount()>0}handleGrid(){this.showGrid?this.graph.hideGrid():this.graph.showGrid(),this.showGrid=!this.showGrid,localStorage.setItem("nuwa-editor-grid",JSON.stringify(this.showGrid))}settingProject(){const t=this.modal.create({nzTitle:"\u7f16\u8f91\u5de5\u7a0b\u4fe1\u606f",nzContent:si,nzData:{project:this.project},nzViewContainerRef:this.viewContainerRef,nzFooter:[{label:"\u53d6\u6d88",onClick:()=>t.destroy()},{label:"\u4fdd\u5b58",type:"primary",onClick:n=>{const o=n.group.value;Object.assign(this.project,o),console.log("project setting",o),t.destroy()}}]})}savefiles(t,n){const o=window.URL||window.webkitURL||window,r=new Blob([JSON.stringify(t)]),a=document.createElement("a");a.href=o.createObjectURL(r),a.download=n,a.click()}handleScale(t){this.scaleChange.emit(t),this.graph.zoomTo(t)}about(){this.modal.create({nzTitle:"\u5173\u4e8e",nzContent:ai,nzFooter:null})}handleImport(){}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(it.b),e.rXU(ue.N_),e.rXU(ft.xh),e.rXU(e.c1b))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-toolbar"]],inputs:{project:"project",graph:"graph",scale:"scale"},outputs:{onSave:"onSave",scaleChange:"scaleChange"},features:[e.Jv_([ft.xh,ue.N_])],decls:75,vars:30,consts:[["exportDropDownMenu","nzDropdownMenu"],["nz-button","",3,"click"],["nz-icon","","nzType","question-circle","title","\u5173\u4e8e"],["nzType","vertical"],["nz-button","","nz-dropdown","","title","\u5bfc\u51fa",3,"nzDropdownMenu"],["nz-icon","","nzType","profile"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-divider",""],["nz-button","","title","\u4fdd\u5b58",3,"click"],["nz-icon","","nzType","save"],["nz-icon","","nzType","table","title","\u663e\u793a\u7f51\u683c"],["nz-icon","","nzType","setting","title","\u5de5\u7a0b\u8bbe\u7f6e"],["nz-button","","title","\u64a4\u9500(ctrl+z)",3,"click","disabled"],["nz-icon","","nzType","undo"],["nz-button","","title","\u91cd\u505a(ctrl+y)",3,"click","disabled"],["nz-icon","","nzType","redo"],["nz-button","","title","\u526a\u5207(ctrl+x)",3,"click","disabled"],["nz-icon","","nzType","scissor"],["nz-button","","title","\u590d\u5236(ctrl+c)",3,"click","disabled"],["nz-icon","","nzType","copy"],["nz-button","","title","\u7c98\u8d34(ctrl+v)",3,"click","disabled"],["nz-icon","","nzType","snippets"],["nz-button","","title","\u5220\u9664",3,"click","disabled"],["nz-icon","","nzType","delete"],["nz-button","",3,"click","disabled"],["nz-icon","","nzType","align-left","title","\u5de6\u5bf9\u9f50"],["nz-icon","","nzType","align-center","title","\u5c45\u4e2d\u5bf9\u9f50"],["nz-icon","","nzType","align-right","title","\u53f3\u5bf9\u9f50"],["nz-icon","","nzType","vertical-align-top","title","\u4e0a\u5bf9\u9f50"],["nz-icon","","nzType","vertical-align-middle","title","\u5c45\u4e2d\u5bf9\u9f50"],["nz-icon","","nzType","vertical-align-bottom","title","\u4e0b\u5bf9\u9f50"],["nz-icon","","nzType","vertical-right","title","\u7f6e\u9876",3,"nzRotate"],["nz-icon","","nzType","up","title","\u4e0a\u79fb\u4e00\u5c42"],["nz-icon","","nzType","down","title","\u4e0b\u79fb\u4e00\u5c42"],["nz-icon","","nzType","vertical-left","title","\u7f6e\u5e95",3,"nzRotate"],["nz-icon","","nzType","group","title","\u7ec4\u5408"],["nz-icon","","nzType","ungroup","title","\u89e3\u9664\u7ec4\u5408"],[3,"ngModelChange","ngModel","ngModelOptions"],["nzLabel","25%",3,"nzValue"],["nzLabel","50%",3,"nzValue"],["nzLabel","75%",3,"nzValue"],["nzLabel","100%",3,"nzValue"],["nzLabel","200%",3,"nzValue"],["nzLabel","500%",3,"nzValue"]],template:function(n,o){if(1&n){const r=e.RV6();e.j41(0,"a",1),e.bIt("click",function(){return e.eBV(r),e.Njj(o.about())}),e.nrm(1,"i",2),e.k0s(),e.nrm(2,"nz-divider",3),e.j41(3,"a",4),e.nrm(4,"i",5),e.k0s(),e.j41(5,"nz-dropdown-menu",null,0)(7,"ul",6)(8,"li",7),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleExport("SVG"))}),e.EFF(9,"\u5bfc\u51faSVG"),e.k0s(),e.j41(10,"li",7),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleExport("PNG"))}),e.EFF(11,"\u5bfc\u51faPNG"),e.k0s(),e.j41(12,"li",7),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleExport("JPEG"))}),e.EFF(13,"\u5bfc\u51faJPEG"),e.k0s(),e.nrm(14,"li",8),e.j41(15,"li",7),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleExport("file"))}),e.EFF(16,"\u5bfc\u51faJSON"),e.k0s(),e.j41(17,"li",7),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleImport())}),e.EFF(18,"\u5bfc\u5165JSON"),e.k0s()()(),e.j41(19,"a",9),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleSave())}),e.nrm(20,"i",10),e.k0s(),e.j41(21,"a",1),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleGrid())}),e.nrm(22,"i",11),e.k0s(),e.j41(23,"a",1),e.bIt("click",function(){return e.eBV(r),e.Njj(o.settingProject())}),e.nrm(24,"i",12),e.k0s(),e.nrm(25,"nz-divider",3),e.j41(26,"a",13),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleUndo())}),e.nrm(27,"i",14),e.k0s(),e.j41(28,"a",15),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleRedo())}),e.nrm(29,"i",16),e.k0s(),e.nrm(30,"nz-divider",3),e.j41(31,"a",17),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleCut())}),e.nrm(32,"i",18),e.k0s(),e.j41(33,"a",19),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleCopy())}),e.nrm(34,"i",20),e.k0s(),e.j41(35,"a",21),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handlePaste())}),e.nrm(36,"i",22),e.k0s(),e.j41(37,"a",23),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleDelete())}),e.nrm(38,"i",24),e.k0s(),e.nrm(39,"nz-divider",3),e.j41(40,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleAlignLeft())}),e.nrm(41,"i",26),e.k0s(),e.j41(42,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleAlignCenter())}),e.nrm(43,"i",27),e.k0s(),e.j41(44,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleAlignRight())}),e.nrm(45,"i",28),e.k0s(),e.nrm(46,"nz-divider",3),e.j41(47,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleValignTop())}),e.nrm(48,"i",29),e.k0s(),e.j41(49,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleValignMiddle())}),e.nrm(50,"i",30),e.k0s(),e.j41(51,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleValignBottom())}),e.nrm(52,"i",31),e.k0s(),e.nrm(53,"nz-divider",3),e.j41(54,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleMoveTop())}),e.nrm(55,"i",32),e.k0s(),e.j41(56,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleMoveUp())}),e.nrm(57,"i",33),e.k0s(),e.j41(58,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleMoveDown())}),e.nrm(59,"i",34),e.k0s(),e.j41(60,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleMoveBottom())}),e.nrm(61,"i",35),e.k0s(),e.nrm(62,"nz-divider",3),e.j41(63,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleGroup())}),e.nrm(64,"i",36),e.k0s(),e.j41(65,"a",25),e.bIt("click",function(){return e.eBV(r),e.Njj(o.handleUngroup())}),e.nrm(66,"i",37),e.k0s(),e.nrm(67,"nz-divider",3),e.j41(68,"nz-select",38),e.bIt("ngModelChange",function(l){return e.eBV(r),e.Njj(o.handleScale(l))}),e.nrm(69,"nz-option",39)(70,"nz-option",40)(71,"nz-option",41)(72,"nz-option",42)(73,"nz-option",43)(74,"nz-option",44),e.k0s()}if(2&n){const r=e.sdS(6);e.R7$(3),e.Y8G("nzDropdownMenu",r),e.R7$(23),e.Y8G("disabled",!o.graph.canUndo()),e.R7$(2),e.Y8G("disabled",!o.graph.canRedo()),e.R7$(3),e.Y8G("disabled",!o.graph.getSelectedCellCount()),e.R7$(2),e.Y8G("disabled",!o.graph.getSelectedCellCount()),e.R7$(2),e.Y8G("disabled",!o.graph.getCellsInClipboard().length),e.R7$(2),e.Y8G("disabled",!o.graph.getSelectedCellCount()),e.R7$(3),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(2),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(2),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(3),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(2),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(2),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(3),e.Y8G("disabled",!o.graph.getSelectedCellCount()),e.R7$(),e.Y8G("nzRotate",90),e.R7$(),e.Y8G("disabled",1!=o.graph.getSelectedCellCount()),e.R7$(2),e.Y8G("disabled",1!=o.graph.getSelectedCellCount()),e.R7$(2),e.Y8G("disabled",!o.graph.getSelectedCellCount()),e.R7$(),e.Y8G("nzRotate",90),e.R7$(2),e.Y8G("disabled",o.graph.getSelectedCellCount()<2),e.R7$(2),e.Y8G("disabled",!o.isGroup()),e.R7$(3),e.Y8G("ngModel",o.scale)("ngModelOptions",e.lJ4(29,pi)),e.R7$(),e.Y8G("nzValue",.25),e.R7$(),e.Y8G("nzValue",.5),e.R7$(),e.Y8G("nzValue",.75),e.R7$(),e.Y8G("nzValue",1),e.R7$(),e.Y8G("nzValue",2),e.R7$(),e.Y8G("nzValue",5)}},dependencies:[E.BC,E.vS,G.Dn,Ye,Jt.aO,Xe.c,fe.ld,fe.WI,ht.jS,ht.CU,ht.sD,ut.j3,ut.G_,ut.wQ,ut.h4],styles:["[_nghost-%COMP%]{height:50px;display:flex;align-items:center;vertical-align:middle;padding:0 20px;border-bottom:1px solid #a8a8a8;background-color:#f0f0f0}a[_ngcontent-%COMP%]{padding:5px;margin:1px;cursor:pointer;text-decoration:none}a.disabled[_ngcontent-%COMP%]{color:gray;cursor:default}"]})}return i})();var qt=m(1875),ui=m(5930),He=m(6860),pt=m(1413),_i=m(9030),me=m(7673),Zt=m(7786),zi=m(4412),xi=m(1397),ve=m(9172),Qt=m(2983),We=m(1672);const bt=["*"];function Pi(i,s){1&i&&e.SdG(0)}const Ri=["nz-list-item-actions",""];function Bi(i,s){}function Oi(i,s){1&i&&e.nrm(0,"em",1)}function Vi(i,s){if(1&i&&(e.j41(0,"li"),e.DNE(1,Bi,0,0,"ng-template",0)(2,Oi,1,0,"em",1),e.k0s()),2&i){const t=s.$implicit,n=s.$index,o=s.$count;e.R7$(),e.Y8G("ngTemplateOutlet",t),e.R7$(),e.vxM(2,n!==o-1?2:-1)}}const Fi=[[["nz-list-header"]],[["nz-list-footer"],["","nz-list-footer",""]],[["nz-list-load-more"],["","nz-list-load-more",""]],[["nz-list-pagination"],["","nz-list-pagination",""]],"*"],Gi=["nz-list-header","nz-list-footer, [nz-list-footer]","nz-list-load-more, [nz-list-load-more]","nz-list-pagination, [nz-list-pagination]","*"],Ke=(i,s)=>({$implicit:i,index:s});function ji(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzHeader)}}function Li(i,s){if(1&i&&(e.j41(0,"nz-list-header"),e.DNE(1,ji,2,1,"ng-container",5),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzHeader)}}function Yi(i,s){1&i&&e.nrm(0,"div"),2&i&&e.xc7("min-height",53,"px")}function Xi(i,s){}function Hi(i,s){if(1&i&&(e.j41(0,"div",6),e.DNE(1,Xi,0,0,"ng-template",7),e.k0s()),2&i){const t=s.$implicit,n=s.$index,o=e.XpG(2);e.Y8G("nzSpan",o.nzGrid.span||null)("nzXs",o.nzGrid.xs||null)("nzSm",o.nzGrid.sm||null)("nzMd",o.nzGrid.md||null)("nzLg",o.nzGrid.lg||null)("nzXl",o.nzGrid.xl||null)("nzXXl",o.nzGrid.xxl||null),e.R7$(),e.Y8G("ngTemplateOutlet",o.nzRenderItem)("ngTemplateOutletContext",e.l_i(9,Ke,t,n))}}function Ui(i,s){if(1&i&&(e.j41(0,"div",2),e.Z7z(1,Hi,2,12,"div",6,e.fX1),e.k0s()),2&i){const t=e.XpG();e.Y8G("nzGutter",t.nzGrid.gutter||null),e.R7$(),e.Dyx(t.nzDataSource)}}function Wi(i,s){}function Ki(i,s){if(1&i&&(e.qex(0),e.DNE(1,Wi,0,0,"ng-template",7),e.bVm()),2&i){const t=s.$implicit,n=s.$index,o=e.XpG(2);e.R7$(),e.Y8G("ngTemplateOutlet",o.nzRenderItem)("ngTemplateOutletContext",e.l_i(2,Ke,t,n))}}function $i(i,s){if(1&i&&(e.j41(0,"div",8),e.Z7z(1,Ki,2,5,"ng-container",null,e.fX1),e.SdG(3,4),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Dyx(t.nzDataSource)}}function Ji(i,s){if(1&i&&e.nrm(0,"nz-list-empty",3),2&i){const t=e.XpG();e.Y8G("nzNoResult",t.nzNoResult)}}function qi(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzFooter)}}function Zi(i,s){if(1&i&&(e.j41(0,"nz-list-footer"),e.DNE(1,qi,2,1,"ng-container",5),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzFooter)}}function Qi(i,s){}function to(i,s){}function eo(i,s){if(1&i&&(e.j41(0,"nz-list-pagination"),e.DNE(1,to,0,0,"ng-template",4),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngTemplateOutlet",t.nzPagination)}}const no=[[["nz-list-item-actions"],["","nz-list-item-actions",""]],[["nz-list-item-meta"],["","nz-list-item-meta",""]],"*",[["nz-list-item-extra"],["","nz-list-item-extra",""]]],io=["nz-list-item-actions, [nz-list-item-actions]","nz-list-item-meta, [nz-list-item-meta]","*","nz-list-item-extra, [nz-list-item-extra]"];function oo(i,s){if(1&i&&e.nrm(0,"ul",3),2&i){const t=e.XpG(2);e.Y8G("nzActions",t.nzActions)}}function so(i,s){if(1&i&&(e.DNE(0,oo,1,1,"ul",3),e.SdG(1)),2&i){const t=e.XpG();e.vxM(0,t.nzActions&&t.nzActions.length>0?0:-1)}}function ro(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(3);e.R7$(),e.JRh(t.nzContent)}}function ao(i,s){if(1&i&&e.DNE(0,ro,2,1,"ng-container",4),2&i){const t=e.XpG(2);e.Y8G("nzStringTemplateOutlet",t.nzContent)}}function lo(i,s){if(1&i&&(e.SdG(0,1),e.SdG(1,2),e.DNE(2,ao,1,1,"ng-container")),2&i){const t=e.XpG();e.R7$(2),e.vxM(2,t.nzContent?2:-1)}}function co(i,s){1&i&&e.SdG(0,3)}function po(i,s){}function ho(i,s){}function uo(i,s){}function go(i,s){if(1&i&&(e.j41(0,"nz-list-item-extra"),e.DNE(1,uo,0,0,"ng-template",6),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("ngTemplateOutlet",t.nzExtra)}}function fo(i,s){}function mo(i,s){if(1&i&&(e.j41(0,"div",5),e.DNE(1,po,0,0,"ng-template",6)(2,ho,0,0,"ng-template",6),e.k0s(),e.DNE(3,go,2,1,"nz-list-item-extra")(4,fo,0,0,"ng-template",6)),2&i){const t=e.XpG(),n=e.sdS(1),o=e.sdS(3),r=e.sdS(5);e.R7$(),e.Y8G("ngTemplateOutlet",o),e.R7$(),e.Y8G("ngTemplateOutlet",n),e.R7$(),e.vxM(3,t.nzExtra?3:-1),e.R7$(),e.Y8G("ngTemplateOutlet",r)}}function vo(i,s){}function Co(i,s){}function bo(i,s){}function _o(i,s){}function zo(i,s){if(1&i&&e.DNE(0,vo,0,0,"ng-template",6)(1,Co,0,0,"ng-template",6)(2,bo,0,0,"ng-template",6)(3,_o,0,0,"ng-template",6),2&i){const t=e.XpG(),n=e.sdS(1),o=e.sdS(3),r=e.sdS(5);e.Y8G("ngTemplateOutlet",o),e.R7$(),e.Y8G("ngTemplateOutlet",t.nzExtra),e.R7$(),e.Y8G("ngTemplateOutlet",r),e.R7$(),e.Y8G("ngTemplateOutlet",n)}}let _e=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-item-extra"],["","nz-list-item-extra",""]],hostAttrs:[1,"ant-list-item-extra"],exportAs:["nzListItemExtra"],standalone:!0,features:[e.aNF],ngContentSelectors:bt,decls:1,vars:0,template:function(n,o){1&n&&(e.NAR(),e.SdG(0))},encapsulation:2,changeDetection:0})}return i})(),Je=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-item-action"]],viewQuery:function(n,o){if(1&n&&e.GBs(e.C4Q,5),2&n){let r;e.mGM(r=e.lsd())&&(o.templateRef=r.first)}},exportAs:["nzListItemAction"],standalone:!0,features:[e.aNF],ngContentSelectors:bt,decls:1,vars:0,template:function(n,o){1&n&&(e.NAR(),e.DNE(0,Pi,1,0,"ng-template"))},encapsulation:2,changeDetection:0})}return i})(),qe=(()=>{class i{constructor(t,n){this.nzActions=[],this.actions=[],this.inputActionChanges$=new pt.B,this.contentChildrenChanges$=(0,_i.v)(()=>this.nzListItemActions?(0,me.of)(null):this.initialized.pipe((0,xi.Z)(()=>this.nzListItemActions.changes.pipe((0,ve.Z)(this.nzListItemActions))))),this.initialized=new pt.B,(0,Zt.h)(this.contentChildrenChanges$,this.inputActionChanges$).pipe((0,H.Q)(n)).subscribe(()=>{this.actions=this.nzActions.length?this.nzActions:this.nzListItemActions.map(o=>o.templateRef),t.detectChanges()})}ngOnChanges(){this.inputActionChanges$.next(null)}ngAfterContentInit(){this.initialized.next(),this.initialized.complete()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.gRc),e.rXU(et.y4))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["ul","nz-list-item-actions",""]],contentQueries:function(n,o,r){if(1&n&&e.wni(r,Je,4),2&n){let a;e.mGM(a=e.lsd())&&(o.nzListItemActions=a)}},hostAttrs:[1,"ant-list-item-action"],inputs:{nzActions:"nzActions"},exportAs:["nzListItemActions"],standalone:!0,features:[e.Jv_([et.y4]),e.OA$,e.aNF],attrs:Ri,decls:2,vars:0,consts:[[3,"ngTemplateOutlet"],[1,"ant-list-item-action-split"]],template:function(n,o){1&n&&e.Z7z(0,Vi,3,2,"li",null,e.fX1),2&n&&e.Dyx(o.actions)},dependencies:[T.T3],encapsulation:2,changeDetection:0})}return i})(),Ze=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-empty"]],hostAttrs:[1,"ant-list-empty-text"],inputs:{nzNoResult:"nzNoResult"},exportAs:["nzListHeader"],standalone:!0,features:[e.aNF],decls:1,vars:2,consts:[[3,"nzComponentName","specificContent"]],template:function(n,o){1&n&&e.nrm(0,"nz-embed-empty",0),2&n&&e.Y8G("nzComponentName","list")("specificContent",o.nzNoResult)},dependencies:[We._v,We.E8],encapsulation:2,changeDetection:0})}return i})(),Qe=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-header"]],hostAttrs:[1,"ant-list-header"],exportAs:["nzListHeader"],standalone:!0,features:[e.aNF],ngContentSelectors:bt,decls:1,vars:0,template:function(n,o){1&n&&(e.NAR(),e.SdG(0))},encapsulation:2,changeDetection:0})}return i})(),ze=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-footer"]],hostAttrs:[1,"ant-list-footer"],exportAs:["nzListFooter"],standalone:!0,features:[e.aNF],ngContentSelectors:bt,decls:1,vars:0,template:function(n,o){1&n&&(e.NAR(),e.SdG(0))},encapsulation:2,changeDetection:0})}return i})(),xe=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-pagination"]],hostAttrs:[1,"ant-list-pagination"],exportAs:["nzListPagination"],standalone:!0,features:[e.aNF],ngContentSelectors:bt,decls:1,vars:0,template:function(n,o){1&n&&(e.NAR(),e.SdG(0))},encapsulation:2,changeDetection:0})}return i})(),tn=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["nz-list-load-more"]],exportAs:["nzListLoadMoreDirective"],standalone:!0})}return i})(),te=(()=>{class i{get itemLayoutNotify$(){return this.itemLayoutNotifySource.asObservable()}constructor(t){this.directionality=t,this.nzBordered=!1,this.nzGrid="",this.nzItemLayout="horizontal",this.nzRenderItem=null,this.nzLoading=!1,this.nzLoadMore=null,this.nzSize="default",this.nzSplit=!0,this.hasSomethingAfterLastItem=!1,this.dir="ltr",this.itemLayoutNotifySource=new zi.t(this.nzItemLayout),this.destroy$=new pt.B}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe((0,H.Q)(this.destroy$)).subscribe(t=>{this.dir=t})}getSomethingAfterLastItem(){return!!(this.nzLoadMore||this.nzPagination||this.nzFooter||this.nzListFooterComponent||this.nzListPaginationComponent||this.nzListLoadMoreDirective)}ngOnChanges(t){t.nzItemLayout&&this.itemLayoutNotifySource.next(this.nzItemLayout)}ngOnDestroy(){this.itemLayoutNotifySource.unsubscribe(),this.destroy$.next(),this.destroy$.complete()}ngAfterContentInit(){this.hasSomethingAfterLastItem=this.getSomethingAfterLastItem()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(mt.dS,8))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list"],["","nz-list",""]],contentQueries:function(n,o,r){if(1&n&&(e.wni(r,ze,5),e.wni(r,xe,5),e.wni(r,tn,5)),2&n){let a;e.mGM(a=e.lsd())&&(o.nzListFooterComponent=a.first),e.mGM(a=e.lsd())&&(o.nzListPaginationComponent=a.first),e.mGM(a=e.lsd())&&(o.nzListLoadMoreDirective=a.first)}},hostAttrs:[1,"ant-list"],hostVars:16,hostBindings:function(n,o){2&n&&e.AVh("ant-list-rtl","rtl"===o.dir)("ant-list-vertical","vertical"===o.nzItemLayout)("ant-list-lg","large"===o.nzSize)("ant-list-sm","small"===o.nzSize)("ant-list-split",o.nzSplit)("ant-list-bordered",o.nzBordered)("ant-list-loading",o.nzLoading)("ant-list-something-after-last-item",o.hasSomethingAfterLastItem)},inputs:{nzDataSource:"nzDataSource",nzBordered:"nzBordered",nzGrid:"nzGrid",nzHeader:"nzHeader",nzFooter:"nzFooter",nzItemLayout:"nzItemLayout",nzRenderItem:"nzRenderItem",nzLoading:"nzLoading",nzLoadMore:"nzLoadMore",nzPagination:"nzPagination",nzSize:"nzSize",nzSplit:"nzSplit",nzNoResult:"nzNoResult"},exportAs:["nzList"],standalone:!0,features:[e.OA$,e.aNF],ngContentSelectors:Gi,decls:14,vars:8,consts:[[3,"nzSpinning"],[3,"min-height"],["nz-row","",3,"nzGutter"],[3,"nzNoResult"],[3,"ngTemplateOutlet"],[4,"nzStringTemplateOutlet"],["nz-col","",3,"nzSpan","nzXs","nzSm","nzMd","nzLg","nzXl","nzXXl"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-list-items"]],template:function(n,o){1&n&&(e.NAR(Fi),e.DNE(0,Li,2,1,"nz-list-header"),e.SdG(1),e.j41(2,"nz-spin",0),e.qex(3),e.DNE(4,Yi,1,2,"div",1)(5,Ui,3,1,"div",2)(6,$i,4,0)(7,Ji,1,1,"nz-list-empty",3),e.bVm(),e.k0s(),e.DNE(8,Zi,2,1,"nz-list-footer"),e.SdG(9,1),e.DNE(10,Qi,0,0,"ng-template",4),e.SdG(11,2),e.DNE(12,eo,2,1,"nz-list-pagination"),e.SdG(13,3)),2&n&&(e.vxM(0,o.nzHeader?0:-1),e.R7$(2),e.Y8G("nzSpinning",o.nzLoading),e.R7$(2),e.vxM(4,o.nzLoading&&o.nzDataSource&&0===o.nzDataSource.length?4:-1),e.R7$(),e.vxM(5,o.nzGrid&&o.nzDataSource?5:6),e.R7$(2),e.vxM(7,!o.nzLoading&&o.nzDataSource&&0===o.nzDataSource.length?7:-1),e.R7$(),e.vxM(8,o.nzFooter?8:-1),e.R7$(2),e.Y8G("ngTemplateOutlet",o.nzLoadMore),e.R7$(2),e.vxM(12,o.nzPagination?12:-1))},dependencies:[T.T3,Qe,F.C,F.m,Qt.V,Qt.a,Yt.f3,Yt.Uq,Yt.e,Ze,ze,xe],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzBordered",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzLoading",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzSplit",void 0),i})(),ye=(()=>{class i{get isVerticalAndExtra(){return!("vertical"!==this.itemLayout||!this.listItemExtraDirective&&!this.nzExtra)}constructor(t,n){this.parentComp=t,this.cdr=n,this.nzActions=[],this.nzExtra=null,this.nzNoFlex=!1}ngAfterViewInit(){this.itemLayout$=this.parentComp.itemLayoutNotify$.subscribe(t=>{this.itemLayout=t,this.cdr.detectChanges()})}ngOnDestroy(){this.itemLayout$&&this.itemLayout$.unsubscribe()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(te),e.rXU(e.gRc))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-list-item"],["","nz-list-item",""]],contentQueries:function(n,o,r){if(1&n&&e.wni(r,_e,5),2&n){let a;e.mGM(a=e.lsd())&&(o.listItemExtraDirective=a.first)}},hostAttrs:[1,"ant-list-item"],hostVars:2,hostBindings:function(n,o){2&n&&e.AVh("ant-list-item-no-flex",o.nzNoFlex)},inputs:{nzActions:"nzActions",nzContent:"nzContent",nzExtra:"nzExtra",nzNoFlex:"nzNoFlex"},exportAs:["nzListItem"],standalone:!0,features:[e.aNF],ngContentSelectors:io,decls:8,vars:1,consts:[["actionsTpl",""],["contentTpl",""],["extraTpl",""],["nz-list-item-actions","",3,"nzActions"],[4,"nzStringTemplateOutlet"],[1,"ant-list-item-main"],[3,"ngTemplateOutlet"]],template:function(n,o){1&n&&(e.NAR(no),e.DNE(0,so,2,1,"ng-template",null,0,e.C5r)(2,lo,3,1,"ng-template",null,1,e.C5r)(4,co,1,0,"ng-template",null,2,e.C5r)(6,mo,5,4)(7,zo,4,4)),2&n&&(e.R7$(6),e.vxM(6,o.isVerticalAndExtra?6:7))},dependencies:[qe,F.C,F.m,T.T3,_e],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzNoFlex",void 0),i})();const wo=i=>({selected:i});function So(i,s){if(1&i){const t=e.RV6();e.j41(0,"nz-list-item",3),e.bIt("click",function(){const o=e.eBV(t).$index,r=e.XpG();return e.Njj(r.open(o))})("contextmenu",function(o){e.eBV(t);const r=e.sdS(4),a=e.XpG();return e.Njj(a.menuService.create(o,r))}),e.EFF(1),e.nrm(2,"i",4),e.k0s(),e.j41(3,"nz-dropdown-menu",null,0)(5,"ul",5)(6,"li",6),e.bIt("click",function(){const o=e.eBV(t).$index,r=e.XpG();return e.Njj(r.handleCopy(o))}),e.EFF(7,"\u590d\u5236"),e.k0s(),e.j41(8,"li",6),e.bIt("click",function(){const o=e.eBV(t).$index,r=e.XpG();return e.Njj(r.handleDel(o))}),e.EFF(9,"\u5220\u9664"),e.k0s()()()}if(2&i){const t=s.$implicit,n=s.$index,o=e.XpG();e.Y8G("ngClass",e.eq3(2,wo,n==o.index)),e.R7$(),e.SpI(" ",t.name||"\u672a\u547d\u540d"," ")}}let ko=(()=>{class i{constructor(t,n){this.ms=t,this.menuService=n,this.onPageChange=new e.bkB,this.index=0}handleDel(t){1!=this.project.pages.length?(this.project.pages.splice(t,1),this.index==t&&(t>=this.project.pages.length&&(this.index=t-1),this.onPageChange.emit(this.index))):this.ms.error("\u518d\u5220\u5c31\u6ca1\u6709\u4e86")}open(t){this.index=t,this.onPageChange.emit(t)}handleCopy(t){let n=JSON.parse(JSON.stringify(this.project.pages[t]));n.name=n.name+" - \u590d\u5236",this.project.pages.push(n)}handleAdd(){this.project.pages.push(At())}onDrop(t){(0,qt.HD)(this.project.pages,t.previousIndex,t.currentIndex)}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(ft.xh),e.rXU(ut.qj))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-pages"]],inputs:{project:"project",graph:"graph"},outputs:{onPageChange:"onPageChange"},decls:5,vars:0,consts:[["menu","nzDropdownMenu"],["nzSize","small","nzBordered","","cdkDropList","",3,"cdkDropListDropped"],["type","button","nz-button","",3,"click"],["cdkDrag","",1,"page",3,"click","contextmenu","ngClass"],["nz-icon","","nzType","holder","cdkDragHandle","",2,"cursor","move"],["nz-menu",""],["nz-menu-item","",3,"click"]],template:function(n,o){1&n&&(e.j41(0,"nz-list",1),e.bIt("cdkDropListDropped",function(a){return o.onDrop(a)}),e.Z7z(1,So,10,4,null,null,e.Vm6),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){return o.handleAdd()}),e.EFF(4,"\u521b\u5efa\u65b0\u9875\u9762"),e.k0s()),2&n&&(e.R7$(),e.Dyx(o.project.pages))},dependencies:[T.YU,G.Dn,Jt.aO,Xe.c,ui.p,ht.jS,ht.CU,ut.wQ,te,ye,qt.Fb,qt.O7,qt.T1],styles:["[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}.page[_ngcontent-%COMP%]{cursor:pointer}.page.selected[_ngcontent-%COMP%]{background-color:#e1e1e1}.page[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}"]})}return i})();const To=["canvas"];function Ao(i,s){if(1&i){const t=e.RV6();e.j41(0,"app-pages",10),e.bIt("onPageChange",function(o){e.eBV(t);const r=e.XpG();return e.Njj(r.handlePageChange(o))}),e.k0s()}if(2&i){const t=e.XpG(),n=e.sdS(10);e.Y8G("project",t.project)("graph",n.graph)}}function Eo(i,s){if(1&i&&e.nrm(0,"app-widgets",11),2&i){e.XpG();const t=e.sdS(10);e.Y8G("canvas",t)}}function Io(i,s){if(1&i&&e.nrm(0,"app-components",11),2&i){e.XpG();const t=e.sdS(10);e.Y8G("canvas",t)}}function No(i,s){if(1&i&&e.nrm(0,"app-galleries",11),2&i){e.XpG();const t=e.sdS(10);e.Y8G("canvas",t)}}function Do(i,s){1&i&&e.nrm(0,"app-sources")}function Mo(i,s){if(1&i&&e.nrm(0,"app-props",11),2&i){e.XpG();const t=e.sdS(10);e.Y8G("canvas",t)}}function Po(i,s){1&i&&e.nrm(0,"app-events")}function Ro(i,s){1&i&&e.nrm(0,"app-scripts")}let en=(()=>{class i{constructor(t,n,o,r,a,l){this.title=t,this.rs=n,this.msg=o,this.router=r,this.route=a,this.cs=l,this.id="",this.project=function le(){return{id:"",name:"\u7ec4\u6001\u5de5\u7a0b",pages:[At()]}}(),this.index=0,this.scale=1,t.setTitle(this.project.name)}ngOnInit(){this.route.snapshot.paramMap.has("id")&&(this.id=this.route.snapshot.paramMap.get("id"),this.rs.get(`api/project/${this.id}`).subscribe(t=>{this.project=t.data,this.title.setTitle(this.project.name),this.page=this.project.pages[0]}))}handleSave(){this.project.pages[this.index].content=this.renderer.graph.toJSON(),this.rs.post(this.id?`api/project/${this.id}`:"api/project/create",this.project).subscribe(n=>{this.router.navigateByUrl("/admin/project")})}handlePageChange(t){this.project.pages[this.index].content=this.renderer.graph.toJSON(),this.index=t,this.page=this.project.pages[this.index]}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(Ot.hE),e.rXU(gt.By),e.rXU(ft.xh),e.rXU(rt.Ix),e.rXU(rt.nX),e.rXU(it.b))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["app-editor"]],viewQuery:function(n,o){if(1&n&&e.GBs(To,5),2&n){let r;e.mGM(r=e.lsd())&&(o.renderer=r.first)}},decls:15,vars:19,consts:[["canvas",""],[3,"onSave","scaleChange","graph","project","scale"],[1,"body"],[3,"width"],[3,"project","graph","onPageChange",4,"sideBarItem"],[3,"canvas",4,"sideBarItem"],[4,"sideBarItem"],[1,"content"],[3,"page"],[3,"width","right"],[3,"onPageChange","project","graph"],[3,"canvas"]],template:function(n,o){if(1&n){const r=e.RV6();e.j41(0,"app-toolbar",1),e.bIt("onSave",function(){return e.eBV(r),e.Njj(o.handleSave())}),e.mxI("scaleChange",function(l){return e.eBV(r),e.DH7(o.scale,l)||(o.scale=l),e.Njj(l)}),e.k0s(),e.j41(1,"div",2)(2,"app-side-bar",3),e.DNE(3,Ao,1,2,"app-pages",4)(4,Eo,1,1,"app-widgets",5)(5,Io,1,1,"app-components",5)(6,No,1,1,"app-galleries",5)(7,Do,1,0,"app-sources",6),e.k0s(),e.j41(8,"div",7),e.nrm(9,"app-canvas",8,0),e.k0s(),e.j41(11,"app-side-bar",9),e.DNE(12,Mo,1,1,"app-props",5)(13,Po,1,0,"app-events",6)(14,Ro,1,0,"app-scripts",6),e.k0s()()}if(2&n){const r=e.sdS(10);e.Y8G("graph",r.graph)("project",o.project),e.R50("scale",o.scale),e.R7$(2),e.Y8G("width",300),e.R7$(),e.Y8G("sideBarItem","\u9875\u9762"),e.R7$(),e.Y8G("sideBarItem","\u63a7\u4ef6"),e.R7$(),e.Y8G("sideBarItem","\u7ec4\u4ef6"),e.R7$(),e.Y8G("sideBarItem","\u56fe\u5143"),e.R7$(),e.Y8G("sideBarItem","\u6570\u636e\u6e90"),e.R7$(2),e.xc7("width",o.project.pages[o.index].width*o.scale+"px")("height",o.project.pages[o.index].height*o.scale+"px"),e.Y8G("page",o.project.pages[o.index]),e.R7$(2),e.Y8G("width",400)("right",!0),e.R7$(),e.Y8G("sideBarItem","\u5c5e\u6027"),e.R7$(),e.Y8G("sideBarItem","\u4e8b\u4ef6"),e.R7$(),e.Y8G("sideBarItem","\u811a\u672c")}},dependencies:[jt,P,ot,R,q,Ct,Ie,Pe,oi,hi,ko,Dn],styles:["[_nghost-%COMP%]{height:100%;min-width:600px;overflow:hidden;display:flex;flex-direction:column;letter-spacing:.1em;font-size:12px}.body[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}.body[_ngcontent-%COMP%]   .splitter[_ngcontent-%COMP%]{width:8px;background-color:#c9c9c9;cursor:col-resize}.body[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex:1;height:100%;position:relative;padding:10px;background-color:#f0f0f0;overflow:auto}"]})}return i})();const Bo=[{path:"",component:en},{path:":id",component:en}];let Oo=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[rt.iI.forChild(Bo),rt.iI]})}return i})();var O=m(8167);class _t{r;g;b;a;constructor(s,t,n,o){this.r=s,this.g=t,this.b=n,this.a=o}}class we{h;s;v;a;constructor(s,t,n,o){this.h=s,this.s=t,this.v=n,this.a=o}}class Mt{h;s;l;a;constructor(s,t,n,o){this.h=s,this.s=t,this.l=n,this.a=o}}class ee{c;m;y;k;a;constructor(s,t,n,o,r=1){this.c=s,this.m=t,this.y=n,this.k=o,this.a=r}}let es=(()=>{class i{active=null;setActive(t){this.active&&this.active!==t&&"inline"!==this.active.cpDialogDisplay&&this.active.closeDialog(),this.active=t}hsva2hsla(t){const n=t.h,o=t.s,r=t.v,a=t.a;if(0===r)return new Mt(n,0,0,a);if(0===o&&1===r)return new Mt(n,1,1,a);{const l=r*(2-o)/2;return new Mt(n,r*o/(1-Math.abs(2*l-1)),l,a)}}hsla2hsva(t){const n=Math.min(t.h,1),o=Math.min(t.s,1),r=Math.min(t.l,1),a=Math.min(t.a,1);if(0===r)return new we(n,0,0,a);{const l=r+o*(1-Math.abs(2*r-1))/2;return new we(n,2*(l-r)/l,l,a)}}hsvaToRgba(t){let n,o,r;const a=t.h,l=t.s,d=t.v,p=t.a,h=Math.floor(6*a),u=6*a-h,f=d*(1-l),v=d*(1-u*l),w=d*(1-(1-u)*l);switch(h%6){case 0:n=d,o=w,r=f;break;case 1:n=v,o=d,r=f;break;case 2:n=f,o=d,r=w;break;case 3:n=f,o=v,r=d;break;case 4:n=w,o=f,r=d;break;case 5:n=d,o=f,r=v;break;default:n=0,o=0,r=0}return new _t(n,o,r,p)}cmykToRgb(t){return new _t((1-t.c)*(1-t.k),(1-t.m)*(1-t.k),(1-t.y)*(1-t.k),t.a)}rgbaToCmyk(t){const n=1-Math.max(t.r,t.g,t.b);return 1===n?new ee(0,0,0,1,t.a):new ee((1-t.r-n)/(1-n),(1-t.g-n)/(1-n),(1-t.b-n)/(1-n),n,t.a)}rgbaToHsva(t){let n,o;const r=Math.min(t.r,1),a=Math.min(t.g,1),l=Math.min(t.b,1),d=Math.min(t.a,1),p=Math.max(r,a,l),h=Math.min(r,a,l),u=p,f=p-h;if(o=0===p?0:f/p,p===h)n=0;else{switch(p){case r:n=(a-l)/f+(a<l?6:0);break;case a:n=(l-r)/f+2;break;case l:n=(r-a)/f+4;break;default:n=0}n/=6}return new we(n,o,u,d)}rgbaToHex(t,n){let o="#"+(16777216|t.r<<16|t.g<<8|t.b).toString(16).substr(1);return n&&(o+=(256|Math.round(255*t.a)).toString(16).substr(1)),o}normalizeCMYK(t){return new ee(t.c/100,t.m/100,t.y/100,t.k/100,t.a)}denormalizeCMYK(t){return new ee(Math.floor(100*t.c),Math.floor(100*t.m),Math.floor(100*t.y),Math.floor(100*t.k),t.a)}denormalizeRGBA(t){return new _t(Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b),t.a)}stringToHsva(t="",n=!1){let o=null;t=(t||"").toLowerCase();const r=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new _t(parseInt(a[2],10)/255,parseInt(a[3],10)/255,parseInt(a[4],10)/255,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return new Mt(parseInt(a[2],10)/360,parseInt(a[3],10)/100,parseInt(a[4],10)/100,isNaN(parseFloat(a[5]))?1:parseFloat(a[5]))}}];r.push(n?{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})?$/,parse:function(a){return new _t(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,parseInt(a[4]||"FF",16)/255)}}:{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(a){return new _t(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255,1)}}),r.push({re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(a){return new _t(parseInt(a[1]+a[1],16)/255,parseInt(a[2]+a[2],16)/255,parseInt(a[3]+a[3],16)/255,1)}});for(const a in r)if(r.hasOwnProperty(a)){const l=r[a],d=l.re.exec(t),p=d&&l.parse(d);if(p)return p instanceof _t?o=this.rgbaToHsva(p):p instanceof Mt&&(o=this.hsla2hsva(p)),o}return o}outputFormat(t,n,o){switch("auto"===n&&(n=t.a<1?"rgba":"hex"),n){case"hsla":const r=this.hsva2hsla(t),a=new Mt(Math.round(360*r.h),Math.round(100*r.s),Math.round(100*r.l),Math.round(100*r.a)/100);return t.a<1||"always"===o?"hsla("+a.h+","+a.s+"%,"+a.l+"%,"+a.a+")":"hsl("+a.h+","+a.s+"%,"+a.l+"%)";case"rgba":const l=this.denormalizeRGBA(this.hsvaToRgba(t));return t.a<1||"always"===o?"rgba("+l.r+","+l.g+","+l.b+","+Math.round(100*l.a)/100+")":"rgb("+l.r+","+l.g+","+l.b+")";default:const d="always"===o||"forced"===o;return this.rgbaToHex(this.denormalizeRGBA(this.hsvaToRgba(t)),d)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=e.jDH({token:i,factory:i.\u0275fac})}return i})();typeof window<"u"&&window;let nn=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=e.$C({type:i});static \u0275inj=e.G2t({providers:[es],imports:[T.MD]})}return i})();const ns=["*"],is=["nz-sider-trigger",""];function os(i,s){}function ss(i,s){if(1&i&&e.DNE(0,os,0,0,"ng-template",2),2&i){const t=e.XpG(),n=e.sdS(5);e.Y8G("ngTemplateOutlet",t.nzZeroTrigger||n)}}function rs(i,s){}function as(i,s){if(1&i&&e.DNE(0,rs,0,0,"ng-template",2),2&i){const t=e.XpG(),n=e.sdS(3);e.Y8G("ngTemplateOutlet",t.nzTrigger||n)}}function ls(i,s){if(1&i&&e.nrm(0,"span",3),2&i){const t=e.XpG(2);e.Y8G("nzType",t.nzCollapsed?"left":"right")}}function cs(i,s){if(1&i&&e.nrm(0,"span",3),2&i){const t=e.XpG(2);e.Y8G("nzType",t.nzCollapsed?"right":"left")}}function ds(i,s){if(1&i&&e.DNE(0,ls,1,1,"span",3)(1,cs,1,1),2&i){const t=e.XpG();e.vxM(0,t.nzReverseArrow?0:1)}}function ps(i,s){1&i&&e.nrm(0,"span",4)}function hs(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",2),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.setCollapsed(!o.nzCollapsed))}),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("matchBreakPoint",t.matchBreakPoint)("nzCollapsedWidth",t.nzCollapsedWidth)("nzCollapsed",t.nzCollapsed)("nzBreakpoint",t.nzBreakpoint)("nzReverseArrow",t.nzReverseArrow)("nzTrigger",t.nzTrigger)("nzZeroTrigger",t.nzZeroTrigger)("siderWidth",t.widthSetting)}}let on=(()=>{class i{constructor(){this.nzCollapsed=!1,this.nzReverseArrow=!1,this.nzZeroTrigger=null,this.nzTrigger=void 0,this.matchBreakPoint=!1,this.nzCollapsedWidth=null,this.siderWidth=null,this.nzBreakpoint=null,this.isZeroTrigger=!1,this.isNormalTrigger=!1}updateTriggerType(){this.isZeroTrigger=0===this.nzCollapsedWidth&&(this.nzBreakpoint&&this.matchBreakPoint||!this.nzBreakpoint),this.isNormalTrigger=0!==this.nzCollapsedWidth}ngOnInit(){this.updateTriggerType()}ngOnChanges(){this.updateTriggerType()}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["","nz-sider-trigger",""]],hostVars:10,hostBindings:function(n,o){2&n&&(e.xc7("width",o.isNormalTrigger?o.siderWidth:null),e.AVh("ant-layout-sider-trigger",o.isNormalTrigger)("ant-layout-sider-zero-width-trigger",o.isZeroTrigger)("ant-layout-sider-zero-width-trigger-right",o.isZeroTrigger&&o.nzReverseArrow)("ant-layout-sider-zero-width-trigger-left",o.isZeroTrigger&&!o.nzReverseArrow))},inputs:{nzCollapsed:"nzCollapsed",nzReverseArrow:"nzReverseArrow",nzZeroTrigger:"nzZeroTrigger",nzTrigger:"nzTrigger",matchBreakPoint:"matchBreakPoint",nzCollapsedWidth:"nzCollapsedWidth",siderWidth:"siderWidth",nzBreakpoint:"nzBreakpoint"},exportAs:["nzSiderTrigger"],standalone:!0,features:[e.OA$,e.aNF],attrs:is,decls:6,vars:2,consts:[["defaultTrigger",""],["defaultZeroTrigger",""],[3,"ngTemplateOutlet"],["nz-icon","",3,"nzType"],["nz-icon","","nzType","bars"]],template:function(n,o){1&n&&e.DNE(0,ss,1,1,null,2)(1,as,1,1,null,2)(2,ds,2,1,"ng-template",null,0,e.C5r)(4,ps,1,0,"ng-template",null,1,e.C5r),2&n&&(e.vxM(0,o.isZeroTrigger?0:-1),e.R7$(),e.vxM(1,o.isNormalTrigger?1:-1))},dependencies:[T.T3,G.Y3,G.Dn],encapsulation:2,changeDetection:0})}return i})(),us=(()=>{class i{updateStyleMap(){this.widthSetting=this.nzCollapsed?`${this.nzCollapsedWidth}px`:(0,D.j3)(this.nzWidth),this.flexSetting=`0 0 ${this.widthSetting}`,this.cdr.markForCheck()}updateMenuInlineCollapsed(){this.nzMenuDirective&&"inline"===this.nzMenuDirective.nzMode&&0!==this.nzCollapsedWidth&&this.nzMenuDirective.setInlineCollapsed(this.nzCollapsed)}setCollapsed(t){t!==this.nzCollapsed&&(this.nzCollapsed=t,this.nzCollapsedChange.emit(t),this.updateMenuInlineCollapsed(),this.updateStyleMap(),this.cdr.markForCheck())}constructor(t,n,o){this.platform=t,this.cdr=n,this.breakpointService=o,this.destroy$=new pt.B,this.nzMenuDirective=null,this.nzCollapsedChange=new e.bkB,this.nzWidth=200,this.nzTheme="dark",this.nzCollapsedWidth=80,this.nzBreakpoint=null,this.nzZeroTrigger=null,this.nzTrigger=void 0,this.nzReverseArrow=!1,this.nzCollapsible=!1,this.nzCollapsed=!1,this.matchBreakPoint=!1,this.flexSetting=null,this.widthSetting=null}ngOnInit(){this.updateStyleMap(),this.platform.isBrowser&&this.breakpointService.subscribe(et.yY,!0).pipe((0,H.Q)(this.destroy$)).subscribe(t=>{const n=this.nzBreakpoint;n&&(0,D.ij)().subscribe(()=>{this.matchBreakPoint=!t[n],this.setCollapsed(this.matchBreakPoint),this.cdr.markForCheck()})})}ngOnChanges(t){const{nzCollapsed:n,nzCollapsedWidth:o,nzWidth:r}=t;(n||o||r)&&this.updateStyleMap(),n&&this.updateMenuInlineCollapsed()}ngAfterContentInit(){this.updateMenuInlineCollapsed()}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(He.OD),e.rXU(e.gRc),e.rXU(et.jp))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-sider"]],contentQueries:function(n,o,r){if(1&n&&e.wni(r,ht.jS,5),2&n){let a;e.mGM(a=e.lsd())&&(o.nzMenuDirective=a.first)}},hostAttrs:[1,"ant-layout-sider"],hostVars:18,hostBindings:function(n,o){2&n&&(e.xc7("flex",o.flexSetting)("max-width",o.widthSetting)("min-width",o.widthSetting)("width",o.widthSetting),e.AVh("ant-layout-sider-zero-width",o.nzCollapsed&&0===o.nzCollapsedWidth)("ant-layout-sider-light","light"===o.nzTheme)("ant-layout-sider-dark","dark"===o.nzTheme)("ant-layout-sider-collapsed",o.nzCollapsed)("ant-layout-sider-has-trigger",o.nzCollapsible&&null!==o.nzTrigger))},inputs:{nzWidth:"nzWidth",nzTheme:"nzTheme",nzCollapsedWidth:"nzCollapsedWidth",nzBreakpoint:"nzBreakpoint",nzZeroTrigger:"nzZeroTrigger",nzTrigger:"nzTrigger",nzReverseArrow:"nzReverseArrow",nzCollapsible:"nzCollapsible",nzCollapsed:"nzCollapsed"},outputs:{nzCollapsedChange:"nzCollapsedChange"},exportAs:["nzSider"],standalone:!0,features:[e.OA$,e.aNF],ngContentSelectors:ns,decls:3,vars:1,consts:[[1,"ant-layout-sider-children"],["nz-sider-trigger","",3,"matchBreakPoint","nzCollapsedWidth","nzCollapsed","nzBreakpoint","nzReverseArrow","nzTrigger","nzZeroTrigger","siderWidth"],["nz-sider-trigger","",3,"click","matchBreakPoint","nzCollapsedWidth","nzCollapsed","nzBreakpoint","nzReverseArrow","nzTrigger","nzZeroTrigger","siderWidth"]],template:function(n,o){1&n&&(e.NAR(),e.j41(0,"div",0),e.SdG(1),e.k0s(),e.DNE(2,hs,1,8,"div",1)),2&n&&(e.R7$(2),e.vxM(2,o.nzCollapsible&&null!==o.nzTrigger?2:-1))},dependencies:[on],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzReverseArrow",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzCollapsible",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzCollapsed",void 0),i})(),sn=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[us,on]})}return i})();var rn=m(7685),an=m(4500),Se=m(851),ln=m(4085),kt=m(7336),ne=m(8359),gs=m(536),fs=m(5007),ms=m(3798),vs=m(1594),Cs=m(1986),bs=m(494),cn=m(5979),dn=m(1265);function _s(i,s){if(1&i&&(e.qex(0),e.nrm(1,"span",1),e.bVm()),2&i){const t=s.$implicit;e.R7$(),e.Y8G("nzType",t)}}const zs=()=>({minWidth:"46px"}),xs=()=>({visible:!1});function ys(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.tab.label," ")}}function ws(i,s){if(1&i){const t=e.RV6();e.j41(0,"li",8),e.bIt("click",function(){const o=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.onSelect(o))})("contextmenu",function(o){const r=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.onContextmenu(r,o))}),e.DNE(1,ys,2,1,"ng-container",9),e.k0s()}if(2&i){const t=s.$implicit;e.AVh("ant-tabs-dropdown-menu-item-disabled",t.disabled),e.Y8G("nzSelected",t.active)("nzDisabled",t.disabled),e.R7$(),e.Y8G("nzStringTemplateOutlet",t.tab.label)("nzStringTemplateOutletContext",e.lJ4(6,xs))}}function Ss(i,s){if(1&i&&(e.j41(0,"ul",6),e.DNE(1,ws,2,7,"li",7),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.items)}}function ks(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addClicked.emit())}),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("addIcon",t.addIcon)}}const Ts=["navWarp"],As=["navList"],Es=["*"];function Is(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addClicked.emit())}),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("addIcon",t.addIcon),e.BMQ("tabindex",-1)}}function Ns(i,s){}function Ds(i,s){if(1&i&&(e.j41(0,"div",9),e.DNE(1,Ns,0,0,"ng-template",10),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngTemplateOutlet",t.extraTemplate)}}const Ms=["nz-tab-body",""];function Ps(i,s){}function Rs(i,s){if(1&i&&(e.qex(0),e.DNE(1,Ps,0,0,"ng-template",1),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngTemplateOutlet",t.content)}}function Bs(i,s){if(1&i&&(e.qex(0),e.nrm(1,"span",1),e.bVm()),2&i){const t=s.$implicit;e.R7$(),e.Y8G("nzType",t)}}const Os=["contentTemplate"],Vs=[[["","nz-tab-link",""]],"*"],Fs=["[nz-tab-link]","*"];function Gs(i,s){1&i&&e.SdG(0)}function js(i,s){1&i&&e.SdG(0,1)}const Ls=()=>({visible:!0});function Ys(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.label)}}function Xs(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(o){e.eBV(t);const r=e.XpG().index,a=e.XpG(2);return e.Njj(a.onClose(r,o))}),e.k0s()}if(2&i){const t=e.XpG().$implicit;e.Y8G("closeIcon",t.nzCloseIcon)}}function Hs(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",6),e.bIt("click",function(o){const r=e.eBV(t),a=r.$implicit,l=r.index,d=e.XpG(2);return e.Njj(d.clickNavItem(a,l,o))})("contextmenu",function(o){const r=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.contextmenuNavItem(r,o))}),e.j41(1,"button",7),e.DNE(2,Ys,2,1,"ng-container",8)(3,Xs,1,1,"button",9),e.k0s()()}if(2&i){const t=s.$implicit,n=s.index,o=e.XpG(2);e.xc7("margin-right","horizontal"===o.position?o.nzTabBarGutter:null,"px")("margin-bottom","vertical"===o.position?o.nzTabBarGutter:null,"px"),e.AVh("ant-tabs-tab-active",o.nzSelectedIndex===n)("ant-tabs-tab-disabled",t.nzDisabled),e.R7$(),e.Y8G("id",o.getTabContentId(n))("disabled",t.nzDisabled)("tab",t)("active",o.nzSelectedIndex===n),e.BMQ("tabIndex",o.getTabIndex(t,n))("aria-disabled",t.nzDisabled)("aria-selected",o.nzSelectedIndex===n&&!o.nzHideAll)("aria-controls",o.getTabContentId(n)),e.R7$(),e.Y8G("nzStringTemplateOutlet",t.label)("nzStringTemplateOutletContext",e.lJ4(19,Ls)),e.R7$(),e.Y8G("ngIf",t.nzClosable&&o.closable&&!t.nzDisabled)}}function Us(i,s){if(1&i){const t=e.RV6();e.j41(0,"nz-tabs-nav",4),e.bIt("tabScroll",function(o){e.eBV(t);const r=e.XpG();return e.Njj(r.nzTabListScroll.emit(o))})("selectFocusedIndex",function(o){e.eBV(t);const r=e.XpG();return e.Njj(r.setSelectedIndex(o))})("addClicked",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onAdd())}),e.DNE(1,Hs,4,20,"div",5),e.k0s()}if(2&i){const t=e.XpG();e.Y8G("ngStyle",t.nzTabBarStyle)("selectedIndex",t.nzSelectedIndex||0)("inkBarAnimated",t.inkBarAnimated)("addable",t.addable)("addIcon",t.nzAddIcon)("hideBar",t.nzHideAll)("position",t.position)("extraTemplate",t.nzTabBarExtraContent),e.R7$(),e.Y8G("ngForOf",t.tabs)}}function Ws(i,s){if(1&i&&e.nrm(0,"div",11),2&i){const t=s.$implicit,n=s.index,o=e.XpG();e.Y8G("id",o.getTabContentId(n))("active",o.nzSelectedIndex===n&&!o.nzHideAll)("content",t.content)("forceRender",t.nzForceRender)("animated",o.tabPaneAnimated),e.BMQ("aria-labelledby",o.getTabContentId(n))}}let Ht=(()=>{class i{constructor(t){this.elementRef=t,this.addIcon="plus",this.element=this.elementRef.nativeElement}getElementWidth(){return this.element?.offsetWidth||0}getElementHeight(){return this.element?.offsetHeight||0}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.aKT))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tab-add-button"],["button","nz-tab-add-button",""]],hostAttrs:["aria-label","Add tab","type","button",1,"ant-tabs-nav-add"],inputs:{addIcon:"addIcon"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[4,"nzStringTemplateOutlet"],["nz-icon","","nzTheme","outline",3,"nzType"]],template:function(n,o){1&n&&e.DNE(0,_s,2,1,"ng-container",0),2&n&&e.Y8G("nzStringTemplateOutlet",o.addIcon)},dependencies:[F.C,F.m,G.Y3,G.Dn],encapsulation:2})}return i})(),ke=(()=>{class i{get _animated(){return"NoopAnimations"!==this.animationMode&&this.animated}constructor(t,n,o){this.elementRef=t,this.ngZone=n,this.animationMode=o,this.position="horizontal",this.animated=!0}alignToElement(t){this.ngZone.runOutsideAngular(()=>{(0,an.j)(()=>this.setStyles(t))})}setStyles(t){const n=this.elementRef.nativeElement;"horizontal"===this.position?(n.style.top="",n.style.height="",n.style.left=this.getLeftPosition(t),n.style.width=this.getElementWidth(t)):(n.style.left="",n.style.width="",n.style.top=this.getTopPosition(t),n.style.height=this.getElementHeight(t))}getLeftPosition(t){return t?`${t.offsetLeft||0}px`:"0"}getElementWidth(t){return t?`${t.offsetWidth||0}px`:"0"}getTopPosition(t){return t?`${t.offsetTop||0}px`:"0"}getElementHeight(t){return t?`${t.offsetHeight||0}px`:"0"}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.aKT),e.rXU(e.SKi),e.rXU(e.bc$,8))};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["nz-tabs-ink-bar"],["","nz-tabs-ink-bar",""]],hostAttrs:[1,"ant-tabs-ink-bar"],hostVars:2,hostBindings:function(n,o){2&n&&e.AVh("ant-tabs-ink-bar-animated",o._animated)},inputs:{position:"position",animated:"animated"},standalone:!0})}return i})(),Te=(()=>{class i{constructor(t){this.elementRef=t,this.disabled=!1,this.active=!1,this.el=t.nativeElement,this.parentElement=this.el.parentElement}focus(){this.el.focus()}get width(){return this.parentElement.offsetWidth}get height(){return this.parentElement.offsetHeight}get left(){return this.parentElement.offsetLeft}get top(){return this.parentElement.offsetTop}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.aKT))};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["","nzTabNavItem",""]],inputs:{disabled:"disabled",tab:"tab",active:"active"},standalone:!0})}return i})(),ie=(()=>{class i{constructor(t,n){this.cdr=t,this.elementRef=n,this.items=[],this.addable=!1,this.addIcon="plus",this.addClicked=new e.bkB,this.selected=new e.bkB,this.menuOpened=!1,this.element=this.elementRef.nativeElement}onSelect(t){t.disabled||(t.tab.nzClick.emit(),this.selected.emit(t))}onContextmenu(t,n){t.disabled||t.tab.nzContextmenu.emit(n)}showItems(){clearTimeout(this.closeAnimationWaitTimeoutId),this.menuOpened=!0,this.cdr.markForCheck()}menuVisChange(t){t||(this.closeAnimationWaitTimeoutId=setTimeout(()=>{this.menuOpened=!1,this.cdr.markForCheck()},150))}getElementWidth(){return this.element?.offsetWidth||0}getElementHeight(){return this.element?.offsetHeight||0}ngOnDestroy(){clearTimeout(this.closeAnimationWaitTimeoutId)}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.gRc),e.rXU(e.aKT))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tab-nav-operation"]],hostAttrs:[1,"ant-tabs-nav-operations"],hostVars:2,hostBindings:function(n,o){2&n&&e.AVh("ant-tabs-nav-operations-hidden",0===o.items.length)},inputs:{items:"items",addable:"addable",addIcon:"addIcon"},outputs:{addClicked:"addClicked",selected:"selected"},exportAs:["nzTabNavOperation"],standalone:!0,features:[e.aNF],decls:7,vars:6,consts:[["dropdownTrigger","nzDropdown"],["menu","nzDropdownMenu"],["nz-dropdown","","type","button","tabindex","-1","aria-hidden","true","nzOverlayClassName","nz-tabs-dropdown",1,"ant-tabs-nav-more",3,"nzVisibleChange","mouseenter","nzDropdownMenu","nzOverlayStyle","nzMatchWidthElement"],["nz-icon","","nzType","ellipsis"],["nz-menu","",4,"ngIf"],["nz-tab-add-button","",3,"addIcon","click",4,"ngIf"],["nz-menu",""],["nz-menu-item","","class","ant-tabs-dropdown-menu-item",3,"ant-tabs-dropdown-menu-item-disabled","nzSelected","nzDisabled","click","contextmenu",4,"ngFor","ngForOf"],["nz-menu-item","",1,"ant-tabs-dropdown-menu-item",3,"click","contextmenu","nzSelected","nzDisabled"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],["nz-tab-add-button","",3,"click","addIcon"]],template:function(n,o){if(1&n){const r=e.RV6();e.j41(0,"button",2,0),e.bIt("nzVisibleChange",function(l){return e.eBV(r),e.Njj(o.menuVisChange(l))})("mouseenter",function(){return e.eBV(r),e.Njj(o.showItems())}),e.nrm(2,"span",3),e.k0s(),e.j41(3,"nz-dropdown-menu",null,1),e.DNE(5,Ss,2,1,"ul",4),e.k0s(),e.DNE(6,ks,1,1,"button",5)}if(2&n){const r=e.sdS(4);e.Y8G("nzDropdownMenu",r)("nzOverlayStyle",e.lJ4(5,zs))("nzMatchWidthElement",null),e.R7$(5),e.Y8G("ngIf",o.menuOpened),e.R7$(),e.Y8G("ngIf",o.addable)}},dependencies:[G.Y3,G.Dn,T.bT,T.Sq,F.C,F.m,Ht,ut.wQ,ht.GP,ht.jS,ht.CU,ut.j3],encapsulation:2,changeDetection:0})}return i})();const hn=.995**20;let un=(()=>{class i{constructor(t,n){this.ngZone=t,this.elementRef=n,this.lastWheelDirection=null,this.lastWheelTimestamp=0,this.lastTimestamp=0,this.lastTimeDiff=0,this.lastMixedWheel=0,this.lastWheelPrevent=!1,this.touchPosition=null,this.lastOffset=null,this.motion=-1,this.unsubscribe=()=>{},this.offsetChange=new e.bkB,this.tabScroll=new e.bkB,this.onTouchEnd=o=>{if(!this.touchPosition)return;const r=this.lastOffset,a=this.lastTimeDiff;if(this.lastOffset=this.touchPosition=null,r){const l=r.x/a,d=r.y/a,p=Math.abs(l),h=Math.abs(d);if(Math.max(p,h)<.1)return;let u=l,f=d;this.motion=window.setInterval(()=>{Math.abs(u)<.01&&Math.abs(f)<.01?window.clearInterval(this.motion):(u*=hn,f*=hn,this.onOffset(20*u,20*f,o))},20)}},this.onTouchMove=o=>{if(!this.touchPosition)return;o.preventDefault();const{screenX:r,screenY:a}=o.touches[0],l=r-this.touchPosition.x,d=a-this.touchPosition.y;this.onOffset(l,d,o);const p=Date.now();this.lastTimeDiff=p-this.lastTimestamp,this.lastTimestamp=p,this.lastOffset={x:l,y:d},this.touchPosition={x:r,y:a}},this.onTouchStart=o=>{const{screenX:r,screenY:a}=o.touches[0];this.touchPosition={x:r,y:a},window.clearInterval(this.motion)},this.onWheel=o=>{const{deltaX:r,deltaY:a}=o;let l;const d=Math.abs(r),p=Math.abs(a);d===p?l="x"===this.lastWheelDirection?r:a:d>p?(l=r,this.lastWheelDirection="x"):(l=a,this.lastWheelDirection="y");const h=Date.now(),u=Math.abs(l);(h-this.lastWheelTimestamp>100||u-this.lastMixedWheel>10)&&(this.lastWheelPrevent=!1),this.onOffset(-l,-l,o),(o.defaultPrevented||this.lastWheelPrevent)&&(this.lastWheelPrevent=!0),this.lastWheelTimestamp=h,this.lastMixedWheel=u}}ngOnInit(){this.unsubscribe=this.ngZone.runOutsideAngular(()=>{const t=this.elementRef.nativeElement,n=(0,at.R)(t,"wheel"),o=(0,at.R)(t,"touchstart"),r=(0,at.R)(t,"touchmove"),a=(0,at.R)(t,"touchend"),l=new ne.yU;return l.add(this.subscribeWrap("wheel",n,this.onWheel)),l.add(this.subscribeWrap("touchstart",o,this.onTouchStart)),l.add(this.subscribeWrap("touchmove",r,this.onTouchMove)),l.add(this.subscribeWrap("touchend",a,this.onTouchEnd)),()=>{l.unsubscribe()}})}subscribeWrap(t,n,o){return n.subscribe(r=>{this.tabScroll.emit({type:t,event:r}),r.defaultPrevented||o(r)})}onOffset(t,n,o){this.ngZone.run(()=>{this.offsetChange.emit({x:t,y:n,event:o})})}ngOnDestroy(){this.unsubscribe()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.SKi),e.rXU(e.aKT))};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["","nzTabScrollList",""]],outputs:{offsetChange:"offsetChange",tabScroll:"tabScroll"},standalone:!0})}return i})();const $s=typeof requestAnimationFrame<"u"?gs.X:fs.$;let se=(()=>{class i{get selectedIndex(){return this._selectedIndex}set selectedIndex(t){const n=(0,ln.OE)(t);this._selectedIndex!==n&&(this._selectedIndex=t,this.selectedIndexChanged=!0,this.keyManager&&this.keyManager.updateActiveItem(t))}get focusIndex(){return this.keyManager?this.keyManager.activeItemIndex:0}set focusIndex(t){!this.isValidIndex(t)||this.focusIndex===t||!this.keyManager||this.keyManager.setActiveItem(t)}get showAddButton(){return 0===this.hiddenItems.length&&this.addable}constructor(t,n,o,r,a){this.cdr=t,this.ngZone=n,this.viewportRuler=o,this.nzResizeObserver=r,this.dir=a,this.indexFocused=new e.bkB,this.selectFocusedIndex=new e.bkB,this.addClicked=new e.bkB,this.tabScroll=new e.bkB,this.position="horizontal",this.addable=!1,this.hideBar=!1,this.addIcon="plus",this.inkBarAnimated=!0,this.translate=null,this.transformX=0,this.transformY=0,this.pingLeft=!1,this.pingRight=!1,this.pingTop=!1,this.pingBottom=!1,this.hiddenItems=[],this.destroy$=new pt.B,this._selectedIndex=0,this.wrapperWidth=0,this.wrapperHeight=0,this.scrollListWidth=0,this.scrollListHeight=0,this.operationWidth=0,this.operationHeight=0,this.addButtonWidth=0,this.addButtonHeight=0,this.selectedIndexChanged=!1}ngAfterViewInit(){const t=this.dir?this.dir.change.asObservable():(0,me.of)(null),n=this.viewportRuler.change(150),o=()=>{this.updateScrollListPosition(),this.alignInkBarToSelectedTab()};this.keyManager=new Se.Bu(this.items).withHorizontalOrientation(this.getLayoutDirection()).withWrap(),this.keyManager.updateActiveItem(this.selectedIndex),(0,an.j)(o),(0,Zt.h)(this.nzResizeObserver.observe(this.navWarpRef),this.nzResizeObserver.observe(this.navListRef)).pipe((0,H.Q)(this.destroy$),(0,ms.Z)(16,$s)).subscribe(()=>{o()}),(0,Zt.h)(t,n,this.items.changes).pipe((0,H.Q)(this.destroy$)).subscribe(()=>{Promise.resolve().then(o),this.keyManager.withHorizontalOrientation(this.getLayoutDirection())}),this.keyManager.change.pipe((0,H.Q)(this.destroy$)).subscribe(r=>{this.indexFocused.emit(r),this.setTabFocus(r),this.scrollToTab(this.keyManager.activeItem)})}ngAfterContentChecked(){this.selectedIndexChanged&&(this.updateScrollListPosition(),this.alignInkBarToSelectedTab(),this.selectedIndexChanged=!1,this.cdr.markForCheck())}ngOnDestroy(){clearTimeout(this.lockAnimationTimeoutId),clearTimeout(this.cssTransformTimeWaitingId),this.destroy$.next(),this.destroy$.complete()}onSelectedFromMenu(t){const n=this.items.toArray().findIndex(o=>o===t);-1!==n&&(this.keyManager.updateActiveItem(n),this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this.scrollToTab(t)))}onOffsetChange(t){if("horizontal"===this.position){if(!this.lockAnimationTimeoutId&&(this.transformX>=0&&t.x>0||this.transformX<=this.wrapperWidth-this.scrollListWidth&&t.x<0))return;t.event.preventDefault(),this.transformX=this.clampTransformX(this.transformX+t.x),this.setTransform(this.transformX,0)}else{if(!this.lockAnimationTimeoutId&&(this.transformY>=0&&t.y>0||this.transformY<=this.wrapperHeight-this.scrollListHeight&&t.y<0))return;t.event.preventDefault(),this.transformY=this.clampTransformY(this.transformY+t.y),this.setTransform(0,this.transformY)}this.lockAnimation(),this.setVisibleRange(),this.setPingStatus()}handleKeydown(t){const n=this.navWarpRef.nativeElement.contains(t.target);if(!(0,kt.rp)(t)&&n)switch(t.keyCode){case kt.UQ:case kt.i7:case kt.LE:case kt.n6:this.lockAnimation(),this.keyManager.onKeydown(t);break;case kt.Fm:case kt.t6:this.focusIndex!==this.selectedIndex&&this.selectFocusedIndex.emit(this.focusIndex);break;default:this.keyManager.onKeydown(t)}}isValidIndex(t){if(!this.items)return!0;const n=this.items?this.items.toArray()[t]:null;return!!n&&!n.disabled}scrollToTab(t){if(!this.items.find(o=>o===t))return;const n=this.items.toArray();if("horizontal"===this.position){let o=this.transformX;if("rtl"===this.getLayoutDirection()){const r=n[0].left+n[0].width-t.left-t.width;r<this.transformX?o=r:r+t.width>this.transformX+this.wrapperWidth&&(o=r+t.width-this.wrapperWidth)}else t.left<-this.transformX?o=-t.left:t.left+t.width>-this.transformX+this.wrapperWidth&&(o=-(t.left+t.width-this.wrapperWidth));this.transformX=o,this.transformY=0,this.setTransform(o,0)}else{let o=this.transformY;t.top<-this.transformY?o=-t.top:t.top+t.height>-this.transformY+this.wrapperHeight&&(o=-(t.top+t.height-this.wrapperHeight)),this.transformY=o,this.transformX=0,this.setTransform(0,o)}clearTimeout(this.cssTransformTimeWaitingId),this.cssTransformTimeWaitingId=setTimeout(()=>{this.setVisibleRange()},150)}lockAnimation(){this.lockAnimationTimeoutId||this.ngZone.runOutsideAngular(()=>{this.navListRef.nativeElement.style.transition="none",this.lockAnimationTimeoutId=setTimeout(()=>{this.navListRef.nativeElement.style.transition="",this.lockAnimationTimeoutId=void 0},150)})}setTransform(t,n){this.navListRef.nativeElement.style.transform=`translate(${t}px, ${n}px)`}clampTransformX(t){const n=this.wrapperWidth-this.scrollListWidth;return"rtl"===this.getLayoutDirection()?Math.max(Math.min(n,t),0):Math.min(Math.max(n,t),0)}clampTransformY(t){return Math.min(Math.max(this.wrapperHeight-this.scrollListHeight,t),0)}updateScrollListPosition(){this.resetSizes(),this.transformX=this.clampTransformX(this.transformX),this.transformY=this.clampTransformY(this.transformY),this.setVisibleRange(),this.setPingStatus(),this.keyManager&&(this.keyManager.updateActiveItem(this.keyManager.activeItemIndex),this.keyManager.activeItem&&this.scrollToTab(this.keyManager.activeItem))}resetSizes(){this.addButtonWidth=this.addBtnRef?this.addBtnRef.getElementWidth():0,this.addButtonHeight=this.addBtnRef?this.addBtnRef.getElementHeight():0,this.operationWidth=this.operationRef.getElementWidth(),this.operationHeight=this.operationRef.getElementHeight(),this.wrapperWidth=this.navWarpRef.nativeElement.offsetWidth||0,this.wrapperHeight=this.navWarpRef.nativeElement.offsetHeight||0,this.scrollListHeight=this.navListRef.nativeElement.offsetHeight||0,this.scrollListWidth=this.navListRef.nativeElement.offsetWidth||0}alignInkBarToSelectedTab(){const t=this.items&&this.items.length?this.items.toArray()[this.selectedIndex]:null,n=t?t.elementRef.nativeElement:null;n&&this.inkBar.alignToElement(n.parentElement)}setPingStatus(){const t={top:!1,right:!1,bottom:!1,left:!1},n=this.navWarpRef.nativeElement;"horizontal"===this.position?"rtl"===this.getLayoutDirection()?(t.right=this.transformX>0,t.left=this.transformX+this.wrapperWidth<this.scrollListWidth):(t.left=this.transformX<0,t.right=-this.transformX+this.wrapperWidth<this.scrollListWidth):(t.top=this.transformY<0,t.bottom=-this.transformY+this.wrapperHeight<this.scrollListHeight),Object.keys(t).forEach(o=>{const r=`ant-tabs-nav-wrap-ping-${o}`;t[o]?n.classList.add(r):n.classList.remove(r)})}setVisibleRange(){let t,n,o,r,a,l;const d=this.items.toArray(),p={width:0,height:0,left:0,top:0,right:0},h=k=>{let z;return z="right"===n?d[0].left+d[0].width-d[k].left-d[k].width:(d[k]||p)[n],z};"horizontal"===this.position?(t="width",r=this.wrapperWidth,a=this.scrollListWidth-(this.hiddenItems.length?this.operationWidth:0),l=this.addButtonWidth,o=Math.abs(this.transformX),"rtl"===this.getLayoutDirection()?(n="right",this.pingRight=this.transformX>0,this.pingLeft=this.transformX+this.wrapperWidth<this.scrollListWidth):(this.pingLeft=this.transformX<0,this.pingRight=-this.transformX+this.wrapperWidth<this.scrollListWidth,n="left")):(t="height",r=this.wrapperHeight,a=this.scrollListHeight-(this.hiddenItems.length?this.operationHeight:0),l=this.addButtonHeight,n="top",o=-this.transformY,this.pingTop=this.transformY<0,this.pingBottom=-this.transformY+this.wrapperHeight<this.scrollListHeight);let u=r;if(a+l>r&&(u=r-l),!d.length)return this.hiddenItems=[],void this.cdr.markForCheck();const f=d.length;let v=f;for(let k=0;k<f;k+=1)if(h(k)+(d[k]||p)[t]>o+u){v=k-1;break}let w=0;for(let k=f-1;k>=0;k-=1)if(h(k)<o){w=k+1;break}const b=d.slice(0,w),_=d.slice(v+1);this.hiddenItems=[...b,..._],this.cdr.markForCheck()}getLayoutDirection(){return this.dir&&"rtl"===this.dir.value?"rtl":"ltr"}setTabFocus(t){}ngOnChanges(t){const{position:n}=t;n&&!n.isFirstChange()&&(this.alignInkBarToSelectedTab(),this.lockAnimation(),this.updateScrollListPosition())}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.gRc),e.rXU(e.SKi),e.rXU(bs.Xj),e.rXU(cn.xH),e.rXU(mt.dS,8))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tabs-nav"]],contentQueries:function(n,o,r){if(1&n&&e.wni(r,Te,5),2&n){let a;e.mGM(a=e.lsd())&&(o.items=a)}},viewQuery:function(n,o){if(1&n&&(e.GBs(Ts,7),e.GBs(As,7),e.GBs(ie,7),e.GBs(Ht,5),e.GBs(ke,7)),2&n){let r;e.mGM(r=e.lsd())&&(o.navWarpRef=r.first),e.mGM(r=e.lsd())&&(o.navListRef=r.first),e.mGM(r=e.lsd())&&(o.operationRef=r.first),e.mGM(r=e.lsd())&&(o.addBtnRef=r.first),e.mGM(r=e.lsd())&&(o.inkBar=r.first)}},hostAttrs:[1,"ant-tabs-nav"],hostBindings:function(n,o){1&n&&e.bIt("keydown",function(a){return o.handleKeydown(a)})},inputs:{position:"position",addable:"addable",hideBar:"hideBar",addIcon:"addIcon",inkBarAnimated:"inkBarAnimated",extraTemplate:"extraTemplate",selectedIndex:"selectedIndex"},outputs:{indexFocused:"indexFocused",selectFocusedIndex:"selectFocusedIndex",addClicked:"addClicked",tabScroll:"tabScroll"},exportAs:["nzTabsNav"],standalone:!0,features:[e.OA$,e.aNF],ngContentSelectors:Es,decls:9,vars:16,consts:[["navWarp",""],["navList",""],[1,"ant-tabs-nav-wrap"],["nzTabScrollList","","role","tablist",1,"ant-tabs-nav-list",3,"offsetChange","tabScroll"],["role","tab","nz-tab-add-button","",3,"addIcon","click",4,"ngIf"],["nz-tabs-ink-bar","",3,"hidden","position","animated"],[3,"addClicked","selected","addIcon","addable","items"],["class","ant-tabs-extra-content",4,"ngIf"],["role","tab","nz-tab-add-button","",3,"click","addIcon"],[1,"ant-tabs-extra-content"],[3,"ngTemplateOutlet"]],template:function(n,o){if(1&n){const r=e.RV6();e.NAR(),e.j41(0,"div",2,0)(2,"div",3,1),e.bIt("offsetChange",function(l){return e.eBV(r),e.Njj(o.onOffsetChange(l))})("tabScroll",function(l){return e.eBV(r),e.Njj(o.tabScroll.emit(l))}),e.SdG(4),e.DNE(5,Is,1,2,"button",4),e.nrm(6,"div",5),e.k0s()(),e.j41(7,"nz-tab-nav-operation",6),e.bIt("addClicked",function(){return e.eBV(r),e.Njj(o.addClicked.emit())})("selected",function(l){return e.eBV(r),e.Njj(o.onSelectedFromMenu(l))}),e.k0s(),e.DNE(8,Ds,2,1,"div",7)}2&n&&(e.AVh("ant-tabs-nav-wrap-ping-left",o.pingLeft)("ant-tabs-nav-wrap-ping-right",o.pingRight)("ant-tabs-nav-wrap-ping-top",o.pingTop)("ant-tabs-nav-wrap-ping-bottom",o.pingBottom),e.R7$(5),e.Y8G("ngIf",o.showAddButton),e.R7$(),e.Y8G("hidden",o.hideBar)("position",o.position)("animated",o.inkBarAnimated),e.R7$(),e.Y8G("addIcon",o.addIcon)("addable",o.addable)("items",o.hiddenItems),e.R7$(),e.Y8G("ngIf",o.extraTemplate))},dependencies:[un,T.bT,Ht,ke,ie,T.T3],encapsulation:2,changeDetection:0})}return i})(),fn=(()=>{class i{constructor(){this.content=null,this.active=!1,this.animated=!0,this.forceRender=!1,this.hasBeenActive=!1}ngOnChanges(t){const{active:n}=t;n?.currentValue&&(this.hasBeenActive=!0)}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["","nz-tab-body",""]],hostAttrs:[1,"ant-tabs-tabpane"],hostVars:10,hostBindings:function(n,o){2&n&&(e.zvX("@tabSwitchMotion",o.active?"enter":"leave")("@.disabled",!o.animated),e.BMQ("tabindex",o.active?0:-1)("aria-hidden",!o.active),e.xc7("overflow-y",o.animated?o.active?null:"none":null),e.AVh("ant-tabs-tabpane-active",o.active)("ant-tabs-tabpane-hidden",o.animated?null:!o.active))},inputs:{content:"content",active:"active",animated:"animated",forceRender:"forceRender"},exportAs:["nzTabBody"],standalone:!0,features:[e.OA$,e.aNF],attrs:Ms,decls:1,vars:1,consts:[[4,"ngIf"],[3,"ngTemplateOutlet"]],template:function(n,o){1&n&&e.DNE(0,Rs,2,1,"ng-container",0),2&n&&e.Y8G("ngIf",o.hasBeenActive||o.forceRender)},dependencies:[T.bT,T.T3],encapsulation:2,data:{animation:[Wt.eF]},changeDetection:0})}return i})(),Ae=(()=>{class i{constructor(){this.closeIcon="close"}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tab-close-button"],["button","nz-tab-close-button",""]],hostAttrs:["aria-label","Close tab","type","button",1,"ant-tabs-tab-remove"],inputs:{closeIcon:"closeIcon"},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[4,"nzStringTemplateOutlet"],["nz-icon","","nzTheme","outline",3,"nzType"]],template:function(n,o){1&n&&e.DNE(0,Bs,2,1,"ng-container",0),2&n&&e.Y8G("nzStringTemplateOutlet",o.closeIcon)},dependencies:[F.C,F.m,G.Y3,G.Dn],encapsulation:2})}return i})(),mn=(()=>{class i{constructor(t){this.templateRef=t}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.C4Q,1))};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["ng-template","nzTabLink",""]],exportAs:["nzTabLinkTemplate"],standalone:!0})}return i})(),vn=(()=>{class i{constructor(t,n){this.elementRef=t,this.routerLink=n}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.aKT),e.rXU(rt.Wk,10))};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["a","nz-tab-link",""]],exportAs:["nzTabLink"],standalone:!0})}return i})(),Cn=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["","nz-tab",""]],exportAs:["nzTab"],standalone:!0})}return i})();const bn=new e.nKC("NZ_TAB_SET");let _n=(()=>{class i{get content(){return this.template||this.contentTemplate}get label(){return this.nzTitle||this.nzTabLinkTemplateDirective?.templateRef}constructor(t){this.closestTabSet=t,this.nzTitle="",this.nzClosable=!1,this.nzCloseIcon="close",this.nzDisabled=!1,this.nzForceRender=!1,this.nzSelect=new e.bkB,this.nzDeselect=new e.bkB,this.nzClick=new e.bkB,this.nzContextmenu=new e.bkB,this.template=null,this.isActive=!1,this.position=null,this.origin=null,this.stateChanges=new pt.B}ngOnChanges(t){const{nzTitle:n,nzDisabled:o,nzForceRender:r}=t;(n||o||r)&&this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(bn))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tab"]],contentQueries:function(n,o,r){if(1&n&&(e.wni(r,mn,5),e.wni(r,Cn,5,e.C4Q),e.wni(r,vn,5)),2&n){let a;e.mGM(a=e.lsd())&&(o.nzTabLinkTemplateDirective=a.first),e.mGM(a=e.lsd())&&(o.template=a.first),e.mGM(a=e.lsd())&&(o.linkDirective=a.first)}},viewQuery:function(n,o){if(1&n&&e.GBs(Os,7),2&n){let r;e.mGM(r=e.lsd())&&(o.contentTemplate=r.first)}},inputs:{nzTitle:"nzTitle",nzClosable:"nzClosable",nzCloseIcon:"nzCloseIcon",nzDisabled:"nzDisabled",nzForceRender:"nzForceRender"},outputs:{nzSelect:"nzSelect",nzDeselect:"nzDeselect",nzClick:"nzClick",nzContextmenu:"nzContextmenu"},exportAs:["nzTab"],standalone:!0,features:[e.OA$,e.aNF],ngContentSelectors:Fs,decls:4,vars:0,consts:[["tabLinkTemplate",""],["contentTemplate",""]],template:function(n,o){1&n&&(e.NAR(Vs),e.DNE(0,Gs,1,0,"ng-template",null,0,e.C5r)(2,js,1,0,"ng-template",null,1,e.C5r))},encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzClosable",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzDisabled",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzForceRender",void 0),i})();class Js{}let Zs=0,zn=(()=>{class i{get nzSelectedIndex(){return this.selectedIndex}set nzSelectedIndex(t){this.indexToSelect=(0,ln.OE)(t,null)}get position(){return-1===["top","bottom"].indexOf(this.nzTabPosition)?"vertical":"horizontal"}get addable(){return"editable-card"===this.nzType&&!this.nzHideAdd}get closable(){return"editable-card"===this.nzType}get line(){return"line"===this.nzType}get inkBarAnimated(){return this.line&&("boolean"==typeof this.nzAnimated?this.nzAnimated:this.nzAnimated.inkBar)}get tabPaneAnimated(){return"boolean"==typeof this.nzAnimated?this.nzAnimated:this.nzAnimated.tabPane}constructor(t,n,o,r,a){this.nzConfigService=t,this.ngZone=n,this.cdr=o,this.directionality=r,this.router=a,this._nzModuleName="tabs",this.nzTabPosition="top",this.nzCanDeactivate=null,this.nzAddIcon="plus",this.nzTabBarStyle=null,this.nzType="line",this.nzSize="default",this.nzAnimated=!0,this.nzTabBarGutter=void 0,this.nzHideAdd=!1,this.nzCentered=!1,this.nzHideAll=!1,this.nzLinkRouter=!1,this.nzLinkExact=!0,this.nzSelectChange=new e.bkB(!0),this.nzSelectedIndexChange=new e.bkB,this.nzTabListScroll=new e.bkB,this.nzClose=new e.bkB,this.nzAdd=new e.bkB,this.allTabs=new e.rOR,this.tabs=new e.rOR,this.dir="ltr",this.destroy$=new pt.B,this.indexToSelect=0,this.selectedIndex=null,this.tabLabelSubscription=ne.yU.EMPTY,this.tabsSubscription=ne.yU.EMPTY,this.canDeactivateSubscription=ne.yU.EMPTY,this.tabSetId=Zs++}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe((0,H.Q)(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.tabs.destroy(),this.tabLabelSubscription.unsubscribe(),this.tabsSubscription.unsubscribe(),this.canDeactivateSubscription.unsubscribe()}ngAfterContentInit(){this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.setUpRouter())}),this.subscribeToTabLabels(),this.subscribeToAllTabChanges(),this.tabsSubscription=this.tabs.changes.subscribe(()=>{if(this.clampTabIndex(this.indexToSelect)===this.selectedIndex){const n=this.tabs.toArray();for(let o=0;o<n.length;o++)if(n[o].isActive){this.indexToSelect=this.selectedIndex=o;break}}this.subscribeToTabLabels(),this.cdr.markForCheck()})}ngAfterContentChecked(){const t=this.indexToSelect=this.clampTabIndex(this.indexToSelect);if(this.selectedIndex!==t){const n=null==this.selectedIndex;n||this.nzSelectChange.emit(this.createChangeEvent(t)),Promise.resolve().then(()=>{this.tabs.forEach((o,r)=>o.isActive=r===t),n||this.nzSelectedIndexChange.emit(t)})}this.tabs.forEach((n,o)=>{n.position=o-t,null!=this.selectedIndex&&0===n.position&&!n.origin&&(n.origin=t-this.selectedIndex)}),this.selectedIndex!==t&&(this.selectedIndex=t,this.cdr.markForCheck())}onClose(t,n){n.preventDefault(),n.stopPropagation(),this.nzClose.emit({index:t})}onAdd(){this.nzAdd.emit()}clampTabIndex(t){return Math.min(this.tabs.length-1,Math.max(t||0,0))}createChangeEvent(t){const n=new Js;return n.index=t,this.tabs&&this.tabs.length&&(n.tab=this.tabs.toArray()[t],this.tabs.forEach((o,r)=>{r!==t&&o.nzDeselect.emit()}),n.tab.nzSelect.emit()),n}subscribeToTabLabels(){this.tabLabelSubscription&&this.tabLabelSubscription.unsubscribe(),this.tabLabelSubscription=(0,Zt.h)(...this.tabs.map(t=>t.stateChanges)).subscribe(()=>this.cdr.markForCheck())}subscribeToAllTabChanges(){this.allTabs.changes.pipe((0,ve.Z)(this.allTabs)).subscribe(t=>{this.tabs.reset(t.filter(n=>n.closestTabSet===this)),this.tabs.notifyOnChanges()})}canDeactivateFun(t,n){return"function"==typeof this.nzCanDeactivate?(0,D.cG)(this.nzCanDeactivate(t,n)).pipe((0,vs.$)(),(0,H.Q)(this.destroy$)):(0,me.of)(!0)}clickNavItem(t,n,o){t.nzDisabled||(t.nzClick.emit(),this.isRouterLinkClickEvent(n,o)||this.setSelectedIndex(n))}isRouterLinkClickEvent(t,n){const o=n.target;return!!this.nzLinkRouter&&!!this.tabs.toArray()[t]?.linkDirective?.elementRef.nativeElement.contains(o)}contextmenuNavItem(t,n){t.nzDisabled||t.nzContextmenu.emit(n)}setSelectedIndex(t){this.canDeactivateSubscription.unsubscribe(),this.canDeactivateSubscription=this.canDeactivateFun(this.selectedIndex,t).subscribe(n=>{n&&(this.nzSelectedIndex=t,this.tabNavBarRef.focusIndex=t,this.cdr.markForCheck())})}getTabIndex(t,n){return t.nzDisabled?null:this.selectedIndex===n?0:-1}getTabContentId(t){return`nz-tabs-${this.tabSetId}-tab-${t}`}setUpRouter(){if(this.nzLinkRouter){if(!this.router)throw new Error(`${dn.H3} you should import 'RouterModule' if you want to use 'nzLinkRouter'!`);this.router.events.pipe((0,H.Q)(this.destroy$),(0,Vt.p)(t=>t instanceof rt.wF),(0,ve.Z)(!0),(0,Cs.c)(0)).subscribe(()=>{this.updateRouterActive(),this.cdr.markForCheck()})}}updateRouterActive(){if(this.router.navigated){const t=this.findShouldActiveTabIndex();t!==this.selectedIndex&&this.setSelectedIndex(t),this.nzHideAll=-1===t}}findShouldActiveTabIndex(){const t=this.tabs.toArray(),n=this.isLinkActive(this.router);return t.findIndex(o=>{const r=o.linkDirective;return!!r&&n(r.routerLink)})}isLinkActive(t){return n=>!!n&&t.isActive(n.urlTree||"",{paths:this.nzLinkExact?"exact":"subset",queryParams:this.nzLinkExact?"exact":"subset",fragment:"ignored",matrixParams:"ignored"})}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(W.yx),e.rXU(e.SKi),e.rXU(e.gRc),e.rXU(mt.dS,8),e.rXU(rt.Ix,8))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tabset"]],contentQueries:function(n,o,r){if(1&n&&e.wni(r,_n,5),2&n){let a;e.mGM(a=e.lsd())&&(o.allTabs=a)}},viewQuery:function(n,o){if(1&n&&e.GBs(se,5),2&n){let r;e.mGM(r=e.lsd())&&(o.tabNavBarRef=r.first)}},hostAttrs:[1,"ant-tabs"],hostVars:24,hostBindings:function(n,o){2&n&&e.AVh("ant-tabs-card","card"===o.nzType||"editable-card"===o.nzType)("ant-tabs-editable","editable-card"===o.nzType)("ant-tabs-editable-card","editable-card"===o.nzType)("ant-tabs-centered",o.nzCentered)("ant-tabs-rtl","rtl"===o.dir)("ant-tabs-top","top"===o.nzTabPosition)("ant-tabs-bottom","bottom"===o.nzTabPosition)("ant-tabs-left","left"===o.nzTabPosition)("ant-tabs-right","right"===o.nzTabPosition)("ant-tabs-default","default"===o.nzSize)("ant-tabs-small","small"===o.nzSize)("ant-tabs-large","large"===o.nzSize)},inputs:{nzSelectedIndex:"nzSelectedIndex",nzTabPosition:"nzTabPosition",nzTabBarExtraContent:"nzTabBarExtraContent",nzCanDeactivate:"nzCanDeactivate",nzAddIcon:"nzAddIcon",nzTabBarStyle:"nzTabBarStyle",nzType:"nzType",nzSize:"nzSize",nzAnimated:"nzAnimated",nzTabBarGutter:"nzTabBarGutter",nzHideAdd:"nzHideAdd",nzCentered:"nzCentered",nzHideAll:"nzHideAll",nzLinkRouter:"nzLinkRouter",nzLinkExact:"nzLinkExact"},outputs:{nzSelectChange:"nzSelectChange",nzSelectedIndexChange:"nzSelectedIndexChange",nzTabListScroll:"nzTabListScroll",nzClose:"nzClose",nzAdd:"nzAdd"},exportAs:["nzTabset"],standalone:!0,features:[e.Jv_([{provide:bn,useExisting:i}]),e.aNF],decls:4,vars:12,consts:[[3,"ngStyle","selectedIndex","inkBarAnimated","addable","addIcon","hideBar","position","extraTemplate","tabScroll","selectFocusedIndex","addClicked",4,"ngIf"],[1,"ant-tabs-content-holder"],[1,"ant-tabs-content"],["role","tabpanel","nz-tab-body","",3,"id","active","content","forceRender","animated",4,"ngFor","ngForOf"],[3,"tabScroll","selectFocusedIndex","addClicked","ngStyle","selectedIndex","inkBarAnimated","addable","addIcon","hideBar","position","extraTemplate"],["class","ant-tabs-tab",3,"margin-right","margin-bottom","ant-tabs-tab-active","ant-tabs-tab-disabled","click","contextmenu",4,"ngFor","ngForOf"],[1,"ant-tabs-tab",3,"click","contextmenu"],["type","button","role","tab","nzTabNavItem","","cdkMonitorElementFocus","",1,"ant-tabs-tab-btn",3,"id","disabled","tab","active"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],["type","button","nz-tab-close-button","",3,"closeIcon","click",4,"ngIf"],["type","button","nz-tab-close-button","",3,"click","closeIcon"],["role","tabpanel","nz-tab-body","",3,"id","active","content","forceRender","animated"]],template:function(n,o){1&n&&(e.DNE(0,Us,2,9,"nz-tabs-nav",0),e.j41(1,"div",1)(2,"div",2),e.DNE(3,Ws,1,6,"div",3),e.k0s()()),2&n&&(e.Y8G("ngIf",o.tabs.length||o.addable),e.R7$(2),e.AVh("ant-tabs-content-top","top"===o.nzTabPosition)("ant-tabs-content-bottom","bottom"===o.nzTabPosition)("ant-tabs-content-left","left"===o.nzTabPosition)("ant-tabs-content-right","right"===o.nzTabPosition)("ant-tabs-content-animated",o.tabPaneAnimated),e.R7$(),e.Y8G("ngForOf",o.tabs))},dependencies:[se,T.bT,T.B3,T.Sq,Te,Se.Pd,Se.vR,F.C,F.m,Ae,fn],encapsulation:2})}return(0,y.Cg)([(0,W.H4)()],i.prototype,"nzType",void 0),(0,y.Cg)([(0,W.H4)()],i.prototype,"nzSize",void 0),(0,y.Cg)([(0,W.H4)()],i.prototype,"nzAnimated",void 0),(0,y.Cg)([(0,W.H4)()],i.prototype,"nzTabBarGutter",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzHideAdd",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzCentered",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzHideAll",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzLinkRouter",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzLinkExact",void 0),i})(),Qs=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[zn,se,ie,Ht,Ae]})}return i})();var xn=m(2986);let tr=(()=>{class i{constructor(t){this.san=t}transform(t,...n){return this.san.bypassSecurityTrustHtml(t)}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(Ot.up,16))};static#e=this.\u0275pipe=e.EJ8({name:"html",type:i,pure:!0})}return i})();var er=m(6354);const nr=[[["nz-breadcrumb","nz-page-header-breadcrumb",""]],[["nz-avatar","nz-page-header-avatar",""]],[["nz-page-header-tags"],["","nz-page-header-tags",""]],[["nz-page-header-extra"],["","nz-page-header-extra",""]],[["nz-page-header-content"],["","nz-page-header-content",""]],[["nz-page-header-footer"],["","nz-page-header-footer",""]],[["nz-page-header-title"],["","nz-page-header-title",""]],[["nz-page-header-subtitle"],["","nz-page-header-subtitle",""]]],ir=["nz-breadcrumb[nz-page-header-breadcrumb]","nz-avatar[nz-page-header-avatar]","nz-page-header-tags, [nz-page-header-tags]","nz-page-header-extra, [nz-page-header-extra]","nz-page-header-content, [nz-page-header-content]","nz-page-header-footer, [nz-page-header-footer]","nz-page-header-title, [nz-page-header-title]","nz-page-header-subtitle, [nz-page-header-subtitle]"];function or(i,s){if(1&i&&(e.qex(0),e.nrm(1,"span",8),e.bVm()),2&i){const t=s.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("nzType",t||n.getBackIcon())}}function sr(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onBack())}),e.j41(1,"div",6),e.DNE(2,or,2,1,"ng-container",7),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(2),e.Y8G("nzStringTemplateOutlet",t.nzBackIcon)}}function rr(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzTitle)}}function ar(i,s){if(1&i&&(e.j41(0,"span",3),e.DNE(1,rr,2,1,"ng-container",7),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzTitle)}}function lr(i,s){1&i&&e.SdG(0,6)}function cr(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzSubtitle)}}function dr(i,s){if(1&i&&(e.j41(0,"span",4),e.DNE(1,cr,2,1,"ng-container",7),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzSubtitle)}}function pr(i,s){1&i&&e.SdG(0,7)}let yn=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["nz-page-header-footer"],["","nz-page-header-footer",""]],hostAttrs:[1,"ant-page-header-footer"],exportAs:["nzPageHeaderFooter"],standalone:!0})}return i})(),wn=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275dir=e.FsC({type:i,selectors:[["nz-breadcrumb","nz-page-header-breadcrumb",""]],exportAs:["nzPageHeaderBreadcrumb"],standalone:!0})}return i})(),br=(()=>{class i{constructor(t,n,o,r,a,l){this.location=t,this.nzConfigService=n,this.elementRef=o,this.nzResizeObserver=r,this.cdr=a,this.directionality=l,this._nzModuleName="pageHeader",this.nzBackIcon=null,this.nzGhost=!0,this.nzBack=new e.bkB,this.compact=!1,this.destroy$=new pt.B,this.dir="ltr"}ngOnInit(){this.directionality.change?.pipe((0,H.Q)(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngAfterViewInit(){this.nzResizeObserver.observe(this.elementRef).pipe((0,er.T)(([t])=>t.contentRect.width),(0,H.Q)(this.destroy$)).subscribe(t=>{this.compact=t<768,this.cdr.markForCheck()})}onBack(){if(this.nzBack.observers.length)this.nzBack.emit();else{if(!this.location)throw new Error(`${dn.H3} you should import 'RouterModule' or register 'Location' if you want to use 'nzBack' default event!`);this.location.back()}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getBackIcon(){return"rtl"===this.dir?"arrow-right":"arrow-left"}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(T.aZ,8),e.rXU(W.yx),e.rXU(e.aKT),e.rXU(cn.xH),e.rXU(e.gRc),e.rXU(mt.dS,8))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-page-header"]],contentQueries:function(n,o,r){if(1&n&&(e.wni(r,yn,5),e.wni(r,wn,5)),2&n){let a;e.mGM(a=e.lsd())&&(o.nzPageHeaderFooter=a.first),e.mGM(a=e.lsd())&&(o.nzPageHeaderBreadcrumb=a.first)}},hostAttrs:[1,"ant-page-header"],hostVars:10,hostBindings:function(n,o){2&n&&e.AVh("has-footer",o.nzPageHeaderFooter)("ant-page-header-ghost",o.nzGhost)("has-breadcrumb",o.nzPageHeaderBreadcrumb)("ant-page-header-compact",o.compact)("ant-page-header-rtl","rtl"===o.dir)},inputs:{nzBackIcon:"nzBackIcon",nzTitle:"nzTitle",nzSubtitle:"nzSubtitle",nzGhost:"nzGhost"},outputs:{nzBack:"nzBack"},exportAs:["nzPageHeader"],standalone:!0,features:[e.aNF],ngContentSelectors:ir,decls:13,vars:3,consts:[[1,"ant-page-header-heading"],[1,"ant-page-header-heading-left"],[1,"ant-page-header-back"],[1,"ant-page-header-heading-title"],[1,"ant-page-header-heading-sub-title"],[1,"ant-page-header-back",3,"click"],["role","button","tabindex","0",1,"ant-page-header-back-button"],[4,"nzStringTemplateOutlet"],["nz-icon","","nzTheme","outline",3,"nzType"]],template:function(n,o){1&n&&(e.NAR(nr),e.SdG(0),e.j41(1,"div",0)(2,"div",1),e.DNE(3,sr,3,1,"div",2),e.SdG(4,1),e.DNE(5,ar,2,1,"span",3)(6,lr,1,0)(7,dr,2,1,"span",4)(8,pr,1,0),e.SdG(9,2),e.k0s(),e.SdG(10,3),e.k0s(),e.SdG(11,4),e.SdG(12,5)),2&n&&(e.R7$(3),e.vxM(3,null!==o.nzBackIcon?3:-1),e.R7$(2),e.vxM(5,o.nzTitle?5:6),e.R7$(2),e.vxM(7,o.nzSubtitle?7:8))},dependencies:[F.C,F.m,G.Y3,G.Dn],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,W.H4)()],i.prototype,"nzGhost",void 0),i})(),_r=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[br]})}return i})();var zr=m(2358),Sn=m(3190),kn=m(7064);const xr=["processDotTemplate"],yr=["itemContainer"],wr=(i,s,t)=>({$implicit:i,status:s,index:t});function Sr(i,s){1&i&&e.nrm(0,"div",11)}function kr(i,s){if(1&i&&(e.j41(0,"div",14),e.nrm(1,"nz-progress",15),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("nzPercent",t.nzPercentage)("nzWidth","small"===t.nzSize?32:40)("nzFormat",t.nullProcessFormat)("nzStrokeWidth",4)}}function Tr(i,s){1&i&&(e.j41(0,"span",16),e.nrm(1,"span",17),e.k0s())}function Ar(i,s){1&i&&(e.j41(0,"span",16),e.nrm(1,"span",18),e.k0s())}function Er(i,s){if(1&i&&(e.j41(0,"span",16),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.index+1," ")}}function Ir(i,s){if(1&i&&(e.qex(0),e.nrm(1,"span",19),e.bVm()),2&i){const t=s.$implicit,n=e.XpG(3);e.R7$(),e.Y8G("nzType",!n.oldAPIIcon&&t)("ngClass",n.oldAPIIcon&&t)}}function Nr(i,s){if(1&i&&(e.j41(0,"span",16),e.DNE(1,Ir,2,2,"ng-container",8),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzIcon)}}function Dr(i,s){if(1&i&&e.DNE(0,kr,2,4,"div",12)(1,Tr,2,0,"span",13)(2,Ar,2,0,"span",13)(3,Er,2,1,"span",13)(4,Nr,2,1,"span",13),2&i){const t=e.XpG();e.Y8G("ngIf",t.showProgress),e.R7$(),e.Y8G("ngIf","finish"===t.nzStatus&&!t.nzIcon),e.R7$(),e.Y8G("ngIf","error"===t.nzStatus),e.R7$(),e.Y8G("ngIf",("process"===t.nzStatus||"wait"===t.nzStatus)&&!t.nzIcon),e.R7$(),e.Y8G("ngIf",t.nzIcon)}}function Mr(i,s){1&i&&e.nrm(0,"span",21)}function Pr(i,s){}function Rr(i,s){if(1&i&&(e.j41(0,"span",16),e.DNE(1,Mr,1,0,"ng-template",null,1,e.C5r)(3,Pr,0,0,"ng-template",20),e.k0s()),2&i){const t=e.sdS(2),n=e.XpG();e.R7$(3),e.Y8G("ngTemplateOutlet",n.customProcessTemplate||t)("ngTemplateOutletContext",e.sMw(2,wr,t,n.nzStatus,n.index))}}function Br(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.nzTitle)}}function Or(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG(2);e.R7$(),e.JRh(t.nzSubtitle)}}function Vr(i,s){if(1&i&&(e.j41(0,"div",22),e.DNE(1,Or,2,1,"ng-container",8),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("nzStringTemplateOutlet",t.nzSubtitle)}}function Fr(i,s){if(1&i&&(e.qex(0),e.EFF(1),e.bVm()),2&i){const t=e.XpG();e.R7$(),e.JRh(t.nzDescription)}}let Gr=(()=>{class i{get nzStatus(){return this._status}set nzStatus(t){this._status=t,this.isCustomStatus=!0}get nzIcon(){return this._icon}set nzIcon(t){t instanceof e.C4Q||(this.oldAPIIcon="string"==typeof t&&t.indexOf("anticon")>-1),this._icon=t}get showProgress(){return null!==this.nzPercentage&&!this.nzIcon&&"process"===this.nzStatus&&this.nzPercentage>=0&&this.nzPercentage<=100}get currentIndex(){return this._currentIndex}set currentIndex(t){this._currentIndex=t,this.isCustomStatus||(this._status=t>this.index?"finish":t===this.index?this.outStatus||"":"wait")}constructor(t,n,o){this.cdr=t,this.ngZone=n,this.destroy$=o,this.nzDisabled=!1,this.nzPercentage=null,this.nzSize="default",this.isCustomStatus=!1,this._status="wait",this.oldAPIIcon=!0,this.direction="horizontal",this.index=0,this.last=!1,this.outStatus="process",this.showProcessDot=!1,this.clickable=!1,this.clickOutsideAngular$=new pt.B,this.nullProcessFormat=()=>null,this._currentIndex=0}ngOnInit(){this.ngZone.runOutsideAngular(()=>(0,at.R)(this.itemContainer.nativeElement,"click").pipe((0,Vt.p)(()=>this.clickable&&this.currentIndex!==this.index&&!this.nzDisabled),(0,H.Q)(this.destroy$)).subscribe(()=>{this.clickOutsideAngular$.next(this.index)}))}enable(){this.nzDisabled=!1,this.cdr.markForCheck()}disable(){this.nzDisabled=!0,this.cdr.markForCheck()}markForCheck(){this.cdr.markForCheck()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.gRc),e.rXU(e.SKi),e.rXU(et.y4))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-step"]],viewQuery:function(n,o){if(1&n&&(e.GBs(xr,5),e.GBs(yr,7)),2&n){let r;e.mGM(r=e.lsd())&&(o.processDotTemplate=r.first),e.mGM(r=e.lsd())&&(o.itemContainer=r.first)}},hostAttrs:[1,"ant-steps-item"],hostVars:16,hostBindings:function(n,o){2&n&&e.AVh("ant-steps-item-wait","wait"===o.nzStatus)("ant-steps-item-process","process"===o.nzStatus)("ant-steps-item-finish","finish"===o.nzStatus)("ant-steps-item-error","error"===o.nzStatus)("ant-steps-item-active",o.currentIndex===o.index)("ant-steps-item-disabled",o.nzDisabled)("ant-steps-item-custom",!!o.nzIcon)("ant-steps-next-error","error"===o.outStatus&&o.currentIndex===o.index+1)},inputs:{nzTitle:"nzTitle",nzSubtitle:"nzSubtitle",nzDescription:"nzDescription",nzDisabled:"nzDisabled",nzPercentage:"nzPercentage",nzSize:"nzSize",nzStatus:"nzStatus",nzIcon:"nzIcon"},exportAs:["nzStep"],standalone:!0,features:[e.Jv_([et.y4]),e.aNF],decls:12,vars:8,consts:[["itemContainer",""],["processDotTemplate",""],[1,"ant-steps-item-container",3,"tabindex"],["class","ant-steps-item-tail",4,"ngIf"],[1,"ant-steps-item-icon"],[3,"ngIf"],[1,"ant-steps-item-content"],[1,"ant-steps-item-title"],[4,"nzStringTemplateOutlet"],["class","ant-steps-item-subtitle",4,"ngIf"],[1,"ant-steps-item-description"],[1,"ant-steps-item-tail"],["class","ant-steps-progress-icon",4,"ngIf"],["class","ant-steps-icon",4,"ngIf"],[1,"ant-steps-progress-icon"],["nzType","circle",3,"nzPercent","nzWidth","nzFormat","nzStrokeWidth"],[1,"ant-steps-icon"],["nz-icon","","nzType","check"],["nz-icon","","nzType","close"],["nz-icon","",3,"nzType","ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-steps-icon-dot"],[1,"ant-steps-item-subtitle"]],template:function(n,o){1&n&&(e.j41(0,"div",2,0),e.DNE(2,Sr,1,0,"div",3),e.j41(3,"div",4),e.DNE(4,Dr,5,5,"ng-template",5)(5,Rr,4,6,"ng-template",5),e.k0s(),e.j41(6,"div",6)(7,"div",7),e.DNE(8,Br,2,1,"ng-container",8)(9,Vr,2,1,"div",9),e.k0s(),e.j41(10,"div",10),e.DNE(11,Fr,2,1,"ng-container",8),e.k0s()()()),2&n&&(e.Y8G("tabindex",o.clickable&&!o.nzDisabled?0:null),e.BMQ("role",o.clickable&&!o.nzDisabled?"button":null),e.R7$(2),e.Y8G("ngIf",!0!==o.last),e.R7$(2),e.Y8G("ngIf",!o.showProcessDot),e.R7$(),e.Y8G("ngIf",o.showProcessDot),e.R7$(3),e.Y8G("nzStringTemplateOutlet",o.nzTitle),e.R7$(),e.Y8G("ngIf",o.nzSubtitle),e.R7$(2),e.Y8G("nzStringTemplateOutlet",o.nzDescription))},dependencies:[T.bT,kn.m,kn.V,G.Y3,G.Dn,F.C,F.m,T.YU,T.T3],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzDisabled",void 0),i})(),Tn=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[Gr]})}return i})();var An=m(9247);let jr=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({providers:[tr],imports:[T.MD,E.YN,E.X1,nn,xn.IJ,G.Y3,ge.j,Jt.Zw,sn,_r,rn.pc,zr.SE,Sn.Sw,Tn,An.$G,$t.GP,Qt.V]})}return i})(),Lr=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({}),i})();var re=m(6006);const Yr=["*"];function Xr(i,s){if(1&i){const t=e.RV6();e.j41(0,"span",1),e.bIt("click",function(o){e.eBV(t);const r=e.XpG();return e.Njj(r.closeTag(o))}),e.k0s()}}let Hr=(()=>{class i{constructor(t,n,o,r){this.cdr=t,this.renderer=n,this.elementRef=o,this.directionality=r,this.isPresetColor=!1,this.nzMode="default",this.nzChecked=!1,this.nzBordered=!0,this.nzOnClose=new e.bkB,this.nzCheckedChange=new e.bkB,this.dir="ltr",this.destroy$=new pt.B}updateCheckedStatus(){"checkable"===this.nzMode&&(this.nzChecked=!this.nzChecked,this.nzCheckedChange.emit(this.nzChecked))}closeTag(t){this.nzOnClose.emit(t),t.defaultPrevented||this.renderer.removeChild(this.renderer.parentNode(this.elementRef.nativeElement),this.elementRef.nativeElement)}clearPresetColor(){const t=this.elementRef.nativeElement,n=new RegExp(`(ant-tag-(?:${[...re.un,...re.PA].join("|")}))`,"g"),o=t.classList.toString(),r=[];let a=n.exec(o);for(;null!==a;)r.push(a[1]),a=n.exec(o);t.classList.remove(...r)}setPresetColor(){const t=this.elementRef.nativeElement;this.clearPresetColor(),this.isPresetColor=!!this.nzColor&&((0,re.nP)(this.nzColor)||(0,re.uP)(this.nzColor)),this.isPresetColor&&t.classList.add(`ant-tag-${this.nzColor}`)}ngOnInit(){this.directionality.change?.pipe((0,H.Q)(this.destroy$)).subscribe(t=>{this.dir=t,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(t){const{nzColor:n}=t;n&&this.setPresetColor()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#t=this.\u0275fac=function(n){return new(n||i)(e.rXU(e.gRc),e.rXU(e.sFG),e.rXU(e.aKT),e.rXU(mt.dS,8))};static#e=this.\u0275cmp=e.VBU({type:i,selectors:[["nz-tag"]],hostAttrs:[1,"ant-tag"],hostVars:12,hostBindings:function(n,o){1&n&&e.bIt("click",function(){return o.updateCheckedStatus()}),2&n&&(e.xc7("background-color",o.isPresetColor?"":o.nzColor),e.AVh("ant-tag-has-color",o.nzColor&&!o.isPresetColor)("ant-tag-checkable","checkable"===o.nzMode)("ant-tag-checkable-checked",o.nzChecked)("ant-tag-rtl","rtl"===o.dir)("ant-tag-borderless",!o.nzBordered))},inputs:{nzMode:"nzMode",nzColor:"nzColor",nzChecked:"nzChecked",nzBordered:"nzBordered"},outputs:{nzOnClose:"nzOnClose",nzCheckedChange:"nzCheckedChange"},exportAs:["nzTag"],standalone:!0,features:[e.OA$,e.aNF],ngContentSelectors:Yr,decls:2,vars:1,consts:[["nz-icon","","nzType","close","class","ant-tag-close-icon","tabindex","-1",3,"click",4,"ngIf"],["nz-icon","","nzType","close","tabindex","-1",1,"ant-tag-close-icon",3,"click"]],template:function(n,o){1&n&&(e.NAR(),e.SdG(0),e.DNE(1,Xr,1,0,"span",0)),2&n&&(e.R7$(),e.Y8G("ngIf","closeable"===o.nzMode))},dependencies:[G.Y3,G.Dn,T.bT],encapsulation:2,changeDetection:0})}return(0,y.Cg)([(0,D.H3)()],i.prototype,"nzChecked",void 0),(0,y.Cg)([(0,D.H3)()],i.prototype,"nzBordered",void 0),i})(),Ur=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({imports:[Hr]})}return i})();var Wr=m(7481),Kr=m(1166);let $r=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=e.$C({type:i});static#n=this.\u0275inj=e.G2t({providers:[{provide:ft.xh},it.b],imports:[T.MD,E.YN,E.X1,Oo,G.Y3.forChild([O.Cnd,O.XMK,O.VJ5,O.vjn,O.bRU,O.O9N,O.nIb,O.OgO,O.xrU,O.BNP,O.MO3,O.RR4,O.rj,O.dJK,O.q_y,O.ptz,O.qZ3,O.rXM,O.EOi,O.loe,O.z7U,O.eNq,O.lr0,O.O8m,O.gX4,O.XaC]),di,Jt.Zw,nn,Xt.PQ,ge.j,ue.U6,sn,rn.pc,Qs,xn.IJ,jr,fe.DH,$t.GP,Lr,Ur,Wr.$,ut.Cu,Sn.Sw,Tn,An.$G,Qt.V,Kr.Sk,jt,P,ot,De,Ne,Me,Pe,te,ye]})}return i})()},7184:(Rt,Bt,m)=>{var T;!function(rt,At,le){if(rt){for(var it,e={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},Ot={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},gt={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},ft={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},y=1;y<20;++y)e[111+y]="f"+y;for(y=0;y<=9;++y)e[y+96]=y.toString();J.prototype.bind=function(g,C,I){var L=this;return L._bindMultiple.call(L,g=g instanceof Array?g:[g],C,I),L},J.prototype.unbind=function(g,C){return this.bind.call(this,g,function(){},C)},J.prototype.trigger=function(g,C){var I=this;return I._directMap[g+":"+C]&&I._directMap[g+":"+C]({},g),I},J.prototype.reset=function(){var g=this;return g._callbacks={},g._directMap={},g},J.prototype.stopCallback=function(g,C){if((" "+C.className+" ").indexOf(" mousetrap ")>-1||Ft(C,this.target))return!1;if("composedPath"in g&&"function"==typeof g.composedPath){var L=g.composedPath()[0];L!==g.target&&(C=L)}return"INPUT"==C.tagName||"SELECT"==C.tagName||"TEXTAREA"==C.tagName||C.isContentEditable},J.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},J.addKeycodes=function(g){for(var C in g)g.hasOwnProperty(C)&&(e[C]=g[C]);it=null},J.init=function(){var g=J(At);for(var C in g)"_"!==C.charAt(0)&&(J[C]=function(I){return function(){return g[I].apply(g,arguments)}}(C))},J.init(),rt.Mousetrap=J,Rt.exports&&(Rt.exports=J),void 0!==(T=function(){return J}.call(Bt,m,Bt,Rt))&&(Rt.exports=T)}function at(g,C,I){g.addEventListener?g.addEventListener(C,I,!1):g.attachEvent("on"+C,I)}function H(g){if("keypress"==g.type){var C=String.fromCharCode(g.which);return g.shiftKey||(C=C.toLowerCase()),C}return e[g.which]?e[g.which]:Ot[g.which]?Ot[g.which]:String.fromCharCode(g.which).toLowerCase()}function Vt(g,C){return g.sort().join(",")===C.sort().join(",")}function et(g){return"shift"==g||"ctrl"==g||"alt"==g||"meta"==g}function G(g,C,I){return I||(I=function D(){if(!it)for(var g in it={},e)g>95&&g<112||e.hasOwnProperty(g)&&(it[e[g]]=g);return it}()[g]?"keydown":"keypress"),"keypress"==I&&C.length&&(I="keydown"),I}function Kt(g,C){var I,L,lt,ct=[];for(I=function mt(g){return"+"===g?["+"]:(g=g.replace(/\+{2}/g,"+plus")).split("+")}(g),lt=0;lt<I.length;++lt)ft[L=I[lt]]&&(L=ft[L]),C&&"keypress"!=C&&gt[L]&&(L=gt[L],ct.push("shift")),et(L)&&ct.push(L);return{key:L,modifiers:ct,action:C=G(L,ct,C)}}function Ft(g,C){return null!==g&&g!==At&&(g===C||Ft(g.parentNode,C))}function J(g){var C=this;if(g=g||At,!(C instanceof J))return new J(g);C.target=g,C._callbacks={},C._directMap={};var L,I={},lt=!1,ct=!1,vt=!1;function Et(S){S=S||{};var P,M=!1;for(P in I)S[P]?M=!0:I[P]=0;M||(vt=!1)}function xt(S,M,P,N,V,ot){var R,q,Ct=[],dt=P.type;if(!C._callbacks[S])return[];for("keyup"==dt&&et(S)&&(M=[S]),R=0;R<C._callbacks[S].length;++R)q=C._callbacks[S][R],!N&&q.seq&&I[q.seq]!=q.level||dt!=q.action||("keypress"!=dt||P.metaKey||P.ctrlKey)&&!Vt(M,q.modifiers)||((!N&&q.combo==V||N&&q.seq==N&&q.level==ot)&&C._callbacks[S].splice(R,1),Ct.push(q));return Ct}function yt(S,M,P,N){C.stopCallback(M,M.target||M.srcElement,P,N)||!1===S(M,P)&&(function W(g){g.preventDefault?g.preventDefault():g.returnValue=!1}(M),function F(g){g.stopPropagation?g.stopPropagation():g.cancelBubble=!0}(M))}function Gt(S){"number"!=typeof S.which&&(S.which=S.keyCode);var M=H(S);if(M){if("keyup"==S.type&&lt===M)return void(lt=!1);C.handleKey(M,function Wt(g){var C=[];return g.shiftKey&&C.push("shift"),g.altKey&&C.push("alt"),g.ctrlKey&&C.push("ctrl"),g.metaKey&&C.push("meta"),C}(S),S)}}function jt(S,M,P,N,V){C._directMap[S+":"+P]=M;var R,ot=(S=S.replace(/\s+/g," ")).split(" ");ot.length>1?function de(S,M,P,N){function V(dt){return function(){vt=dt,++I[S],function ce(){clearTimeout(L),L=setTimeout(Et,1e3)}()}}function ot(dt){yt(P,dt,S),"keyup"!==N&&(lt=H(dt)),setTimeout(Et,10)}I[S]=0;for(var R=0;R<M.length;++R){var Ct=R+1===M.length?ot:V(N||Kt(M[R+1]).action);jt(M[R],Ct,N,S,R)}}(S,ot,M,P):(R=Kt(S,P),C._callbacks[R.key]=C._callbacks[R.key]||[],xt(R.key,R.modifiers,{type:R.action},N,S,V),C._callbacks[R.key][N?"unshift":"push"]({callback:M,modifiers:R.modifiers,action:R.action,seq:N,level:V,combo:S}))}C._handleKey=function(S,M,P){var V,N=xt(S,M,P),ot={},R=0,q=!1;for(V=0;V<N.length;++V)N[V].seq&&(R=Math.max(R,N[V].level));for(V=0;V<N.length;++V)if(N[V].seq){if(N[V].level!=R)continue;q=!0,ot[N[V].seq]=1,yt(N[V].callback,P,N[V].combo,N[V].seq)}else q||yt(N[V].callback,P,N[V].combo);var Ct="keypress"==P.type&&ct;P.type==vt&&!et(S)&&!Ct&&Et(ot),ct=q&&"keydown"==P.type},C._bindMultiple=function(S,M,P){for(var N=0;N<S.length;++N)jt(S[N],M,P)},at(g,"keypress",Gt),at(g,"keydown",Gt),at(g,"keyup",Gt)}}(typeof window<"u"?window:null,typeof window<"u"?document:null)}}]);